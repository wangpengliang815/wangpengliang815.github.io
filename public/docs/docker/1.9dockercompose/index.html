<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content=" Docker ComposeÂ æ˜¯ Docker å®˜æ–¹ç¼–æ’ï¼ˆOrchestrationï¼‰é¡¹ç›®ä¹‹ä¸€ï¼Œè´Ÿè´£å®ç°å¯¹ Docker å®¹å™¨é›†ç¾¤çš„å¿«é€Ÿç¼–æ’ï¼Œå¿«é€Ÿçš„éƒ¨ç½²åˆ†å¸ƒå¼åº”ç”¨ã€‚
é€šè¿‡ä¹‹å‰å­¦ä¹ å·²ç»äº†è§£åˆ°ä½¿ç”¨ä¸€ä¸ª Dockerfile æ¨¡æ¿æ–‡ä»¶ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿çš„å®šä¹‰ä¸€ä¸ªå•ç‹¬çš„åº”ç”¨å®¹å™¨ã€‚ç„¶è€Œåœ¨æ—¥å¸¸å·¥ä½œä¸­ï¼Œç»å¸¸ç¢°åˆ°çš„æƒ…å†µæ˜¯éœ€è¦å¤šä¸ªå®¹å™¨ç›¸äº’é…åˆæ¥å®ŒæˆæŸé¡¹ä»»åŠ¡çš„æƒ…å†µã€‚ä¾‹å¦‚è¦å®ç°ä¸€ä¸ª Web é¡¹ç›®ï¼Œé™¤äº† Web æœåŠ¡å®¹å™¨æœ¬èº«ï¼Œå¾€å¾€è¿˜éœ€è¦å†åŠ ä¸Šåç«¯çš„æ•°æ®åº“æœåŠ¡å®¹å™¨ã€è´Ÿè½½å‡è¡¡å®¹å™¨ç­‰ç­‰ã€‚Compose å°±æ˜¯ç”¨æ¥å¤„ç†è¿™äº›äº‹æƒ…çš„ã€‚å®ƒé€šè¿‡ä¸€ä¸ªå•ç‹¬çš„ docker-compose.yml æ¨¡æ¿æ–‡ä»¶ï¼ˆYAML æ ¼å¼ï¼‰æ¥å®šä¹‰ä¸€ç»„ç›¸å…³è”çš„åº”ç”¨å®¹å™¨ä¸ºä¸€ä¸ªé¡¹ç›®projectã€‚
Compose ä¸­æœ‰ä¸¤ä¸ªé‡è¦çš„æ¦‚å¿µï¼š
æœåŠ¡ (service)ï¼šä¸€ä¸ªåº”ç”¨çš„å®¹å™¨ï¼Œå®é™…ä¸Šå¯ä»¥åŒ…æ‹¬è‹¥å¹²è¿è¡Œç›¸åŒé•œåƒçš„å®¹å™¨å®ä¾‹ é¡¹ç›® (project)ï¼šç”±ä¸€ç»„å…³è”çš„åº”ç”¨å®¹å™¨ç»„æˆçš„ä¸€ä¸ªå®Œæ•´ä¸šåŠ¡å•å…ƒï¼Œåœ¨ docker-compose.yml æ–‡ä»¶ä¸­å®šä¹‰ Compose çš„é»˜è®¤ç®¡ç†å¯¹è±¡æ˜¯é¡¹ç›®ï¼Œé€šè¿‡å­å‘½ä»¤å¯¹é¡¹ç›®ä¸­çš„ä¸€ç»„å®¹å™¨è¿›è¡Œä¾¿æ·åœ°ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼ŒCompose é¡¹ç›®ç”± Python ç¼–å†™ï¼Œå®ç°ä¸Šè°ƒç”¨äº† Docker æœåŠ¡æä¾›çš„ API æ¥å¯¹å®¹å™¨è¿›è¡Œç®¡ç†ã€‚å› æ­¤åªè¦æ‰€æ“ä½œçš„å¹³å°æ”¯æŒ Docker APIÂ å°±å¯ä»¥åœ¨å…¶ä¸Šåˆ©ç”¨ Compose æ¥è¿›è¡Œç¼–æ’ç®¡ç†ã€‚
å®‰è£…# ComposeÂ æ”¯æŒ Linuxã€macOSã€Windows 10 ä¸‰å¤§å¹³å°ï¼Œå®‰è£…æ–¹å¼ï¼š
é€šè¿‡ Python çš„åŒ…ç®¡ç†å·¥å…· pipÂ è¿›è¡Œå®‰è£… ç›´æ¥ä¸‹è½½ç¼–è¯‘å¥½çš„äºŒè¿›åˆ¶æ–‡ä»¶ä½¿ç”¨ ç›´æ¥åœ¨ Docker å®¹å™¨ä¸­è¿è¡Œ å‰ä¸¤ç§æ–¹å¼æ˜¯ä¼ ç»Ÿæ–¹å¼ï¼Œé€‚åˆæœ¬åœ°ç¯å¢ƒä¸‹å®‰è£…ä½¿ç”¨ï¼›æœ€åä¸€ç§æ–¹å¼åˆ™ä¸ç ´åç³»ç»Ÿç¯å¢ƒï¼Œæ›´é€‚åˆäº‘è®¡ç®—åœºæ™¯ï¼ŒDocker for MacÂ ã€ Docker for WindowsÂ è‡ªå¸¦ docker-composeÂ äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå®‰è£… Docker ä¹‹åå¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚
æŸ¥çœ‹æœ¬æœºæ˜¯å¦å®‰è£…
[root@wangpengliang ~]# docker-compose --version -bash: docker-compose: æœªæ‰¾åˆ°å‘½ä»¤Linuxä¸‹å®‰è£… Compose
">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="#ffffff">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="#343a40">
<meta name="color-scheme" content="light dark"><meta property="og:url" content="http://localhost:1313/docs/docker/1.9dockercompose/">
  <meta property="og:site_name" content="CODE&#39;NOTE">
  <meta property="og:title" content="CODE&#39;NOTE">
  <meta property="og:description" content="Docker ComposeÂ æ˜¯ Docker å®˜æ–¹ç¼–æ’ï¼ˆOrchestrationï¼‰é¡¹ç›®ä¹‹ä¸€ï¼Œè´Ÿè´£å®ç°å¯¹ Docker å®¹å™¨é›†ç¾¤çš„å¿«é€Ÿç¼–æ’ï¼Œå¿«é€Ÿçš„éƒ¨ç½²åˆ†å¸ƒå¼åº”ç”¨ã€‚
é€šè¿‡ä¹‹å‰å­¦ä¹ å·²ç»äº†è§£åˆ°ä½¿ç”¨ä¸€ä¸ª Dockerfile æ¨¡æ¿æ–‡ä»¶ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿çš„å®šä¹‰ä¸€ä¸ªå•ç‹¬çš„åº”ç”¨å®¹å™¨ã€‚ç„¶è€Œåœ¨æ—¥å¸¸å·¥ä½œä¸­ï¼Œç»å¸¸ç¢°åˆ°çš„æƒ…å†µæ˜¯éœ€è¦å¤šä¸ªå®¹å™¨ç›¸äº’é…åˆæ¥å®ŒæˆæŸé¡¹ä»»åŠ¡çš„æƒ…å†µã€‚ä¾‹å¦‚è¦å®ç°ä¸€ä¸ª Web é¡¹ç›®ï¼Œé™¤äº† Web æœåŠ¡å®¹å™¨æœ¬èº«ï¼Œå¾€å¾€è¿˜éœ€è¦å†åŠ ä¸Šåç«¯çš„æ•°æ®åº“æœåŠ¡å®¹å™¨ã€è´Ÿè½½å‡è¡¡å®¹å™¨ç­‰ç­‰ã€‚Compose å°±æ˜¯ç”¨æ¥å¤„ç†è¿™äº›äº‹æƒ…çš„ã€‚å®ƒé€šè¿‡ä¸€ä¸ªå•ç‹¬çš„ docker-compose.yml æ¨¡æ¿æ–‡ä»¶ï¼ˆYAML æ ¼å¼ï¼‰æ¥å®šä¹‰ä¸€ç»„ç›¸å…³è”çš„åº”ç”¨å®¹å™¨ä¸ºä¸€ä¸ªé¡¹ç›®projectã€‚
Compose ä¸­æœ‰ä¸¤ä¸ªé‡è¦çš„æ¦‚å¿µï¼š
æœåŠ¡ (service)ï¼šä¸€ä¸ªåº”ç”¨çš„å®¹å™¨ï¼Œå®é™…ä¸Šå¯ä»¥åŒ…æ‹¬è‹¥å¹²è¿è¡Œç›¸åŒé•œåƒçš„å®¹å™¨å®ä¾‹ é¡¹ç›® (project)ï¼šç”±ä¸€ç»„å…³è”çš„åº”ç”¨å®¹å™¨ç»„æˆçš„ä¸€ä¸ªå®Œæ•´ä¸šåŠ¡å•å…ƒï¼Œåœ¨ docker-compose.yml æ–‡ä»¶ä¸­å®šä¹‰ Compose çš„é»˜è®¤ç®¡ç†å¯¹è±¡æ˜¯é¡¹ç›®ï¼Œé€šè¿‡å­å‘½ä»¤å¯¹é¡¹ç›®ä¸­çš„ä¸€ç»„å®¹å™¨è¿›è¡Œä¾¿æ·åœ°ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼ŒCompose é¡¹ç›®ç”± Python ç¼–å†™ï¼Œå®ç°ä¸Šè°ƒç”¨äº† Docker æœåŠ¡æä¾›çš„ API æ¥å¯¹å®¹å™¨è¿›è¡Œç®¡ç†ã€‚å› æ­¤åªè¦æ‰€æ“ä½œçš„å¹³å°æ”¯æŒ Docker APIÂ å°±å¯ä»¥åœ¨å…¶ä¸Šåˆ©ç”¨ Compose æ¥è¿›è¡Œç¼–æ’ç®¡ç†ã€‚
å®‰è£…# ComposeÂ æ”¯æŒ Linuxã€macOSã€Windows 10 ä¸‰å¤§å¹³å°ï¼Œå®‰è£…æ–¹å¼ï¼š
é€šè¿‡ Python çš„åŒ…ç®¡ç†å·¥å…· pipÂ è¿›è¡Œå®‰è£… ç›´æ¥ä¸‹è½½ç¼–è¯‘å¥½çš„äºŒè¿›åˆ¶æ–‡ä»¶ä½¿ç”¨ ç›´æ¥åœ¨ Docker å®¹å™¨ä¸­è¿è¡Œ å‰ä¸¤ç§æ–¹å¼æ˜¯ä¼ ç»Ÿæ–¹å¼ï¼Œé€‚åˆæœ¬åœ°ç¯å¢ƒä¸‹å®‰è£…ä½¿ç”¨ï¼›æœ€åä¸€ç§æ–¹å¼åˆ™ä¸ç ´åç³»ç»Ÿç¯å¢ƒï¼Œæ›´é€‚åˆäº‘è®¡ç®—åœºæ™¯ï¼ŒDocker for MacÂ ã€ Docker for WindowsÂ è‡ªå¸¦ docker-composeÂ äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå®‰è£… Docker ä¹‹åå¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚
æŸ¥çœ‹æœ¬æœºæ˜¯å¦å®‰è£…
[root@wangpengliang ~]# docker-compose --version -bash: docker-compose: æœªæ‰¾åˆ°å‘½ä»¤Linuxä¸‹å®‰è£… Compose">
  <meta property="og:locale" content="zh_cn">
  <meta property="og:type" content="article">
    <meta property="article:section" content="docs">


  <meta itemprop="name" content="CODE&#39;NOTE">
  <meta itemprop="description" content="Docker ComposeÂ æ˜¯ Docker å®˜æ–¹ç¼–æ’ï¼ˆOrchestrationï¼‰é¡¹ç›®ä¹‹ä¸€ï¼Œè´Ÿè´£å®ç°å¯¹ Docker å®¹å™¨é›†ç¾¤çš„å¿«é€Ÿç¼–æ’ï¼Œå¿«é€Ÿçš„éƒ¨ç½²åˆ†å¸ƒå¼åº”ç”¨ã€‚
é€šè¿‡ä¹‹å‰å­¦ä¹ å·²ç»äº†è§£åˆ°ä½¿ç”¨ä¸€ä¸ª Dockerfile æ¨¡æ¿æ–‡ä»¶ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿çš„å®šä¹‰ä¸€ä¸ªå•ç‹¬çš„åº”ç”¨å®¹å™¨ã€‚ç„¶è€Œåœ¨æ—¥å¸¸å·¥ä½œä¸­ï¼Œç»å¸¸ç¢°åˆ°çš„æƒ…å†µæ˜¯éœ€è¦å¤šä¸ªå®¹å™¨ç›¸äº’é…åˆæ¥å®ŒæˆæŸé¡¹ä»»åŠ¡çš„æƒ…å†µã€‚ä¾‹å¦‚è¦å®ç°ä¸€ä¸ª Web é¡¹ç›®ï¼Œé™¤äº† Web æœåŠ¡å®¹å™¨æœ¬èº«ï¼Œå¾€å¾€è¿˜éœ€è¦å†åŠ ä¸Šåç«¯çš„æ•°æ®åº“æœåŠ¡å®¹å™¨ã€è´Ÿè½½å‡è¡¡å®¹å™¨ç­‰ç­‰ã€‚Compose å°±æ˜¯ç”¨æ¥å¤„ç†è¿™äº›äº‹æƒ…çš„ã€‚å®ƒé€šè¿‡ä¸€ä¸ªå•ç‹¬çš„ docker-compose.yml æ¨¡æ¿æ–‡ä»¶ï¼ˆYAML æ ¼å¼ï¼‰æ¥å®šä¹‰ä¸€ç»„ç›¸å…³è”çš„åº”ç”¨å®¹å™¨ä¸ºä¸€ä¸ªé¡¹ç›®projectã€‚
Compose ä¸­æœ‰ä¸¤ä¸ªé‡è¦çš„æ¦‚å¿µï¼š
æœåŠ¡ (service)ï¼šä¸€ä¸ªåº”ç”¨çš„å®¹å™¨ï¼Œå®é™…ä¸Šå¯ä»¥åŒ…æ‹¬è‹¥å¹²è¿è¡Œç›¸åŒé•œåƒçš„å®¹å™¨å®ä¾‹ é¡¹ç›® (project)ï¼šç”±ä¸€ç»„å…³è”çš„åº”ç”¨å®¹å™¨ç»„æˆçš„ä¸€ä¸ªå®Œæ•´ä¸šåŠ¡å•å…ƒï¼Œåœ¨ docker-compose.yml æ–‡ä»¶ä¸­å®šä¹‰ Compose çš„é»˜è®¤ç®¡ç†å¯¹è±¡æ˜¯é¡¹ç›®ï¼Œé€šè¿‡å­å‘½ä»¤å¯¹é¡¹ç›®ä¸­çš„ä¸€ç»„å®¹å™¨è¿›è¡Œä¾¿æ·åœ°ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼ŒCompose é¡¹ç›®ç”± Python ç¼–å†™ï¼Œå®ç°ä¸Šè°ƒç”¨äº† Docker æœåŠ¡æä¾›çš„ API æ¥å¯¹å®¹å™¨è¿›è¡Œç®¡ç†ã€‚å› æ­¤åªè¦æ‰€æ“ä½œçš„å¹³å°æ”¯æŒ Docker APIÂ å°±å¯ä»¥åœ¨å…¶ä¸Šåˆ©ç”¨ Compose æ¥è¿›è¡Œç¼–æ’ç®¡ç†ã€‚
å®‰è£…# ComposeÂ æ”¯æŒ Linuxã€macOSã€Windows 10 ä¸‰å¤§å¹³å°ï¼Œå®‰è£…æ–¹å¼ï¼š
é€šè¿‡ Python çš„åŒ…ç®¡ç†å·¥å…· pipÂ è¿›è¡Œå®‰è£… ç›´æ¥ä¸‹è½½ç¼–è¯‘å¥½çš„äºŒè¿›åˆ¶æ–‡ä»¶ä½¿ç”¨ ç›´æ¥åœ¨ Docker å®¹å™¨ä¸­è¿è¡Œ å‰ä¸¤ç§æ–¹å¼æ˜¯ä¼ ç»Ÿæ–¹å¼ï¼Œé€‚åˆæœ¬åœ°ç¯å¢ƒä¸‹å®‰è£…ä½¿ç”¨ï¼›æœ€åä¸€ç§æ–¹å¼åˆ™ä¸ç ´åç³»ç»Ÿç¯å¢ƒï¼Œæ›´é€‚åˆäº‘è®¡ç®—åœºæ™¯ï¼ŒDocker for MacÂ ã€ Docker for WindowsÂ è‡ªå¸¦ docker-composeÂ äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå®‰è£… Docker ä¹‹åå¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚
æŸ¥çœ‹æœ¬æœºæ˜¯å¦å®‰è£…
[root@wangpengliang ~]# docker-compose --version -bash: docker-compose: æœªæ‰¾åˆ°å‘½ä»¤Linuxä¸‹å®‰è£… Compose">
  <meta itemprop="wordCount" content="2120">

<title>1.9 Docker Compose | CODE&#39;NOTE</title>
<link rel="icon" href="/favicon.png" >
<link rel="manifest" href="/manifest.json">
<link rel="canonical" href="http://localhost:1313/docs/docker/1.9dockercompose/">
<link rel="stylesheet" href="/book.min.6970156cec683193d93c9c4edaf0d56574e4361df2e0c1be4f697ae81c3ba55f.css" integrity="sha256-aXAVbOxoMZPZPJxO2vDVZXTkNh3y4MG&#43;T2l66Bw7pV8=" crossorigin="anonymous">


  <script defer src="/fuse.min.js"></script>
  <script defer src="/en.search.min.72bb05277db45a350ae52e783022518711f9de188da0da18be86b61b9cf0bf4c.js" integrity="sha256-crsFJ320WjUK5S54MCJRhxH53hiNoNoYvoa2G5zwv0w=" crossorigin="anonymous"></script>



  
</head>
<body dir="ltr" class="book-kind-page book-type-docs">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    
<aside class="book-menu">
  <div class="book-menu-content">
    
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/"><span>CODE&#39;NOTE</span>
  </a>
</h2>


<div class="book-search hidden">
  <input id="book-search-input" type="text" 
    placeholder="Search"
    aria-label="Search"
    maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>
<script>document.querySelector(".book-search").classList.remove("hidden")</script>













  
  <ul>
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-0a19d3a7daa7f2a902390735b978f141" class="toggle"  />
    <label for="section-0a19d3a7daa7f2a902390735b978f141" class="flex">
      <a role="button" class="">
        ğŸ“š .NET</a>
      <img src="/icons/chevron-right.svg" class="book-icon" alt="Expand" />
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/dotnet/%E5%80%BC%E7%B1%BB%E5%9E%8B%E5%92%8C%E5%BC%95%E7%94%A8%E7%B1%BB%E5%9E%8B%E7%9A%84%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D/" class="">
      å€¼ç±»å‹å’Œå¼•ç”¨ç±»å‹çš„å†…å­˜åˆ†é…</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/dotnet/%E5%8F%8D%E5%B0%84%E6%8A%80%E6%9C%AF/" class="">
      åå°„æŠ€æœ¯</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/dotnet/%E5%9F%BA%E7%A1%80%E5%90%88%E9%9B%86/" class="">
      åŸºç¡€åˆé›†</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/dotnet/%E5%A4%9A%E7%BA%BF%E7%A8%8B/" class="">
      å¤šçº¿ç¨‹</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/dotnet/%E5%A7%94%E6%89%98%E5%92%8C%E4%BA%8B%E4%BB%B6/" class="">
      å§”æ‰˜å’Œäº‹ä»¶</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/dotnet/%E5%B9%B6%E8%A1%8C%E7%BC%96%E7%A8%8B/" class="">
      å¹¶è¡Œç¼–ç¨‹</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/dotnet/%E5%BC%82%E6%AD%A5%E7%BC%96%E7%A8%8B/" class="">
      å¼‚æ­¥ç¼–ç¨‹</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/dotnet/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" class="">
      æ•°æ®ç»“æ„</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/dotnet/%E6%B3%9B%E5%9E%8B%E6%8A%80%E6%9C%AF/" class="">
      æ³›å‹æŠ€æœ¯</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/dotnet/%E7%BA%BF%E7%A8%8B%E5%90%8C%E6%AD%A5/" class="">
      çº¿ç¨‹åŒæ­¥</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/dotnet/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/" class="">
      é¢å‘å¯¹è±¡</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-a711e15e6217a03d3f896c4001f054af" class="toggle"  />
    <label for="section-a711e15e6217a03d3f896c4001f054af" class="flex">
      <a role="button" class="">
        ğŸ­ PMI-ACP</a>
      <img src="/icons/chevron-right.svg" class="book-icon" alt="Expand" />
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/acp/pmi-acp%E5%9F%BA%E7%A1%80%E4%BA%86%E8%A7%A3/" class="">
      Pmi AcpåŸºç¡€äº†è§£</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/acp/pmi-acpdown/" class="">
      Pmi Acpdown</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/acp/pmi-acp%E5%A4%87%E8%80%83%E7%AC%94%E8%AE%B001/" class="">
      Pmi Acpå¤‡è€ƒç¬”è®°01</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/acp/pmi-acp%E5%A4%87%E8%80%83%E7%AC%94%E8%AE%B002/" class="">
      Pmi Acpå¤‡è€ƒç¬”è®°02</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/acp/pmi-acp%E5%A4%87%E8%80%83%E7%AC%94%E8%AE%B003/" class="">
      Pmi Acpå¤‡è€ƒç¬”è®°03</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-158c55270b3b873b36b554def2308a8c" class="toggle"  />
    <label for="section-158c55270b3b873b36b554def2308a8c" class="flex">
      <a role="button" class="">
        âŒ› è½¯ä»¶æµ‹è¯•</a>
      <img src="/icons/chevron-right.svg" class="book-icon" alt="Expand" />
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/test/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/" class="">
      å•å…ƒæµ‹è¯•</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/test/%E5%8E%8B%E5%8A%9B%E6%B5%8B%E8%AF%95k6/" class="">
      å‹åŠ›æµ‹è¯•k6</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/test/%E8%87%AA%E5%8A%A8%E5%8C%96ui%E6%B5%8B%E8%AF%95/" class="">
      è‡ªåŠ¨åŒ– Uiæµ‹è¯•</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/test/%E9%9B%86%E6%88%90%E6%B5%8B%E8%AF%95/" class="">
      é›†æˆæµ‹è¯•</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-9e4cd5c9690a397be164e18996eeec25" class="toggle"  />
    <label for="section-9e4cd5c9690a397be164e18996eeec25" class="flex">
      <a role="button" class="">
        â›·ï¸ Prometheus</a>
      <img src="/icons/chevron-right.svg" class="book-icon" alt="Expand" />
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/prometheus/1.1prometheus%E7%AE%80%E4%BB%8B%E5%8F%8A%E5%AE%89%E8%A3%85/" class="">
      1.1 Prometheusç®€ä»‹åŠå®‰è£…</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/prometheus/1.2exporter%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86/" class="">
      1.2 Exporteræ•°æ®é‡‡é›†</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/prometheus/1.3promql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E8%A8%80/" class="">
      1.3 Prom QlæŸ¥è¯¢è¯­è¨€</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/prometheus/1.4alertmanager%E5%91%8A%E8%AD%A6%E5%A4%84%E7%90%86/" class="">
      1.4 Alertmanagerå‘Šè­¦å¤„ç†</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/prometheus/1.5grafana%E7%9B%91%E6%8E%A7%E5%8F%AF%E8%A7%86%E5%8C%96/" class="">
      1.5 Grafanaç›‘æ§å¯è§†åŒ–</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-ed189cb26f56d17bb0a62923d94a7183" class="toggle"  />
    <label for="section-ed189cb26f56d17bb0a62923d94a7183" class="flex">
      <a role="button" class="">
        ğŸ‡ RabbitMq</a>
      <img src="/icons/chevron-right.svg" class="book-icon" alt="Expand" />
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/rabbitmq/1.1rabbitmq%E6%A6%82%E5%BF%B5%E5%8F%8A%E5%AE%89%E8%A3%85/" class="">
      1.1 Rabbit Mqæ¦‚å¿µåŠå®‰è£…</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/rabbitmq/1.2%E5%B7%A5%E4%BD%9C%E6%A8%A1%E5%BC%8F%E4%BB%8B%E7%BB%8D/" class="">
      1.2å·¥ä½œæ¨¡å¼ä»‹ç»</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/rabbitmq/1.3%E6%B6%88%E6%81%AF%E7%A1%AE%E8%AE%A4%E5%8F%8A%E6%8C%81%E4%B9%85%E5%8C%96/" class="">
      1.3æ¶ˆæ¯ç¡®è®¤åŠæŒä¹…åŒ–</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/rabbitmq/1.4%E4%B8%A4%E7%A7%8D%E6%B6%88%E8%B4%B9%E6%A8%A1%E5%BC%8F%E5%92%8Cqos%E7%9A%84%E5%AE%9E%E7%8E%B0/" class="">
      1.4ä¸¤ç§æ¶ˆè´¹æ¨¡å¼å’Œ Qosçš„å®ç°</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/rabbitmq/1.5channel%E5%B8%B8%E8%A7%81%E6%96%B9%E6%B3%95/" class="">
      1.5 Channelå¸¸è§æ–¹æ³•</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/rabbitmq/1.6rabbitmq%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/" class="">
      1.6 Rabbit Mqå¸¸ç”¨å‘½ä»¤</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/rabbitmq/1.7rabbitmq%E5%B8%B8%E8%A7%81%E7%AD%96%E7%95%A5/" class="">
      1.7 Rabbit Mqå¸¸è§ç­–ç•¥</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/rabbitmq/1.8rabbitmq%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98/" class="">
      1.8 Rabbit Mqå¸¸è§é—®é¢˜</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/rabbitmq/1.9rabbitmq%E9%9B%86%E7%BE%A4%E6%96%B9%E6%A1%88/" class="">
      1.9 Rabbit Mqé›†ç¾¤æ–¹æ¡ˆ</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/rabbitmq/%E5%AE%A2%E6%88%B7%E7%AB%AF%E8%BF%9E%E6%8E%A5rabbitmq/" class="">
      å®¢æˆ·ç«¯è¿æ¥ Rabbit Mq</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-41a08237d2a583bb6567a7bd11f94f3e" class="toggle"  />
    <label for="section-41a08237d2a583bb6567a7bd11f94f3e" class="flex">
      <a role="button" class="">
        ğŸ¹ Golang</a>
      <img src="/icons/chevron-right.svg" class="book-icon" alt="Expand" />
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/go/01%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/" class="">
      01å¼€å‘ç¯å¢ƒæ­å»º</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/go/02%E5%8F%98%E9%87%8F%E5%92%8C%E5%B8%B8%E9%87%8F/" class="">
      02å˜é‡å’Œå¸¸é‡</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/go/03%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/" class="">
      03åŸºæœ¬æ•°æ®ç±»å‹</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/go/04%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6%E5%92%8C%E8%BF%90%E7%AE%97%E7%AC%A6/" class="">
      04æµç¨‹æ§åˆ¶å’Œè¿ç®—ç¬¦</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/go/05%E6%95%B0%E7%BB%84/" class="">
      05æ•°ç»„</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/go/06%E5%88%87%E7%89%87/" class="">
      06åˆ‡ç‰‡</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/go/07map/" class="">
      07map</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/go/08%E5%87%BD%E6%95%B0/" class="">
      08å‡½æ•°</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/go/09%E6%8C%87%E9%92%88/" class="">
      09æŒ‡é’ˆ</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/go/10%E5%8F%8D%E5%B0%84/" class="">
      10åå°„</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/go/11%E7%BB%93%E6%9E%84%E4%BD%93/" class="">
      11ç»“æ„ä½“</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/go/12%E6%8E%A5%E5%8F%A3/" class="">
      12æ¥å£</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/go/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/channel/" class="">
      Channel</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/go/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/csp%E5%B9%B6%E5%8F%91%E6%A8%A1%E5%9E%8B/" class="">
      Cspå¹¶å‘æ¨¡å‹</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/go/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/goroutine/" class="">
      Goroutine</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/go/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/gpm%E5%8E%9F%E7%90%86%E4%B8%8E%E8%B0%83%E5%BA%A6/" class="">
      GpmåŸç†ä¸è°ƒåº¦</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/go/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/%E5%8E%9F%E5%AD%90%E6%93%8D%E4%BD%9C/" class="">
      åŸå­æ“ä½œ</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/go/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/%E5%B9%B6%E5%8F%91%E5%AE%89%E5%85%A8%E5%92%8C%E9%94%81/" class="">
      å¹¶å‘å®‰å…¨å’Œé”</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/go/%E6%A0%87%E5%87%86%E5%BA%93/flag/" class="">
      Flag</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/go/%E6%A0%87%E5%87%86%E5%BA%93/fmt/" class="">
      Fmt</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/go/%E6%A0%87%E5%87%86%E5%BA%93/log/" class="">
      Log</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/go/%E6%A0%87%E5%87%86%E5%BA%93/time/" class="">
      Time</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-a212feaafca18e39712c162267ab7930" class="toggle"  />
    <label for="section-a212feaafca18e39712c162267ab7930" class="flex">
      <a role="button" class="">
        ğŸ’« Microservice</a>
      <img src="/icons/chevron-right.svg" class="book-icon" alt="Expand" />
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/microservice/1.1%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%85%A5%E9%97%A8%E4%B9%8B%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA/" class="">
      1.1å¾®æœåŠ¡å…¥é—¨ä¹‹é¡¹ç›®æ­å»º</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/microservice/1.2%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%85%A5%E9%97%A8%E4%B9%8B%E6%9C%8D%E5%8A%A1%E6%B3%A8%E5%86%8C%E4%B8%8E%E5%8F%91%E7%8E%B0/" class="">
      1.2å¾®æœåŠ¡å…¥é—¨ä¹‹æœåŠ¡æ³¨å†Œä¸å‘ç°</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/microservice/1.3%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%85%A5%E9%97%A8%E4%B9%8B%E7%BD%91%E5%85%B3/" class="">
      1.3å¾®æœåŠ¡å…¥é—¨ä¹‹ç½‘å…³</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/microservice/1.4%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%85%A5%E9%97%A8%E4%B9%8B%E4%BA%8B%E4%BB%B6%E6%80%BB%E7%BA%BF/" class="">
      1.4å¾®æœåŠ¡å…¥é—¨ä¹‹äº‹ä»¶æ€»çº¿</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/microservice/1.5%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%85%A5%E9%97%A8%E4%B9%8Bdockercompose/" class="">
      1.5å¾®æœåŠ¡å…¥é—¨ä¹‹ Docker Compose</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/microservice/consul%E6%9C%8D%E5%8A%A1%E6%B3%A8%E5%86%8C%E5%8F%91%E7%8E%B0/" class="">
      ConsulæœåŠ¡æ³¨å†Œå‘ç°</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-797c59d4c24223beac308482801fe996" class="toggle"  />
    <label for="section-797c59d4c24223beac308482801fe996" class="flex">
      <a role="button" class="">
        ğŸ“¦ Redis</a>
      <img src="/icons/chevron-right.svg" class="book-icon" alt="Expand" />
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/redis/1.10redis%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98/" class="">
      1.10 Rediså¸¸è§é—®é¢˜</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/redis/1.1nosql%E6%A6%82%E8%BF%B0/" class="">
      1.1 No Sqlæ¦‚è¿°</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/redis/1.2redis%E5%AE%89%E8%A3%85/" class="">
      1.2 Rediså®‰è£…</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/redis/1.3redis%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/" class="">
      1.3 RedisåŸºæœ¬æ•°æ®ç±»å‹</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/redis/1.4redis%E7%89%B9%E6%AE%8A%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/" class="">
      1.4 Redisç‰¹æ®Šæ•°æ®ç±»å‹</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/redis/1.5redis%E4%BA%8B%E5%8A%A1%E6%93%8D%E4%BD%9C/" class="">
      1.5 Redisäº‹åŠ¡æ“ä½œ</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/redis/1.6redis%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E8%AF%A6%E8%A7%A3/" class="">
      1.6 Redisé…ç½®æ–‡ä»¶è¯¦è§£</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/redis/1.7redis%E6%8C%81%E4%B9%85%E5%8C%96/" class="">
      1.7 RedisæŒä¹…åŒ–</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/redis/1.8redis%E5%8F%91%E5%B8%83%E8%AE%A2%E9%98%85/" class="">
      1.8 Rediså‘å¸ƒè®¢é˜…</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/redis/1.9redis%E9%9B%86%E7%BE%A4%E6%96%B9%E6%A1%88/" class="">
      1.9 Redisé›†ç¾¤æ–¹æ¡ˆ</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/redis/%E4%BD%BF%E7%94%A8docker%E6%90%AD%E5%BB%BAredis%E9%9B%86%E7%BE%A4/" class="">
      ä½¿ç”¨ Dockeræ­å»º Redisé›†ç¾¤</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/redis/%E5%AE%A2%E6%88%B7%E7%AB%AF%E8%BF%9E%E6%8E%A5redis/" class="">
      å®¢æˆ·ç«¯è¿æ¥ Redis</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-146aedbcf8714fb62838757a1082a467" class="toggle"  />
    <label for="section-146aedbcf8714fb62838757a1082a467" class="flex">
      <a role="button" class="">
        ğŸ” ELK</a>
      <img src="/icons/chevron-right.svg" class="book-icon" alt="Expand" />
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/elk/1.1elastaticsearch%E5%85%A5%E9%97%A8/" class="">
      1.1 Elastatic Searchå…¥é—¨</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/elk/1.2elastaticsearch%E9%85%8D%E7%BD%AE/" class="">
      1.2 Elastatic Searché…ç½®</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/elk/1.3%E4%BD%BF%E7%94%A8kibana%E6%93%8D%E4%BD%9Ces/" class="">
      1.3ä½¿ç”¨ Kibanaæ“ä½œ Es</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-e876d2a6c86b79fe88fd120640b84773" class="toggle" checked />
    <label for="section-e876d2a6c86b79fe88fd120640b84773" class="flex">
      <a role="button" class="">
        ğŸš¢ Docker</a>
      <img src="/icons/chevron-right.svg" class="book-icon" alt="Expand" />
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/docker/1.1docker%E6%A6%82%E5%BF%B5%E5%8F%8A%E5%AE%89%E8%A3%85/" class="">
      1.1 Dockeræ¦‚å¿µåŠå®‰è£…</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/docker/1.2docker%E9%95%9C%E5%83%8F/" class="">
      1.2 Dockeré•œåƒ</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/docker/1.3docker%E5%AE%B9%E5%99%A8/" class="">
      1.3 Dockerå®¹å™¨</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/docker/1.4docker%E4%BB%93%E5%BA%93/" class="">
      1.4 Dockerä»“åº“</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/docker/1.5docker%E6%95%B0%E6%8D%AE%E7%AE%A1%E7%90%86/" class="">
      1.5 Dockeræ•°æ®ç®¡ç†</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/docker/1.6docker%E5%AE%B9%E5%99%A8%E7%BD%91%E7%BB%9C%E6%A8%A1%E5%BC%8F/" class="">
      1.6 Dockerå®¹å™¨ç½‘ç»œæ¨¡å¼</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/docker/1.7docker%E9%AB%98%E7%BA%A7%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE/" class="">
      1.7 Dockeré«˜çº§ç½‘ç»œé…ç½®</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/docker/1.8dockerfile/" class="">
      1.8 Dockerfile</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/docker/1.9dockercompose/" class="active">
      1.9 Docker Compose</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/docker/2.0dockermachine/" class="">
      2.0 Docker Machine</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/docker/2.1dockerswarm/" class="">
      2.1 Docker Swarm</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/docker/2.2docker%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/" class="">
      2.2 Dockerå¸¸ç”¨å‘½ä»¤</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/docker/2.3portainer%E5%8F%AF%E8%A7%86%E5%8C%96%E9%9D%A2%E6%9D%BF/" class="">
      2.3 Portainerå¯è§†åŒ–é¢æ¿</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-31ced7a6f12c0e1d312f5c9d5aa42f8e" class="toggle"  />
    <label for="section-31ced7a6f12c0e1d312f5c9d5aa42f8e" class="flex">
      <a role="button" class="">
        ğŸ•¸ï¸ K8s</a>
      <img src="/icons/chevron-right.svg" class="book-icon" alt="Expand" />
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/kubernetes/kubernetes%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/" class="">
      KubernetesåŸºç¡€çŸ¥è¯†</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/kubernetes/kubernetes%E9%9B%86%E7%BE%A4%E5%AE%89%E8%A3%85/" class="">
      Kubernetesé›†ç¾¤å®‰è£…</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-b7939089f2d38db5071ac1464e01a040" class="toggle"  />
    <label for="section-b7939089f2d38db5071ac1464e01a040" class="flex">
      <a role="button" class="">
        ğŸ–¥ï¸ Linux</a>
      <img src="/icons/chevron-right.svg" class="book-icon" alt="Expand" />
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/linux/centos7%E5%8D%87%E7%BA%A7gcc%E7%89%88%E6%9C%AC/" class="">
      Centos7å‡çº§gccç‰ˆæœ¬</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/linux/centos%E5%AE%89%E8%A3%85hexo/" class="">
      Centoså®‰è£… Hexo</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/linux/centos%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE/" class="">
      Centosç½‘ç»œé…ç½®</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/linux/linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/" class="">
      Linuxå¸¸ç”¨å‘½ä»¤</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/linux/linux%E7%9B%AE%E5%BD%95%E8%AF%B4%E6%98%8E/" class="">
      Linuxç›®å½•è¯´æ˜</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/linux/vmware%E5%AE%89%E8%A3%85centos/" class="">
      Vmwareå®‰è£… Centos</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
      
        <li>
          
  
  

  
    <input type="checkbox" id="section-3f1b0bb4bbdd3ea5d43f21f5b8664c28" class="toggle"  />
    <label for="section-3f1b0bb4bbdd3ea5d43f21f5b8664c28" class="flex">
      <a role="button" class="">
        ğŸ›ï¸ Devops</a>
      <img src="/icons/chevron-right.svg" class="book-icon" alt="Expand" />
    </label>
  

          
  <ul>
    
      
        <li>
          
  
  

  
    <a href="/docs/devops/gitlab%E5%AE%89%E8%A3%85/" class="">
      Gitlabå®‰è£…</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/devops/jenkins%E5%AE%89%E8%A3%85/" class="">
      Jenkinså®‰è£…</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/devops/jenkins%E5%B8%B8%E8%A7%81%E6%93%8D%E4%BD%9C/" class="">
      Jenkinså¸¸è§æ“ä½œ</a>
  

        </li>
      
    
      
        <li>
          
  
  

  
    <a href="/docs/devops/nugetserver%E6%90%AD%E5%BB%BA/" class="">
      Nuget Serveræ­å»º</a>
  

        </li>
      
    
  </ul>

        </li>
      
    
  </ul>













</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>



  </div>
</aside>
 

    <div class="book-page">
      <header class="book-header hidden">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/icons/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <h3>1.9 Docker Compose</h3>

  <label for="toc-control">
    
    <img src="/icons/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden">
    
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#å‘½ä»¤é€‰é¡¹">å‘½ä»¤é€‰é¡¹</a></li>
    <li><a href="#å‘½ä»¤ä½¿ç”¨è¯´æ˜">å‘½ä»¤ä½¿ç”¨è¯´æ˜</a>
      <ul>
        <li><a href="#build">build</a></li>
        <li><a href="#config">config</a></li>
        <li><a href="#down">down</a></li>
        <li><a href="#exec">exec</a></li>
        <li><a href="#help">help</a></li>
        <li><a href="#images">images</a></li>
        <li><a href="#kill">kill</a></li>
        <li><a href="#logs">logs</a></li>
        <li><a href="#pause">pause</a></li>
        <li><a href="#port">port</a></li>
        <li><a href="#ps">ps</a></li>
        <li><a href="#pull">pull</a></li>
        <li><a href="#push">push</a></li>
        <li><a href="#restart">restart</a></li>
        <li><a href="#rm">rm</a></li>
        <li><a href="#run">run</a></li>
        <li><a href="#scale">scale</a></li>
        <li><a href="#start">start</a></li>
        <li><a href="#stop">stop</a></li>
        <li><a href="#top">top</a></li>
        <li><a href="#unpause">unpause</a></li>
        <li><a href="#up">up</a></li>
        <li><a href="#version">version</a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li><a href="#build-1">build</a></li>
    <li><a href="#cap_add-cap_drop">cap_add, cap_drop</a></li>
    <li><a href="#command">command</a></li>
    <li><a href="#cgroup_parent">cgroup_parent</a></li>
    <li><a href="#container_name">container_name</a></li>
    <li><a href="#devices">devices</a></li>
    <li><a href="#depends_on">depends_on</a></li>
    <li><a href="#dns">dns</a></li>
    <li><a href="#dns_search">dns_search</a></li>
    <li><a href="#tmpfs">tmpfs</a></li>
    <li><a href="#env_file">env_file</a></li>
    <li><a href="#environment">environment</a></li>
    <li><a href="#expose">expose</a></li>
    <li><a href="#external_links">external_links</a></li>
    <li><a href="#extra_hosts">extra_hosts</a></li>
    <li><a href="#healthcheck">healthcheck</a></li>
    <li><a href="#image">image</a></li>
    <li><a href="#labels">labels</a></li>
    <li><a href="#links">links</a></li>
    <li><a href="#logging">logging</a></li>
    <li><a href="#network_mode">network_mode</a></li>
    <li><a href="#networks">networks</a></li>
    <li><a href="#pid">pid</a></li>
    <li><a href="#ports">ports</a></li>
    <li><a href="#secrets">secrets</a></li>
    <li><a href="#security_opt">security_opt</a></li>
    <li><a href="#stop_signal">stop_signal</a></li>
    <li><a href="#sysctls">sysctls</a></li>
    <li><a href="#ulimits">ulimits</a></li>
    <li><a href="#volumes">volumes</a></li>
    <li><a href="#å…¶å®ƒæŒ‡ä»¤">å…¶å®ƒæŒ‡ä»¤</a></li>
    <li><a href="#è¯»å–å˜é‡">è¯»å–å˜é‡</a></li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
  <article class="markdown book-article"><blockquote class='book-hint '>
<p><code>Docker Compose</code>Â æ˜¯ Docker å®˜æ–¹ç¼–æ’ï¼ˆOrchestrationï¼‰é¡¹ç›®ä¹‹ä¸€ï¼Œè´Ÿè´£å®ç°å¯¹ Docker å®¹å™¨é›†ç¾¤çš„å¿«é€Ÿç¼–æ’ï¼Œå¿«é€Ÿçš„éƒ¨ç½²åˆ†å¸ƒå¼åº”ç”¨ã€‚</p>
</blockquote><p>é€šè¿‡ä¹‹å‰å­¦ä¹ å·²ç»äº†è§£åˆ°ä½¿ç”¨ä¸€ä¸ª <code>Dockerfile</code> æ¨¡æ¿æ–‡ä»¶ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿çš„å®šä¹‰ä¸€ä¸ªå•ç‹¬çš„åº”ç”¨å®¹å™¨ã€‚ç„¶è€Œåœ¨æ—¥å¸¸å·¥ä½œä¸­ï¼Œç»å¸¸ç¢°åˆ°çš„æƒ…å†µæ˜¯éœ€è¦å¤šä¸ªå®¹å™¨ç›¸äº’é…åˆæ¥å®ŒæˆæŸé¡¹ä»»åŠ¡çš„æƒ…å†µã€‚ä¾‹å¦‚è¦å®ç°ä¸€ä¸ª Web é¡¹ç›®ï¼Œé™¤äº† Web æœåŠ¡å®¹å™¨æœ¬èº«ï¼Œå¾€å¾€è¿˜éœ€è¦å†åŠ ä¸Šåç«¯çš„æ•°æ®åº“æœåŠ¡å®¹å™¨ã€è´Ÿè½½å‡è¡¡å®¹å™¨ç­‰ç­‰ã€‚<code>Compose</code> å°±æ˜¯ç”¨æ¥å¤„ç†è¿™äº›äº‹æƒ…çš„ã€‚å®ƒé€šè¿‡ä¸€ä¸ªå•ç‹¬çš„ <code>docker-compose.yml</code> æ¨¡æ¿æ–‡ä»¶ï¼ˆYAML æ ¼å¼ï¼‰æ¥å®šä¹‰ä¸€ç»„ç›¸å…³è”çš„åº”ç”¨å®¹å™¨ä¸ºä¸€ä¸ªé¡¹ç›®<code>project</code>ã€‚</p>
<p><code>Compose</code> ä¸­æœ‰ä¸¤ä¸ªé‡è¦çš„æ¦‚å¿µï¼š</p>
<ul>
<li>æœåŠ¡ (<code>service</code>)ï¼šä¸€ä¸ªåº”ç”¨çš„å®¹å™¨ï¼Œå®é™…ä¸Šå¯ä»¥åŒ…æ‹¬è‹¥å¹²è¿è¡Œç›¸åŒé•œåƒçš„å®¹å™¨å®ä¾‹</li>
<li>é¡¹ç›® (<code>project</code>)ï¼šç”±ä¸€ç»„å…³è”çš„åº”ç”¨å®¹å™¨ç»„æˆçš„ä¸€ä¸ªå®Œæ•´ä¸šåŠ¡å•å…ƒï¼Œåœ¨ <code>docker-compose.yml</code> æ–‡ä»¶ä¸­å®šä¹‰</li>
</ul>
<p><code>Compose</code> çš„é»˜è®¤ç®¡ç†å¯¹è±¡æ˜¯é¡¹ç›®ï¼Œé€šè¿‡å­å‘½ä»¤å¯¹é¡¹ç›®ä¸­çš„ä¸€ç»„å®¹å™¨è¿›è¡Œä¾¿æ·åœ°ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼Œ<code>Compose</code> é¡¹ç›®ç”± Python ç¼–å†™ï¼Œå®ç°ä¸Šè°ƒç”¨äº† Docker æœåŠ¡æä¾›çš„ API æ¥å¯¹å®¹å™¨è¿›è¡Œç®¡ç†ã€‚å› æ­¤åªè¦æ‰€æ“ä½œçš„å¹³å°æ”¯æŒ <code>Docker API</code>Â å°±å¯ä»¥åœ¨å…¶ä¸Šåˆ©ç”¨ <code>Compose</code> æ¥è¿›è¡Œç¼–æ’ç®¡ç†ã€‚</p>
<h1 id="å®‰è£…">å®‰è£…<a class="anchor" href="#%e5%ae%89%e8%a3%85">#</a></h1>
<p><code>Compose</code>Â  æ”¯æŒ Linuxã€macOSã€Windows 10 ä¸‰å¤§å¹³å°ï¼Œå®‰è£…æ–¹å¼ï¼š</p>
<ol>
<li>é€šè¿‡ Python çš„åŒ…ç®¡ç†å·¥å…· <code>pip</code>Â  è¿›è¡Œå®‰è£…</li>
<li>ç›´æ¥ä¸‹è½½ç¼–è¯‘å¥½çš„äºŒè¿›åˆ¶æ–‡ä»¶ä½¿ç”¨</li>
<li>ç›´æ¥åœ¨ Docker å®¹å™¨ä¸­è¿è¡Œ</li>
</ol>
<p>å‰ä¸¤ç§æ–¹å¼æ˜¯ä¼ ç»Ÿæ–¹å¼ï¼Œé€‚åˆæœ¬åœ°ç¯å¢ƒä¸‹å®‰è£…ä½¿ç”¨ï¼›æœ€åä¸€ç§æ–¹å¼åˆ™ä¸ç ´åç³»ç»Ÿç¯å¢ƒï¼Œæ›´é€‚åˆäº‘è®¡ç®—åœºæ™¯ï¼Œ<code>Docker for Mac</code>Â  ã€ <code>Docker for Windows</code>Â  è‡ªå¸¦ <code>docker-compose</code>Â  äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œå®‰è£… Docker ä¹‹åå¯ä»¥ç›´æ¥ä½¿ç”¨ã€‚</p>
<p><strong>æŸ¥çœ‹æœ¬æœºæ˜¯å¦å®‰è£…</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#f92672">[</span>root@wangpengliang ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker-compose --version</span>
</span></span><span style="display:flex;"><span>-bash: docker-compose: æœªæ‰¾åˆ°å‘½ä»¤</span></span></code></pre></div><p><strong>Linuxä¸‹å®‰è£… Compose</strong></p>
<p>åœ¨ Linux ä¸Šå®‰è£…ååˆ†ç®€å•ï¼Œä» å®˜æ–¹ GitHub Release å¤„ç›´æ¥ä¸‹è½½ç¼–è¯‘å¥½çš„äºŒè¿›åˆ¶æ–‡ä»¶å³å¯ã€‚</p>
<p>ä¾‹å¦‚ï¼Œåœ¨ Linux 64 ä½ç³»ç»Ÿä¸Šç›´æ¥ä¸‹è½½å¯¹åº”çš„äºŒè¿›åˆ¶åŒ…</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ sudo curl -L https://github.com/docker/compose/releases/download/1.17.1/docker-compose-uname -s-uname -m &gt; /usr/local/bin/docker-compose
</span></span><span style="display:flex;"><span>$ sudo chmod +x /usr/local/bin/docker-compose</span></span></code></pre></div><p>æŸ¥çœ‹æœ¬æœºæ¶æ„</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#f92672">[</span>root@wangpengliang ~<span style="color:#f92672">]</span><span style="color:#75715e"># uname -m</span>
</span></span><span style="display:flex;"><span>x86_64</span></span></code></pre></div><p>è¿™é‡Œé€‰æ‹©ä½¿ç”¨äºŒè¿›åˆ¶åŒ…ä¸‹è½½å®‰è£…</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#f92672">[</span>root@wangpengliang ~<span style="color:#f92672">]</span><span style="color:#75715e"># curl -L https://github.com/docker/compose/releases/download/1.17.1/docker-compose-`uname -s`-`uname -m` &gt; /usr/local/bin/docker-compose</span>
</span></span><span style="display:flex;"><span>  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
</span></span><span style="display:flex;"><span>                                 Dload  Upload   Total   Spent    Left  Speed
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">100</span>   <span style="color:#ae81ff">633</span>  <span style="color:#ae81ff">100</span>   <span style="color:#ae81ff">633</span>    <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">63</span>      <span style="color:#ae81ff">0</span>  0:00:10  0:00:09  0:00:01   <span style="color:#ae81ff">155</span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">100</span> 8649k  <span style="color:#ae81ff">100</span> 8649k    <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span>   292k      <span style="color:#ae81ff">0</span>  0:00:29  0:00:29 --:--:-- 1989k
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@wangpengliang ~<span style="color:#f92672">]</span><span style="color:#75715e"># curl -L https://raw.githubusercontent.com/docker/compose/1.8.0/contrib/completion/bash/docker-compose &gt; /etc/bash_completion.d/docker-compose</span>
</span></span><span style="display:flex;"><span>  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
</span></span><span style="display:flex;"><span>                                 Dload  Upload   Total   Spent    Left  Speed
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">100</span> <span style="color:#ae81ff">10554</span>  <span style="color:#ae81ff">100</span> <span style="color:#ae81ff">10554</span>    <span style="color:#ae81ff">0</span>     <span style="color:#ae81ff">0</span>   <span style="color:#ae81ff">1435</span>      <span style="color:#ae81ff">0</span>  0:00:07  0:00:07 --:--:--  <span style="color:#ae81ff">2753</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@wangpengliang ~<span style="color:#f92672">]</span><span style="color:#75715e"># chmod +x /usr/local/bin/docker-compose</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@wangpengliang ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker-compose --version</span>
</span></span><span style="display:flex;"><span>docker-compose version 1.17.1, build 6d101fb</span></span></code></pre></div><p><strong>PIP å®‰è£…</strong></p>
<blockquote class='book-hint '>
<p>æ³¨æ„ï¼š <code> x86_64</code>Â  æ¶æ„çš„ Linux å»ºè®®æŒ‰ç…§ä¸Šè¾¹çš„æ–¹æ³•ä¸‹è½½äºŒè¿›åˆ¶åŒ…è¿›è¡Œå®‰è£…ï¼Œå¦‚æœè®¡ç®—æœºçš„æ¶æ„æ˜¯ <code>ARM</code>Â  (ä¾‹å¦‚ï¼Œæ ‘è“æ´¾)ï¼Œå†ä½¿ç”¨ pip å®‰è£…</p>
</blockquote><p>è¿™ç§æ–¹å¼æ˜¯å°† Compose å½“ä½œä¸€ä¸ª Python åº”ç”¨æ¥ä» pip æºä¸­å®‰è£…</p>
<p>æ‰§è¡Œå®‰è£…å‘½ä»¤ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo pip install -U docker-compose</span></span></code></pre></div><p>çœ‹åˆ°ç±»ä¼¼å¦‚ä¸‹è¾“å‡ºï¼Œè¯´æ˜å®‰è£…æˆåŠŸ</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>Collecting docker-compose
</span></span><span style="display:flex;"><span>Downloading docker-compose-1.17.1.tar.gz <span style="color:#f92672">(</span>149kB<span style="color:#f92672">)</span>: 149kB downloaded
</span></span><span style="display:flex;"><span>...
</span></span><span style="display:flex;"><span>Successfully installed docker-compose cached-property requests texttable websocket-client docker-py dockerpty six enum34 backports.ssl-match-hostname ipaddress</span></span></code></pre></div><p>bash è¡¥å…¨å‘½ä»¤</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ curl -L https://raw.githubusercontent.com/docker/compose/1.8.0/contrib/completion/bash/docker-compose &gt; /etc/bash_completion.d/docker-compose</span></span></code></pre></div><p>å®¹å™¨ä¸­æ‰§è¡Œ
Compose æ—¢ç„¶æ˜¯ä¸€ä¸ª Python åº”ç”¨ï¼Œè‡ªç„¶ä¹Ÿå¯ä»¥ç›´æ¥ç”¨å®¹å™¨æ¥æ‰§è¡Œ</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ curl -L https://github.com/docker/compose/releases/download/1.8.0/run.sh &gt; /usr/local/bin/docker-compose
</span></span><span style="display:flex;"><span>$ chmod +x /usr/local/bin/docker-compose</span></span></code></pre></div><p>æŸ¥çœ‹ä¸‹è½½çš„ <code>run.sh</code>Â  è„šæœ¬å†…å®¹</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>set -e
</span></span><span style="display:flex;"><span>VERSION<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;1.8.0&#34;</span>
</span></span><span style="display:flex;"><span>IMAGE<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;docker/compose:</span>$VERSION<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Setup options for connecting to docker host</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> -z <span style="color:#e6db74">&#34;</span>$DOCKER_HOST<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>    DOCKER_HOST<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/var/run/docker.sock&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> -S <span style="color:#e6db74">&#34;</span>$DOCKER_HOST<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>    DOCKER_ADDR<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;-v </span>$DOCKER_HOST<span style="color:#e6db74">:</span>$DOCKER_HOST<span style="color:#e6db74"> -e DOCKER_HOST&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">else</span>
</span></span><span style="display:flex;"><span>    DOCKER_ADDR<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;-e DOCKER_HOST -e DOCKER_TLS_VERIFY -e DOCKER_CERT_PATH&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Setup volume mounts for compose config and context</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> <span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>pwd<span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span> !<span style="color:#f92672">=</span> <span style="color:#e6db74">&#39;/&#39;</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>    VOLUMES<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;-v </span><span style="color:#66d9ef">$(</span>pwd<span style="color:#66d9ef">)</span><span style="color:#e6db74">:</span><span style="color:#66d9ef">$(</span>pwd<span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> -n <span style="color:#e6db74">&#34;</span>$COMPOSE_FILE<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>    compose_dir<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>dirname $COMPOSE_FILE<span style="color:#66d9ef">)</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># TODO: also check --file argument</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> -n <span style="color:#e6db74">&#34;</span>$compose_dir<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>    VOLUMES<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$VOLUMES<span style="color:#e6db74"> -v </span>$compose_dir<span style="color:#e6db74">:</span>$compose_dir<span style="color:#e6db74">&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> -n <span style="color:#e6db74">&#34;</span>$HOME<span style="color:#e6db74">&#34;</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>    VOLUMES<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$VOLUMES<span style="color:#e6db74"> -v </span>$HOME<span style="color:#e6db74">:</span>$HOME<span style="color:#e6db74"> -v </span>$HOME<span style="color:#e6db74">:/root&#34;</span> <span style="color:#75715e"># mount $HOME in /root to share docker.config</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Only allocate tty if we detect one</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> -t <span style="color:#ae81ff">1</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>    DOCKER_RUN_OPTIONS<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;-t&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> <span style="color:#f92672">[</span> -t <span style="color:#ae81ff">0</span> <span style="color:#f92672">]</span>; <span style="color:#66d9ef">then</span>
</span></span><span style="display:flex;"><span>    DOCKER_RUN_OPTIONS<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;</span>$DOCKER_RUN_OPTIONS<span style="color:#e6db74"> -i&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">fi</span>
</span></span><span style="display:flex;"><span>exec docker run --rm $DOCKER_RUN_OPTIONS $DOCKER_ADDR $COMPOSE_OPTIONS $VOLUMES -w <span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>pwd<span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span> $IMAGE <span style="color:#e6db74">&#34;</span>$@<span style="color:#e6db74">&#34;</span></span></span></code></pre></div><p>å¯ä»¥çœ‹åˆ°ï¼Œå…¶å®æ˜¯ä¸‹è½½äº† <code>docker/compose</code>Â  é•œåƒå¹¶è¿è¡Œ</p>
<h1 id="å¸è½½">å¸è½½<a class="anchor" href="#%e5%8d%b8%e8%bd%bd">#</a></h1>
<p>å¦‚æœæ˜¯äºŒè¿›åˆ¶åŒ…æ–¹å¼å®‰è£…çš„ï¼Œåˆ é™¤äºŒè¿›åˆ¶æ–‡ä»¶å³å¯</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ sudo rm /usr/local/bin/docker-compose</span></span></code></pre></div><p>å¦‚æœæ˜¯é€šè¿‡ <code>pip</code>Â  å®‰è£…çš„ï¼Œåˆ™æ‰§è¡Œå¦‚ä¸‹å‘½ä»¤å³å¯</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ sudo pip uninstall docker-compose</span></span></code></pre></div><h1 id="ä½¿ç”¨">ä½¿ç”¨<a class="anchor" href="#%e4%bd%bf%e7%94%a8">#</a></h1>
<p>ä¹‹å‰è¯´åˆ°<code>Compose</code> ä¸­æœ‰ä¸¤ä¸ªé‡è¦çš„æ¦‚å¿µï¼š</p>
<ul>
<li>æœåŠ¡ (<code>service</code>)ï¼šä¸€ä¸ªåº”ç”¨å®¹å™¨ï¼Œå®é™…ä¸Šå¯ä»¥è¿è¡Œå¤šä¸ªç›¸åŒé•œåƒçš„å®ä¾‹</li>
<li>é¡¹ç›® (<code>project</code>)ï¼šç”±ä¸€ç»„å…³è”çš„åº”ç”¨å®¹å™¨ç»„æˆçš„ä¸€ä¸ªå®Œæ•´ä¸šåŠ¡å•å…ƒ</li>
</ul>
<p>å¯è§ï¼Œä¸€ä¸ªé¡¹ç›®å¯ä»¥ç”±å¤šä¸ªæœåŠ¡ï¼ˆå®¹å™¨ï¼‰å…³è”è€Œæˆï¼Œ<code>Compose</code> é¢å‘é¡¹ç›®è¿›è¡Œç®¡ç†ã€‚</p>
<p><strong>åˆ›å»ºWebåº”ç”¨</strong></p>
<p>ç¤ºä¾‹ç”¨ <code>Python</code> åˆ›å»ºä¸€ä¸ªèƒ½å¤Ÿè®°å½•é¡µé¢è®¿é—®æ¬¡æ•°çš„ web ç½‘ç«™ã€‚æ–°å»ºæ–‡ä»¶å¤¹ï¼Œåœ¨è¯¥ç›®å½•ä¸­ç¼–å†™ <code>app.py</code> æ–‡ä»¶</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#f92672">from</span> flask <span style="color:#f92672">import</span> Flask
</span></span><span style="display:flex;"><span><span style="color:#f92672">from</span> redis <span style="color:#f92672">import</span> Redis
</span></span><span style="display:flex;"><span>app <span style="color:#f92672">=</span> Flask(__name__)
</span></span><span style="display:flex;"><span>redis <span style="color:#f92672">=</span> Redis(host<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;redis&#39;</span>, port<span style="color:#f92672">=</span><span style="color:#ae81ff">6379</span>)
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">@app.route</span>(<span style="color:#e6db74">&#39;/&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">def</span> <span style="color:#a6e22e">hello</span>():
</span></span><span style="display:flex;"><span>    count <span style="color:#f92672">=</span> redis<span style="color:#f92672">.</span>incr(<span style="color:#e6db74">&#39;hits&#39;</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">return</span> <span style="color:#e6db74">&#39;Hello World! è¯¥é¡µé¢å·²è¢«è®¿é—® </span><span style="color:#e6db74">{}</span><span style="color:#e6db74"> æ¬¡ã€‚</span><span style="color:#ae81ff">\n</span><span style="color:#e6db74">&#39;</span><span style="color:#f92672">.</span>format(count)
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">if</span> __name__ <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;__main__&#34;</span>:
</span></span><span style="display:flex;"><span>    app<span style="color:#f92672">.</span>run(host<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;0.0.0.0&#34;</span>, debug<span style="color:#f92672">=</span><span style="color:#66d9ef">True</span>)</span></span></code></pre></div><p><strong>Dockerfile</strong></p>
<p>ç¼–å†™ <code>Dockerfile</code> æ–‡ä»¶å†…å®¹ä¸ºï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>FROM python:<span style="color:#ae81ff">3.6</span><span style="color:#f92672">-</span>alpine
</span></span><span style="display:flex;"><span>ADD <span style="color:#f92672">.</span> <span style="color:#f92672">/</span>code
</span></span><span style="display:flex;"><span>WORKDIR <span style="color:#f92672">/</span>code
</span></span><span style="display:flex;"><span>RUN pip install redis flask
</span></span><span style="display:flex;"><span>CMD [<span style="color:#e6db74">&#34;python&#34;</span>, <span style="color:#e6db74">&#34;app.py&#34;</span>]</span></span></code></pre></div><p><strong>docker-compose.yml</strong></p>
<p>ç¼–å†™ <code>docker-compose.yml</code> æ–‡ä»¶ï¼Œè¿™ä¸ªæ˜¯ Compose ä½¿ç”¨çš„ä¸»æ¨¡æ¿æ–‡ä»¶</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span>version: <span style="color:#e6db74">&#39;3&#39;</span>
</span></span><span style="display:flex;"><span>services:
</span></span><span style="display:flex;"><span>  web:
</span></span><span style="display:flex;"><span>    build: <span style="color:#f92672">.</span>
</span></span><span style="display:flex;"><span>    ports:
</span></span><span style="display:flex;"><span>     <span style="color:#f92672">-</span> <span style="color:#e6db74">&#34;5000:5000&#34;</span>
</span></span><span style="display:flex;"><span>  redis:
</span></span><span style="display:flex;"><span>    image: <span style="color:#e6db74">&#34;redis:alpine&#34;</span></span></span></code></pre></div><p><strong>è¿è¡Œ compose</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker-compose up</span></span></code></pre></div><p><strong>åˆ›å»º <code>pythontests</code>Â ç›®å½•ï¼Œåˆ›å»º <code>app.py</code>Â <code>Dockerfile</code>Â <code>docker-compose.yml</code>Â æ–‡ä»¶</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#f92672">[</span>root@wangpengliang pythontests<span style="color:#f92672">]</span><span style="color:#75715e"># ls</span>
</span></span><span style="display:flex;"><span>app.py  docker-compose.yml  Dockerfile</span></span></code></pre></div><p><strong>è¿è¡Œ docker-compose</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#f92672">[</span>root@wangpengliang pythontests<span style="color:#f92672">]</span><span style="color:#75715e"># docker-compose up</span>
</span></span><span style="display:flex;"><span>Building web
</span></span><span style="display:flex;"><span>Step 1/5 : FROM python:3.6-alpine <span style="color:#75715e"># ä¸‹è½½åŸºç¡€é•œåƒpython:3.6-alpine</span>
</span></span><span style="display:flex;"><span>3.6-alpine: Pulling from library/python
</span></span><span style="display:flex;"><span>540db60ca938: Pull complete
</span></span><span style="display:flex;"><span>a7ad1a75a999: Pull complete
</span></span><span style="display:flex;"><span>5545670c3922: Pull complete
</span></span><span style="display:flex;"><span>c89910f38943: Pull complete
</span></span><span style="display:flex;"><span>b6a40d090e87: Pull complete
</span></span><span style="display:flex;"><span>Digest: sha256:492bb540e9c9bc9f586d5d69467c66bc32072d9af48463b1f0054d4ff9b93709
</span></span><span style="display:flex;"><span>Status: Downloaded newer image <span style="color:#66d9ef">for</span> python:3.6-alpine
</span></span><span style="display:flex;"><span> ---&gt; ac438c122d19
</span></span><span style="display:flex;"><span>Step 2/5 : ADD . /code   <span style="color:#75715e"># æ‹·è´æ–‡ä»¶åˆ°/codeç›®å½•</span>
</span></span><span style="display:flex;"><span> ---&gt; 68cbe5b2f598
</span></span><span style="display:flex;"><span>Step 3/5 : WORKDIR /code <span style="color:#75715e"># è®¾ç½®/codeç›®å½•ä¸ºå·¥ä½œç›®å½•</span>
</span></span><span style="display:flex;"><span> ---&gt; Running in 4fd09a1580a8
</span></span><span style="display:flex;"><span>Removing intermediate container 4fd09a1580a8 <span style="color:#75715e"># æ‹†å¸ä¸­é—´å®¹å™¨ï¼š4fd09a1580a8</span>
</span></span><span style="display:flex;"><span> ---&gt; 2e4bbd31555d
</span></span><span style="display:flex;"><span>Step 4/5 : RUN pip install redis flask <span style="color:#75715e"># è¿è¡Œpipå®‰è£…redisã€flask</span>
</span></span><span style="display:flex;"><span> ---&gt; Running in c12f4ece64f1
</span></span><span style="display:flex;"><span>Collecting redis
</span></span><span style="display:flex;"><span>  Downloading redis-3.5.3-py2.py3-none-any.whl <span style="color:#f92672">(</span><span style="color:#ae81ff">72</span> kB<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Collecting flask
</span></span><span style="display:flex;"><span>  Downloading Flask-2.0.1-py3-none-any.whl <span style="color:#f92672">(</span><span style="color:#ae81ff">94</span> kB<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Collecting click&gt;<span style="color:#f92672">=</span>7.1.2
</span></span><span style="display:flex;"><span>  Downloading click-8.0.1-py3-none-any.whl <span style="color:#f92672">(</span><span style="color:#ae81ff">97</span> kB<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Collecting Werkzeug&gt;<span style="color:#f92672">=</span>2.0
</span></span><span style="display:flex;"><span>  Downloading Werkzeug-2.0.1-py3-none-any.whl <span style="color:#f92672">(</span><span style="color:#ae81ff">288</span> kB<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Collecting itsdangerous&gt;<span style="color:#f92672">=</span>2.0
</span></span><span style="display:flex;"><span>  Downloading itsdangerous-2.0.1-py3-none-any.whl <span style="color:#f92672">(</span><span style="color:#ae81ff">18</span> kB<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Collecting Jinja2&gt;<span style="color:#f92672">=</span>3.0
</span></span><span style="display:flex;"><span>  Downloading Jinja2-3.0.1-py3-none-any.whl <span style="color:#f92672">(</span><span style="color:#ae81ff">133</span> kB<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Collecting importlib-metadata
</span></span><span style="display:flex;"><span>  Downloading importlib_metadata-4.5.0-py3-none-any.whl <span style="color:#f92672">(</span><span style="color:#ae81ff">17</span> kB<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Collecting MarkupSafe&gt;<span style="color:#f92672">=</span>2.0
</span></span><span style="display:flex;"><span>  Downloading MarkupSafe-2.0.1.tar.gz <span style="color:#f92672">(</span><span style="color:#ae81ff">18</span> kB<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Collecting dataclasses
</span></span><span style="display:flex;"><span>  Downloading dataclasses-0.8-py3-none-any.whl <span style="color:#f92672">(</span><span style="color:#ae81ff">19</span> kB<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Collecting typing-extensions&gt;<span style="color:#f92672">=</span>3.6.4
</span></span><span style="display:flex;"><span>  Downloading typing_extensions-3.10.0.0-py3-none-any.whl <span style="color:#f92672">(</span><span style="color:#ae81ff">26</span> kB<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Collecting zipp&gt;<span style="color:#f92672">=</span>0.5
</span></span><span style="display:flex;"><span>  Downloading zipp-3.4.1-py3-none-any.whl <span style="color:#f92672">(</span>5.2 kB<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Building wheels <span style="color:#66d9ef">for</span> collected packages: MarkupSafe
</span></span><span style="display:flex;"><span>  Building wheel <span style="color:#66d9ef">for</span> MarkupSafe <span style="color:#f92672">(</span>setup.py<span style="color:#f92672">)</span>: started
</span></span><span style="display:flex;"><span>  Building wheel <span style="color:#66d9ef">for</span> MarkupSafe <span style="color:#f92672">(</span>setup.py<span style="color:#f92672">)</span>: finished with status <span style="color:#e6db74">&#39;done&#39;</span>
</span></span><span style="display:flex;"><span>  Created wheel <span style="color:#66d9ef">for</span> MarkupSafe: filename<span style="color:#f92672">=</span>MarkupSafe-2.0.1-py3-none-any.whl size<span style="color:#f92672">=</span><span style="color:#ae81ff">9761</span> sha256<span style="color:#f92672">=</span>e2a25263f4c7babbdd0cdda87cad139e54eb972cf742f2f7b7893003e0ecfe97
</span></span><span style="display:flex;"><span>  Stored in directory: /root/.cache/pip/wheels/05/46/9b/189d9acb1f643857fb8ad990ca04c02509c35d3ad6fac81794
</span></span><span style="display:flex;"><span>Successfully built MarkupSafe
</span></span><span style="display:flex;"><span>Installing collected packages: zipp, typing-extensions, MarkupSafe, importlib-metadata, dataclasses, Werkzeug, Jinja2, itsdangerous, click, redis, flask
</span></span><span style="display:flex;"><span>Successfully installed Jinja2-3.0.1 MarkupSafe-2.0.1 Werkzeug-2.0.1 click-8.0.1 dataclasses-0.8 flask-2.0.1 importlib-metadata-4.5.0 itsdangerous-2.0.1 redis-3.5.3 typing-extensions-3.10.0.0 zipp-3.4.1
</span></span><span style="display:flex;"><span>WARNING: Running pip as root will break packages and permissions. You should install packages reliably by using venv: https://pip.pypa.io/warnings/venv
</span></span><span style="display:flex;"><span>Removing intermediate container c12f4ece64f1
</span></span><span style="display:flex;"><span> ---&gt; 061f502fa95e
</span></span><span style="display:flex;"><span>Step 5/5 : CMD <span style="color:#f92672">[</span><span style="color:#e6db74">&#34;python&#34;</span>, <span style="color:#e6db74">&#34;app.py&#34;</span><span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span> ---&gt; Running in c6ac95ba9659
</span></span><span style="display:flex;"><span>Removing intermediate container c6ac95ba9659
</span></span><span style="display:flex;"><span> ---&gt; aabe65a53ffd
</span></span><span style="display:flex;"><span>Successfully built aabe65a53ffd
</span></span><span style="display:flex;"><span>Successfully tagged pythontests_web:latest
</span></span><span style="display:flex;"><span>WARNING: Image <span style="color:#66d9ef">for</span> service web was built because it did not already exist. To rebuild this image you must use <span style="color:#e6db74">`</span>docker-compose build<span style="color:#e6db74">`</span> or <span style="color:#e6db74">`</span>docker-compose up --build<span style="color:#e6db74">`</span>.
</span></span><span style="display:flex;"><span>Pulling redis <span style="color:#f92672">(</span>redis:alpine<span style="color:#f92672">)</span>...
</span></span><span style="display:flex;"><span>alpine: Pulling from library/redis
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>29712d301e8c: Pull complete
</span></span><span style="display:flex;"><span>8173c12df40f: Pull complete
</span></span><span style="display:flex;"><span>8cc52074f78e: Pull complete
</span></span><span style="display:flex;"><span>aa7854465cce: Pull complete
</span></span><span style="display:flex;"><span>6ab1d05b4973: Pull complete
</span></span><span style="display:flex;"><span>Digest: sha256:eaaa58f8757d6f04b2e34ace57a71d79f8468053c198f5758fd2068ac235f303
</span></span><span style="display:flex;"><span>Status: Downloaded newer image <span style="color:#66d9ef">for</span> redis:alpine
</span></span><span style="display:flex;"><span>Creating pythontests_web_1
</span></span><span style="display:flex;"><span>Creating pythontests_redis_1
</span></span><span style="display:flex;"><span>Attaching to pythontests_redis_1, pythontests_web_1
</span></span><span style="display:flex;"><span>redis_1  | 1:C <span style="color:#ae81ff">09</span> Jun <span style="color:#ae81ff">2021</span> 03:16:24.588 <span style="color:#75715e"># oO0OoO0OoO0Oo Redis is starting oO0OoO0OoO0Oo</span>
</span></span><span style="display:flex;"><span>redis_1  | 1:C <span style="color:#ae81ff">09</span> Jun <span style="color:#ae81ff">2021</span> 03:16:24.588 <span style="color:#75715e"># Redis version=6.2.4, bits=64, commit=00000000, modified=0, pid=1, just started</span>
</span></span><span style="display:flex;"><span>redis_1  | 1:C <span style="color:#ae81ff">09</span> Jun <span style="color:#ae81ff">2021</span> 03:16:24.588 <span style="color:#75715e"># Warning: no config file specified, using the default config. In order to specify a config file use redis-server /path/to/redis.conf</span>
</span></span><span style="display:flex;"><span>redis_1  | 1:M <span style="color:#ae81ff">09</span> Jun <span style="color:#ae81ff">2021</span> 03:16:24.588 * monotonic clock: POSIX clock_gettime
</span></span><span style="display:flex;"><span>redis_1  | 1:M <span style="color:#ae81ff">09</span> Jun <span style="color:#ae81ff">2021</span> 03:16:24.590 * Running mode<span style="color:#f92672">=</span>standalone, port<span style="color:#f92672">=</span>6379.
</span></span><span style="display:flex;"><span>redis_1  | 1:M <span style="color:#ae81ff">09</span> Jun <span style="color:#ae81ff">2021</span> 03:16:24.590 <span style="color:#75715e"># WARNING: The TCP backlog setting of 511 cannot be enforced because /proc/sys/net/core/somaxconn is set to the lower value of 128.</span>
</span></span><span style="display:flex;"><span>redis_1  | 1:M <span style="color:#ae81ff">09</span> Jun <span style="color:#ae81ff">2021</span> 03:16:24.590 <span style="color:#75715e"># Server initialized</span>
</span></span><span style="display:flex;"><span>redis_1  | 1:M <span style="color:#ae81ff">09</span> Jun <span style="color:#ae81ff">2021</span> 03:16:24.590 <span style="color:#75715e"># WARNING overcommit_memory is set to 0! Background save may fail under low memory condition. To fix this issue add &#39;vm.overcommit_memory = 1&#39; to /etc/sysctl.conf and then reboot or run the command &#39;sysctl vm.overcommit_memory=1&#39; for this to take effect.</span>
</span></span><span style="display:flex;"><span>redis_1  | 1:M <span style="color:#ae81ff">09</span> Jun <span style="color:#ae81ff">2021</span> 03:16:24.590 * Ready to accept connections
</span></span><span style="display:flex;"><span>web_1    |  * Serving Flask app <span style="color:#e6db74">&#39;app&#39;</span> <span style="color:#f92672">(</span>lazy loading<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>web_1    |  * Environment: production
</span></span><span style="display:flex;"><span>web_1    |    WARNING: This is a development server. Do not use it in a production deployment.
</span></span><span style="display:flex;"><span>web_1    |    Use a production WSGI server instead.
</span></span><span style="display:flex;"><span>web_1    |  * Debug mode: on
</span></span><span style="display:flex;"><span>web_1    |  * Running on all addresses.
</span></span><span style="display:flex;"><span>web_1    |    WARNING: This is a development server. Do not use it in a production deployment.
</span></span><span style="display:flex;"><span>web_1    |  * Running on http://172.19.0.2:5000/ <span style="color:#f92672">(</span>Press CTRL+C to quit<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>web_1    |  * Restarting with stat
</span></span><span style="display:flex;"><span>web_1    |  * Debugger is active!
</span></span><span style="display:flex;"><span>web_1    |  * Debugger PIN: 103-300-970
</span></span><span style="display:flex;"><span>web_1    | 172.19.0.1 - - <span style="color:#f92672">[</span>09/Jun/2021 03:17:00<span style="color:#f92672">]</span> <span style="color:#e6db74">&#34;GET / HTTP/1.1&#34;</span> <span style="color:#ae81ff">200</span> -</span></span></code></pre></div><p>æµ‹è¯•ç»“æœ</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#f92672">[</span>root@wangpengliang pythontests<span style="color:#f92672">]</span><span style="color:#75715e"># curl 172.18.0.2:5000</span>
</span></span><span style="display:flex;"><span>Hello World! è¯¥é¡µé¢å·²è¢«è®¿é—® <span style="color:#ae81ff">1</span> æ¬¡ã€‚
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@wangpengliang pythontests<span style="color:#f92672">]</span><span style="color:#75715e"># curl 172.18.0.2:5000</span>
</span></span><span style="display:flex;"><span>Hello World! è¯¥é¡µé¢å·²è¢«è®¿é—® <span style="color:#ae81ff">2</span> æ¬¡ã€‚
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@wangpengliang pythontests<span style="color:#f92672">]</span><span style="color:#75715e"># curl 172.18.0.2:5000</span>
</span></span><span style="display:flex;"><span>Hello World! è¯¥é¡µé¢å·²è¢«è®¿é—® <span style="color:#ae81ff">3</span> æ¬¡ã€‚
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@wangpengliang pythontests<span style="color:#f92672">]</span><span style="color:#75715e"># curl 172.18.0.2:5000</span>
</span></span><span style="display:flex;"><span>Hello World! è¯¥é¡µé¢å·²è¢«è®¿é—® <span style="color:#ae81ff">4</span> æ¬¡ã€‚
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@wangpengliang pythontests<span style="color:#f92672">]</span><span style="color:#75715e"># curl 172.18.0.2:5000</span>
</span></span><span style="display:flex;"><span>Hello World! è¯¥é¡µé¢å·²è¢«è®¿é—® <span style="color:#ae81ff">5</span> æ¬¡ã€‚</span></span></code></pre></div><h1 id="å‘½ä»¤å¯¹è±¡ä¸æ ¼å¼">å‘½ä»¤å¯¹è±¡ä¸æ ¼å¼<a class="anchor" href="#%e5%91%bd%e4%bb%a4%e5%af%b9%e8%b1%a1%e4%b8%8e%e6%a0%bc%e5%bc%8f">#</a></h1>
<p>å¯¹äº Compose æ¥è¯´ï¼Œå¤§éƒ¨åˆ†å‘½ä»¤çš„å¯¹è±¡æ—¢å¯ä»¥æ˜¯é¡¹ç›®æœ¬èº«ï¼Œä¹Ÿå¯ä»¥æŒ‡å®šä¸ºé¡¹ç›®ä¸­çš„æœåŠ¡æˆ–è€…å®¹å™¨ã€‚å¦‚æœæ²¡æœ‰ç‰¹åˆ«çš„è¯´æ˜ï¼Œå‘½ä»¤å¯¹è±¡å°†æ˜¯é¡¹ç›®ã€‚è¿™æ„å‘³ç€é¡¹ç›®ä¸­æ‰€æœ‰çš„æœåŠ¡éƒ½ä¼šå—åˆ°å‘½ä»¤å½±å“ã€‚</p>
<p><strong>æŸ¥çœ‹å…·ä½“æŸä¸ªå‘½ä»¤çš„ä½¿ç”¨æ ¼å¼ï¼š</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker-compose <span style="color:#f92672">[</span>COMMAND<span style="color:#f92672">]</span> --help 
</span></span><span style="display:flex;"><span>æˆ–
</span></span><span style="display:flex;"><span>docker-compose help <span style="color:#f92672">[</span>COMMAND<span style="color:#f92672">]</span></span></span></code></pre></div><p><strong><code>docker-compose</code> å‘½ä»¤çš„åŸºæœ¬ä½¿ç”¨æ ¼å¼ï¼š</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>docker-compose <span style="color:#f92672">[</span>-f<span style="color:#f92672">=</span>&lt;arg&gt;...<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>options<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>COMMAND<span style="color:#f92672">]</span> <span style="color:#f92672">[</span>ARGS...<span style="color:#f92672">]</span></span></span></code></pre></div><h2 id="å‘½ä»¤é€‰é¡¹">å‘½ä»¤é€‰é¡¹<a class="anchor" href="#%e5%91%bd%e4%bb%a4%e9%80%89%e9%a1%b9">#</a></h2>
<ul>
<li><code>-f, --file FILE</code> æŒ‡å®šä½¿ç”¨çš„ Compose æ¨¡æ¿æ–‡ä»¶ï¼Œé»˜è®¤ä¸º <code>docker-compose.yml</code>ï¼Œå¯ä»¥å¤šæ¬¡æŒ‡å®š</li>
<li><code>-p, --project-name NAME</code> æŒ‡å®šé¡¹ç›®åç§°ï¼Œé»˜è®¤å°†ä½¿ç”¨æ‰€åœ¨ç›®å½•åç§°ä½œä¸ºé¡¹ç›®å</li>
<li><code>--x-networking</code> ä½¿ç”¨ Docker çš„å¯æ‹”æ’ç½‘ç»œåç«¯ç‰¹æ€§</li>
<li><code>--x-network-driver DRIVER</code> æŒ‡å®šç½‘ç»œåç«¯çš„é©±åŠ¨ï¼Œé»˜è®¤ä¸º <code>bridge</code></li>
<li><code>--verbose</code> è¾“å‡ºæ›´å¤šè°ƒè¯•ä¿¡æ¯</li>
<li><code>-v, --version</code> æ‰“å°ç‰ˆæœ¬å¹¶é€€å‡º</li>
</ul>
<h2 id="å‘½ä»¤ä½¿ç”¨è¯´æ˜">å‘½ä»¤ä½¿ç”¨è¯´æ˜<a class="anchor" href="#%e5%91%bd%e4%bb%a4%e4%bd%bf%e7%94%a8%e8%af%b4%e6%98%8e">#</a></h2>
<h3 id="build">build<a class="anchor" href="#build">#</a></h3>
<p>æ ¼å¼ï¼š <code>docker-compose build [options] [SERVICE...]</code></p>
<blockquote class='book-hint '>
<p>æ„å»ºï¼ˆé‡æ–°æ„å»ºï¼‰é¡¹ç›®ä¸­çš„æœåŠ¡å®¹å™¨ã€‚æœåŠ¡å®¹å™¨ä¸€æ—¦æ„å»ºåï¼Œå°†ä¼šå¸¦ä¸Šä¸€ä¸ªæ ‡è®°åï¼Œä¾‹å¦‚å¯¹äº web é¡¹ç›®ä¸­çš„ä¸€ä¸ª db å®¹å™¨ï¼Œå¯èƒ½æ˜¯ web_dbã€‚å¯ä»¥éšæ—¶åœ¨é¡¹ç›®ç›®å½•ä¸‹è¿è¡Œ <code>docker-compose build</code> æ¥é‡æ–°æ„å»ºæœåŠ¡</p>
</blockquote><p>é€‰é¡¹ï¼š</p>
<ul>
<li><code>--force-rm</code> åˆ é™¤æ„å»ºè¿‡ç¨‹ä¸­çš„ä¸´æ—¶å®¹å™¨</li>
<li><code>--no-cache</code> æ„å»ºé•œåƒè¿‡ç¨‹ä¸­ä¸ä½¿ç”¨ cacheï¼ˆè¿™å°†åŠ é•¿æ„å»ºè¿‡ç¨‹ï¼‰</li>
<li><code>--pull</code> å§‹ç»ˆå°è¯•é€šè¿‡ pull æ¥è·å–æ›´æ–°ç‰ˆæœ¬çš„é•œåƒ</li>
</ul>
<h3 id="config">config<a class="anchor" href="#config">#</a></h3>
<p>éªŒè¯ Compose æ–‡ä»¶æ ¼å¼æ˜¯å¦æ­£ç¡®ï¼Œè‹¥æ­£ç¡®åˆ™æ˜¾ç¤ºé…ç½®ï¼Œè‹¥æ ¼å¼é”™è¯¯æ˜¾ç¤ºé”™è¯¯åŸå› ã€‚</p>
<h3 id="down">down<a class="anchor" href="#down">#</a></h3>
<p>æ­¤å‘½ä»¤å°†ä¼šåœæ­¢ <code>up</code> å‘½ä»¤æ‰€å¯åŠ¨çš„å®¹å™¨ï¼Œå¹¶ç§»é™¤ç½‘ç»œã€‚</p>
<h3 id="exec">exec<a class="anchor" href="#exec">#</a></h3>
<p>è¿›å…¥æŒ‡å®šå®¹å™¨ã€‚</p>
<h3 id="help">help<a class="anchor" href="#help">#</a></h3>
<p>è·å¾—ä¸€ä¸ªå‘½ä»¤çš„å¸®åŠ©ã€‚</p>
<h3 id="images">images<a class="anchor" href="#images">#</a></h3>
<p>åˆ—å‡º Compose æ–‡ä»¶ä¸­åŒ…å«çš„é•œåƒã€‚</p>
<h3 id="kill">kill<a class="anchor" href="#kill">#</a></h3>
<p>æ ¼å¼ï¼š <code>docker-compose kill [options] [SERVICE...]</code></p>
<blockquote class='book-hint '>
<p>é€šè¿‡å‘é€ <code>SIGKILL</code> ä¿¡å·æ¥å¼ºåˆ¶åœæ­¢æœåŠ¡å®¹å™¨ã€‚æ”¯æŒé€šè¿‡ <code>-s</code> å‚æ•°æ¥æŒ‡å®šå‘é€çš„ä¿¡å·ï¼Œä¾‹å¦‚é€šè¿‡å¦‚ä¸‹æŒ‡ä»¤å‘é€ <code>SIGINT</code> ä¿¡å·</p>
</blockquote><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ docker-compose kill -s SIGINT</span></span></code></pre></div><h3 id="logs">logs<a class="anchor" href="#logs">#</a></h3>
<p>æ ¼å¼ï¼š <code>docker-compose logs [options] [SERVICE...]</code></p>
<blockquote class='book-hint '>
<p>æŸ¥çœ‹æœåŠ¡å®¹å™¨çš„è¾“å‡ºã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œdocker-compose å°†å¯¹ä¸åŒçš„æœåŠ¡è¾“å‡ºä½¿ç”¨ä¸åŒçš„é¢œè‰²æ¥åŒºåˆ†ã€‚å¯ä»¥é€šè¿‡ <code>--no-color</code> æ¥å…³é—­é¢œè‰²ã€‚è¯¥å‘½ä»¤åœ¨è°ƒè¯•é—®é¢˜çš„æ—¶å€™ç»å¸¸ä½¿ç”¨</p>
</blockquote><h3 id="pause">pause<a class="anchor" href="#pause">#</a></h3>
<p>æ ¼å¼ï¼š<code>docker-compose pause [SERVICE...]</code></p>
<blockquote class='book-hint '>
<p>æš‚åœä¸€ä¸ªæœåŠ¡å®¹å™¨</p>
</blockquote><h3 id="port">port<a class="anchor" href="#port">#</a></h3>
<p>æ ¼å¼ï¼š <code>docker-compose port [options] SERVICE PRIVATE_PORT</code></p>
<blockquote class='book-hint '>
<p>æ‰“å°æŸä¸ªå®¹å™¨ç«¯å£æ‰€æ˜ å°„çš„å…¬å…±ç«¯å£</p>
</blockquote><p>é€‰é¡¹ï¼š</p>
<ul>
<li><code>--protocol=proto</code> æŒ‡å®šç«¯å£åè®®ï¼Œtcpï¼ˆé»˜è®¤å€¼ï¼‰æˆ–è€… udp</li>
<li><code>--index=index</code> å¦‚æœåŒä¸€æœåŠ¡å­˜åœ¨å¤šä¸ªå®¹å™¨ï¼ŒæŒ‡å®šå‘½ä»¤å¯¹è±¡å®¹å™¨çš„åºå·ï¼ˆé»˜è®¤ä¸º 1ï¼‰</li>
</ul>
<h3 id="ps">ps<a class="anchor" href="#ps">#</a></h3>
<p>æ ¼å¼ï¼š <code>docker-compose ps [options] [SERVICE...]</code></p>
<blockquote class='book-hint '>
<p>åˆ—å‡ºé¡¹ç›®ä¸­ç›®å‰çš„æ‰€æœ‰å®¹å™¨ã€‚</p>
</blockquote><p>é€‰é¡¹ï¼š</p>
<ul>
<li><code>-q</code> åªæ‰“å°å®¹å™¨çš„ ID ä¿¡æ¯</li>
</ul>
<h3 id="pull">pull<a class="anchor" href="#pull">#</a></h3>
<p>æ ¼å¼ï¼š <code>docker-compose pull [options] [SERVICE...]</code></p>
<blockquote class='book-hint '>
<p>æ‹‰å–æœåŠ¡ä¾èµ–çš„é•œåƒ</p>
</blockquote><p>é€‰é¡¹ï¼š</p>
<ul>
<li><code>--ignore-pull-failures</code> å¿½ç•¥æ‹‰å–é•œåƒè¿‡ç¨‹ä¸­çš„é”™è¯¯</li>
</ul>
<h3 id="push">push<a class="anchor" href="#push">#</a></h3>
<blockquote class='book-hint '>
<p>æ¨é€æœåŠ¡ä¾èµ–çš„é•œåƒåˆ° Docker é•œåƒä»“åº“</p>
</blockquote><h3 id="restart">restart<a class="anchor" href="#restart">#</a></h3>
<p>æ ¼å¼ï¼š<code>docker-compose restart [options] [SERVICE...]</code></p>
<blockquote class='book-hint '>
<p>é‡å¯é¡¹ç›®ä¸­çš„æœåŠ¡</p>
</blockquote><p>é€‰é¡¹ï¼š</p>
<ul>
<li><code>-t, --timeout TIMEOUT</code> æŒ‡å®šé‡å¯å‰åœæ­¢å®¹å™¨çš„è¶…æ—¶ï¼ˆé»˜è®¤10 ç§’ï¼‰</li>
</ul>
<h3 id="rm">rm<a class="anchor" href="#rm">#</a></h3>
<p>æ ¼å¼ï¼š<code>docker-compose rm [options] [SERVICE...]</code></p>
<blockquote class='book-hint '>
<p>åˆ é™¤æ‰€æœ‰ï¼ˆåœæ­¢çŠ¶æ€çš„ï¼‰æœåŠ¡å®¹å™¨ã€‚æ¨èå…ˆæ‰§è¡Œ <code>docker-compose stop</code> å‘½ä»¤æ¥åœæ­¢å®¹å™¨</p>
</blockquote><p>é€‰é¡¹ï¼š</p>
<ul>
<li><code>-f, --force</code> å¼ºåˆ¶ç›´æ¥åˆ é™¤ï¼ŒåŒ…æ‹¬éåœæ­¢çŠ¶æ€çš„å®¹å™¨ã€‚ä¸€èˆ¬å°½é‡ä¸è¦ä½¿ç”¨è¯¥é€‰é¡¹</li>
<li><code>-v</code> åˆ é™¤å®¹å™¨æ‰€æŒ‚è½½çš„æ•°æ®å·</li>
</ul>
<h3 id="run">run<a class="anchor" href="#run">#</a></h3>
<p>æ ¼å¼ï¼š <code>docker-compose run [options] [-p PORT...] [-e KEY=VAL...] SERVICE [COMMAND] [ARGS...]</code></p>
<blockquote class='book-hint '>
<p>åœ¨æŒ‡å®šæœåŠ¡ä¸Šæ‰§è¡Œä¸€ä¸ªå‘½ä»¤</p>
</blockquote><p>ä¾‹å¦‚ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ docker-compose run ubuntu ping docker.com</span></span></code></pre></div><p>è¿™å°†ä¼šå¯åŠ¨ä¸€ä¸ª ubuntu æœåŠ¡å®¹å™¨ï¼Œå¹¶æ‰§è¡Œ <code>ping docker.com</code> å‘½ä»¤ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æœå­˜åœ¨å…³è”ï¼Œåˆ™æ‰€æœ‰å…³è”çš„æœåŠ¡å°†ä¼šè‡ªåŠ¨è¢«å¯åŠ¨ï¼Œé™¤éè¿™äº›æœåŠ¡å·²ç»åœ¨è¿è¡Œä¸­ã€‚è¯¥å‘½ä»¤ç±»ä¼¼å¯åŠ¨å®¹å™¨åè¿è¡ŒæŒ‡å®šçš„å‘½ä»¤ï¼Œç›¸å…³å·ã€é“¾æ¥ç­‰ç­‰éƒ½å°†ä¼šæŒ‰ç…§é…ç½®è‡ªåŠ¨åˆ›å»ºã€‚</p>
<p>ä¸¤ä¸ªä¸åŒç‚¹ï¼š</p>
<ul>
<li>ç»™å®šå‘½ä»¤å°†ä¼šè¦†ç›–åŸæœ‰çš„è‡ªåŠ¨è¿è¡Œå‘½ä»¤</li>
<li>ä¸ä¼šè‡ªåŠ¨åˆ›å»ºç«¯å£ï¼Œä»¥é¿å…å†²çª</li>
</ul>
<p>å¦‚æœä¸å¸Œæœ›è‡ªåŠ¨å¯åŠ¨å…³è”çš„å®¹å™¨ï¼Œå¯ä»¥ä½¿ç”¨ <code>--no-deps</code> é€‰é¡¹ï¼Œä¾‹å¦‚ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ docker-compose run --no-deps web python manage.py shell</span></span></code></pre></div><p>å°†ä¸ä¼šå¯åŠ¨ web å®¹å™¨æ‰€å…³è”çš„å…¶å®ƒå®¹å™¨ã€‚</p>
<p>é€‰é¡¹ï¼š</p>
<ul>
<li><code>-d</code> åå°è¿è¡Œå®¹å™¨</li>
<li><code>--name NAME</code> ä¸ºå®¹å™¨æŒ‡å®šä¸€ä¸ªåå­—</li>
<li><code>--entrypoint CMD</code> è¦†ç›–é»˜è®¤çš„å®¹å™¨å¯åŠ¨æŒ‡ä»¤</li>
<li><code>-e KEY=VAL</code> è®¾ç½®ç¯å¢ƒå˜é‡å€¼ï¼Œå¯å¤šæ¬¡ä½¿ç”¨é€‰é¡¹æ¥è®¾ç½®å¤šä¸ªç¯å¢ƒå˜é‡</li>
<li><code>-u, --user=&quot;&quot;</code> æŒ‡å®šè¿è¡Œå®¹å™¨çš„ç”¨æˆ·åæˆ–è€… uid</li>
<li><code>--no-deps</code> ä¸è‡ªåŠ¨å¯åŠ¨å…³è”çš„æœåŠ¡å®¹å™¨</li>
<li><code>--rm</code> è¿è¡Œå‘½ä»¤åè‡ªåŠ¨åˆ é™¤å®¹å™¨ï¼Œ<code>d</code> æ¨¡å¼ä¸‹å°†å¿½ç•¥</li>
<li><code>-p, --publish=[]</code> æ˜ å°„å®¹å™¨ç«¯å£åˆ°æœ¬åœ°ä¸»æœº</li>
<li><code>--service-ports</code> é…ç½®æœåŠ¡ç«¯å£å¹¶æ˜ å°„åˆ°æœ¬åœ°ä¸»æœº</li>
<li><code>-T</code> ä¸åˆ†é…ä¼ª ttyï¼Œæ„å‘³ç€ä¾èµ– tty çš„æŒ‡ä»¤å°†æ— æ³•è¿è¡Œ</li>
</ul>
<h3 id="scale">scale<a class="anchor" href="#scale">#</a></h3>
<p>æ ¼å¼ï¼š <code>docker-compose scale [options] [SERVICE=NUM...]</code></p>
<blockquote class='book-hint '>
<p>è®¾ç½®æŒ‡å®šæœåŠ¡è¿è¡Œçš„å®¹å™¨ä¸ªæ•°ã€‚</p>
</blockquote><p>é€šè¿‡ <code>service=num</code> çš„å‚æ•°æ¥è®¾ç½®æ•°é‡ã€‚ä¾‹å¦‚ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ docker-compose scale web<span style="color:#f92672">=</span><span style="color:#ae81ff">3</span> db<span style="color:#f92672">=</span><span style="color:#ae81ff">2</span></span></span></code></pre></div><p>è¿™å°†å¯åŠ¨ 3 ä¸ªå®¹å™¨è¿è¡Œ web æœåŠ¡ï¼Œ2 ä¸ªå®¹å™¨è¿è¡Œ db æœåŠ¡ã€‚</p>
<p>ä¸€èˆ¬çš„ï¼Œå½“æŒ‡å®šæ•°ç›®å¤šäºè¯¥æœåŠ¡å½“å‰å®é™…è¿è¡Œå®¹å™¨ï¼Œå°†æ–°åˆ›å»ºå¹¶å¯åŠ¨å®¹å™¨ï¼›åä¹‹ï¼Œå°†åœæ­¢å®¹å™¨ã€‚</p>
<p>é€‰é¡¹ï¼š</p>
<ul>
<li><code>-t, --timeout TIMEOUT</code> åœæ­¢å®¹å™¨æ—¶å€™çš„è¶…æ—¶ï¼ˆé»˜è®¤ä¸º 10 ç§’ï¼‰ã€‚</li>
</ul>
<h3 id="start">start<a class="anchor" href="#start">#</a></h3>
<p>æ ¼å¼ï¼š <code>docker-compose start [SERVICE...]</code></p>
<blockquote class='book-hint '>
<p>å¯åŠ¨å·²ç»å­˜åœ¨çš„æœåŠ¡å®¹å™¨</p>
</blockquote><h3 id="stop">stop<a class="anchor" href="#stop">#</a></h3>
<p>æ ¼å¼ï¼š <code>docker-compose stop [options] [SERVICE...]</code></p>
<blockquote class='book-hint '>
<p>åœæ­¢å·²ç»å¤„äºè¿è¡ŒçŠ¶æ€çš„å®¹å™¨ï¼Œä½†ä¸åˆ é™¤å®ƒã€‚é€šè¿‡ <code>docker-compose start</code> å¯ä»¥å†æ¬¡å¯åŠ¨è¿™äº›å®¹å™¨</p>
</blockquote><p>é€‰é¡¹ï¼š</p>
<ul>
<li><code>-t, --timeout TIMEOUT</code> åœæ­¢å®¹å™¨æ—¶å€™çš„è¶…æ—¶ï¼ˆé»˜è®¤ä¸º 10 ç§’ï¼‰ã€‚</li>
</ul>
<h3 id="top">top<a class="anchor" href="#top">#</a></h3>
<blockquote class='book-hint '>
<p>æŸ¥çœ‹å„ä¸ªæœåŠ¡å®¹å™¨å†…è¿è¡Œçš„è¿›ç¨‹</p>
</blockquote><h3 id="unpause">unpause<a class="anchor" href="#unpause">#</a></h3>
<p>æ ¼å¼ï¼š <code>docker-compose unpause [SERVICE...]</code></p>
<blockquote class='book-hint '>
<p>æ¢å¤å¤„äºæš‚åœçŠ¶æ€ä¸­çš„æœåŠ¡</p>
</blockquote><h3 id="up">up<a class="anchor" href="#up">#</a></h3>
<p>æ ¼å¼ï¼š <code>docker-compose up [options] [SERVICE...]</code></p>
<blockquote class='book-hint '>
<p>è¯¥å‘½ä»¤ååˆ†å¼ºå¤§ï¼Œå®ƒå°†å°è¯•è‡ªåŠ¨å®ŒæˆåŒ…æ‹¬æ„å»ºé•œåƒï¼Œï¼ˆé‡æ–°ï¼‰åˆ›å»ºæœåŠ¡ï¼Œå¯åŠ¨æœåŠ¡ï¼Œå¹¶å…³è”æœåŠ¡ç›¸å…³å®¹å™¨çš„ä¸€ç³»åˆ—æ“ä½œã€‚é“¾æ¥çš„æœåŠ¡éƒ½å°†ä¼šè¢«è‡ªåŠ¨å¯åŠ¨ï¼Œé™¤éå·²ç»å¤„äºè¿è¡ŒçŠ¶æ€ã€‚å¤§éƒ¨åˆ†æ—¶å€™éƒ½å¯ä»¥ç›´æ¥é€šè¿‡è¯¥å‘½ä»¤æ¥å¯åŠ¨ä¸€ä¸ªé¡¹ç›®ã€‚é»˜è®¤æƒ…å†µï¼Œ<code>docker-compose up</code> å¯åŠ¨çš„å®¹å™¨éƒ½åœ¨å‰å°ï¼Œæ§åˆ¶å°å°†ä¼šåŒæ—¶æ‰“å°æ‰€æœ‰å®¹å™¨çš„è¾“å‡ºä¿¡æ¯ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿è¿›è¡Œè°ƒè¯•ã€‚</p>
</blockquote><p>å½“é€šè¿‡ <code>Ctrl-C</code> åœæ­¢å‘½ä»¤æ—¶ï¼Œæ‰€æœ‰å®¹å™¨å°†ä¼šåœæ­¢ã€‚</p>
<p>å¦‚æœä½¿ç”¨ <code>docker-compose up -d</code>ï¼Œå°†ä¼šåœ¨åå°å¯åŠ¨å¹¶è¿è¡Œæ‰€æœ‰çš„å®¹å™¨ã€‚ä¸€èˆ¬æ¨èç”Ÿäº§ç¯å¢ƒä¸‹ä½¿ç”¨è¯¥é€‰é¡¹ã€‚</p>
<p>é»˜è®¤æƒ…å†µï¼Œå¦‚æœæœåŠ¡å®¹å™¨å·²ç»å­˜åœ¨ï¼Œ<code>docker-compose up</code> å°†ä¼šå°è¯•åœæ­¢å®¹å™¨ï¼Œç„¶åé‡æ–°åˆ›å»ºï¼ˆä¿æŒä½¿ç”¨ <code>volumes-from</code> æŒ‚è½½çš„å·ï¼‰ï¼Œä»¥ä¿è¯æ–°å¯åŠ¨çš„æœåŠ¡åŒ¹é… <code>docker-compose.yml</code> æ–‡ä»¶çš„æœ€æ–°å†…å®¹ã€‚å¦‚æœä¸å¸Œæœ›å®¹å™¨è¢«åœæ­¢å¹¶é‡æ–°åˆ›å»ºï¼Œå¯ä»¥ä½¿ç”¨ <code>docker-compose up --no-recreate</code>ã€‚è¿™æ ·å°†åªä¼šå¯åŠ¨å¤„äºåœæ­¢çŠ¶æ€çš„å®¹å™¨ï¼Œè€Œå¿½ç•¥å·²ç»è¿è¡Œçš„æœåŠ¡ã€‚å¦‚æœåªæƒ³é‡æ–°éƒ¨ç½²æŸä¸ªæœåŠ¡ï¼Œå¯ä»¥ä½¿ç”¨ <code>docker-compose up --no-deps -d &lt;SERVICE_NAME&gt;</code> æ¥é‡æ–°åˆ›å»ºæœåŠ¡å¹¶åå°åœæ­¢æ—§æœåŠ¡ï¼Œå¯åŠ¨æ–°æœåŠ¡ï¼Œå¹¶ä¸ä¼šå½±å“åˆ°å…¶æ‰€ä¾èµ–çš„æœåŠ¡ã€‚
é€‰é¡¹ï¼š</p>
<ul>
<li><code>-d</code> åœ¨åå°è¿è¡ŒæœåŠ¡å®¹å™¨ã€‚</li>
<li><code>--no-color</code> ä¸ä½¿ç”¨é¢œè‰²æ¥åŒºåˆ†ä¸åŒçš„æœåŠ¡çš„æ§åˆ¶å°è¾“å‡ºã€‚</li>
<li><code>--no-deps</code> ä¸å¯åŠ¨æœåŠ¡æ‰€é“¾æ¥çš„å®¹å™¨ã€‚</li>
<li><code>--force-recreate</code> å¼ºåˆ¶é‡æ–°åˆ›å»ºå®¹å™¨ï¼Œä¸èƒ½ä¸ <code>--no-recreate</code> åŒæ—¶ä½¿ç”¨ã€‚</li>
<li><code>--no-recreate</code> å¦‚æœå®¹å™¨å·²ç»å­˜åœ¨äº†ï¼Œåˆ™ä¸é‡æ–°åˆ›å»ºï¼Œä¸èƒ½ä¸ <code>--force-recreate</code> åŒæ—¶ä½¿ç”¨ã€‚</li>
<li><code>--no-build</code> ä¸è‡ªåŠ¨æ„å»ºç¼ºå¤±çš„æœåŠ¡é•œåƒã€‚</li>
<li><code>-t, --timeout TIMEOUT</code> åœæ­¢å®¹å™¨æ—¶å€™çš„è¶…æ—¶ï¼ˆé»˜è®¤ä¸º 10 ç§’ï¼‰ã€‚</li>
</ul>
<h3 id="version">version<a class="anchor" href="#version">#</a></h3>
<p>æ ¼å¼ï¼š <code>docker-compose version</code></p>
<blockquote class='book-hint '>
<p>æ‰“å°ç‰ˆæœ¬ä¿¡æ¯</p>
</blockquote><h1 id="compose-æ¨¡æ¿æ–‡ä»¶">Compose æ¨¡æ¿æ–‡ä»¶<a class="anchor" href="#compose-%e6%a8%a1%e6%9d%bf%e6%96%87%e4%bb%b6">#</a></h1>
<p>æ¨¡æ¿æ–‡ä»¶æ˜¯ä½¿ç”¨ <code>Compose</code> çš„æ ¸å¿ƒï¼Œæ¶‰åŠåˆ°çš„æŒ‡ä»¤å…³é”®å­—ä¹Ÿå¤§éƒ¨åˆ†æŒ‡ä»¤è·Ÿ <code>docker run</code> ç›¸å…³å‚æ•°çš„å«ä¹‰éƒ½æ˜¯ç±»ä¼¼çš„ã€‚é»˜è®¤çš„æ¨¡æ¿æ–‡ä»¶åç§°ä¸º <code>docker-compose.yml</code>ï¼Œæ ¼å¼ä¸º YAML æ ¼å¼ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>version: <span style="color:#e6db74">&#34;3&#34;</span>
</span></span><span style="display:flex;"><span>services:
</span></span><span style="display:flex;"><span>  webapp:
</span></span><span style="display:flex;"><span>    image: examples/web
</span></span><span style="display:flex;"><span>    ports:
</span></span><span style="display:flex;"><span>      - <span style="color:#e6db74">&#34;80:80&#34;</span>
</span></span><span style="display:flex;"><span>    volumes:
</span></span><span style="display:flex;"><span>      - <span style="color:#e6db74">&#34;/data&#34;</span></span></span></code></pre></div><blockquote class='book-hint '>
<p>æ³¨æ„ï¼šæ¯ä¸ªæœåŠ¡éƒ½å¿…é¡»é€šè¿‡ <code>image</code> æŒ‡ä»¤æŒ‡å®šé•œåƒæˆ– <code>build</code> æŒ‡ä»¤ï¼ˆéœ€è¦ Dockerfileï¼‰ç­‰æ¥è‡ªåŠ¨æ„å»ºç”Ÿæˆé•œåƒ</p>
</blockquote><p>å¦‚æœä½¿ç”¨ <code>build</code> æŒ‡ä»¤ï¼Œåœ¨ <code>Dockerfile</code> ä¸­è®¾ç½®çš„é€‰é¡¹(ä¾‹å¦‚ï¼š<code>CMD</code>, <code>EXPOSE</code>, <code>VOLUME</code>, <code>ENV</code> ç­‰) å°†ä¼šè‡ªåŠ¨è¢«è·å–ï¼Œæ— éœ€åœ¨ <code>docker-compose.yml</code> ä¸­å†æ¬¡è®¾ç½®ã€‚</p>
<h2 id="build-1">build<a class="anchor" href="#build-1">#</a></h2>
<p>æŒ‡å®š <code>Dockerfile</code> æ‰€åœ¨æ–‡ä»¶å¤¹çš„è·¯å¾„ï¼ˆå¯ä»¥æ˜¯ç»å¯¹è·¯å¾„ï¼Œæˆ–è€…ç›¸å¯¹ docker-compose.yml æ–‡ä»¶çš„è·¯å¾„ï¼‰ã€‚ <code>Compose</code> å°†ä¼šåˆ©ç”¨å®ƒè‡ªåŠ¨æ„å»ºè¿™ä¸ªé•œåƒï¼Œç„¶åä½¿ç”¨è¿™ä¸ªé•œåƒã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>version: <span style="color:#e6db74">&#39;3&#39;</span>
</span></span><span style="display:flex;"><span>services:
</span></span><span style="display:flex;"><span>  webapp:
</span></span><span style="display:flex;"><span>    build: ./dir</span></span></code></pre></div><p>ä¹Ÿå¯ä»¥ä½¿ç”¨ <code>context</code> æŒ‡ä»¤æŒ‡å®š <code>Dockerfile</code> æ‰€åœ¨æ–‡ä»¶å¤¹çš„è·¯å¾„ã€‚ä½¿ç”¨ <code>dockerfile</code> æŒ‡ä»¤æŒ‡å®š <code>Dockerfile</code> æ–‡ä»¶åã€‚
ä½¿ç”¨ <code>arg</code> æŒ‡ä»¤æŒ‡å®šæ„å»ºé•œåƒæ—¶çš„å˜é‡ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>version: <span style="color:#e6db74">&#39;3&#39;</span>
</span></span><span style="display:flex;"><span>services:
</span></span><span style="display:flex;"><span>  webapp:
</span></span><span style="display:flex;"><span>    build:
</span></span><span style="display:flex;"><span>      context: ./dir
</span></span><span style="display:flex;"><span>      dockerfile: Dockerfile-alternate
</span></span><span style="display:flex;"><span>      args:
</span></span><span style="display:flex;"><span>        buildno: <span style="color:#ae81ff">1</span></span></span></code></pre></div><p>ä½¿ç”¨ <code>cache_from</code> æŒ‡å®šæ„å»ºé•œåƒçš„ç¼“å­˜</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>build:
</span></span><span style="display:flex;"><span>  context: .
</span></span><span style="display:flex;"><span>  cache_from:
</span></span><span style="display:flex;"><span>    - alpine:latest
</span></span><span style="display:flex;"><span>    - corp/web_app:3.14</span></span></code></pre></div><h2 id="cap_add-cap_drop">cap_add, cap_drop<a class="anchor" href="#cap_add-cap_drop">#</a></h2>
<p>æŒ‡å®šå®¹å™¨çš„å†…æ ¸èƒ½åŠ›ï¼ˆcapacityï¼‰åˆ†é…ã€‚
ä¾‹å¦‚ï¼Œè®©å®¹å™¨æ‹¥æœ‰æ‰€æœ‰èƒ½åŠ›ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cap_add:
</span></span><span style="display:flex;"><span>  - ALL</span></span></code></pre></div><p>å»æ‰ <code>NET_ADMIN</code>Â  èƒ½åŠ›ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cap_drop:
</span></span><span style="display:flex;"><span>  - NET_ADMIN</span></span></code></pre></div><h2 id="command">command<a class="anchor" href="#command">#</a></h2>
<p>è¦†ç›–å®¹å™¨å¯åŠ¨åé»˜è®¤æ‰§è¡Œçš„å‘½ä»¤ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>command: echo <span style="color:#e6db74">&#34;hello world&#34;</span></span></span></code></pre></div><h2 id="cgroup_parent">cgroup_parent<a class="anchor" href="#cgroup_parent">#</a></h2>
<p>æŒ‡å®šçˆ¶ <code>cgroup</code> ç»„ï¼Œæ„å‘³ç€å°†ç»§æ‰¿è¯¥ç»„çš„èµ„æºé™åˆ¶ã€‚
ä¾‹å¦‚ï¼Œåˆ›å»ºäº†ä¸€ä¸ª cgroup ç»„åç§°ä¸º <code>cgroups_1</code>ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cgroup_parent: cgroups_1</span></span></code></pre></div><h2 id="container_name">container_name<a class="anchor" href="#container_name">#</a></h2>
<p>æŒ‡å®šå®¹å™¨åç§°ã€‚é»˜è®¤å°†ä¼šä½¿ç”¨ <code>é¡¹ç›®åç§°_æœåŠ¡åç§°_åºå·</code> è¿™æ ·çš„æ ¼å¼ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>container_name: docker-web-container</span></span></code></pre></div><blockquote class='book-hint '>
<p>æ³¨æ„: æŒ‡å®šå®¹å™¨åç§°åï¼Œè¯¥æœåŠ¡å°†æ— æ³•è¿›è¡Œæ‰©å±•ï¼ˆscaleï¼‰ï¼Œå› ä¸º Docker ä¸å…è®¸å¤šä¸ªå®¹å™¨å…·æœ‰ç›¸åŒçš„åç§°</p>
</blockquote><h2 id="devices">devices<a class="anchor" href="#devices">#</a></h2>
<p>æŒ‡å®šè®¾å¤‡æ˜ å°„å…³ç³»ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>devices:
</span></span><span style="display:flex;"><span>  - <span style="color:#e6db74">&#34;/dev/ttyUSB1:/dev/ttyUSB0&#34;</span></span></span></code></pre></div><h2 id="depends_on">depends_on<a class="anchor" href="#depends_on">#</a></h2>
<p>è§£å†³å®¹å™¨çš„ä¾èµ–ã€å¯åŠ¨å…ˆåçš„é—®é¢˜ã€‚ä»¥ä¸‹ä¾‹å­ä¸­ä¼šå…ˆå¯åŠ¨ <code>redis</code> <code>db</code> å†å¯åŠ¨ <code>webã€‚</code></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>version: <span style="color:#e6db74">&#39;3&#39;</span>
</span></span><span style="display:flex;"><span>services:
</span></span><span style="display:flex;"><span>  web:
</span></span><span style="display:flex;"><span>    build: .
</span></span><span style="display:flex;"><span>    depends_on:
</span></span><span style="display:flex;"><span>      - db
</span></span><span style="display:flex;"><span>      - redis
</span></span><span style="display:flex;"><span>  redis:
</span></span><span style="display:flex;"><span>    image: redis
</span></span><span style="display:flex;"><span>  db:
</span></span><span style="display:flex;"><span>    image: postgres</span></span></code></pre></div><blockquote class='book-hint '>
<p>æ³¨æ„ï¼š<code>web</code> æœåŠ¡ä¸ä¼šç­‰å¾… <code>redis</code> <code>db</code> ã€Œå®Œå…¨å¯åŠ¨ã€ä¹‹åæ‰å¯åŠ¨</p>
</blockquote><h2 id="dns">dns<a class="anchor" href="#dns">#</a></h2>
<p>è‡ªå®šä¹‰ <code>DNS</code> æœåŠ¡å™¨ã€‚å¯ä»¥æ˜¯ä¸€ä¸ªå€¼ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªåˆ—è¡¨ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>dns: 8.8.8.8
</span></span><span style="display:flex;"><span>dns:
</span></span><span style="display:flex;"><span>  - 8.8.8.8
</span></span><span style="display:flex;"><span>  - 114.114.114.114</span></span></code></pre></div><h2 id="dns_search">dns_search<a class="anchor" href="#dns_search">#</a></h2>
<p>é…ç½® <code>DNS</code> æœç´¢åŸŸã€‚å¯ä»¥æ˜¯ä¸€ä¸ªå€¼ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªåˆ—è¡¨ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>dns_search: example.com
</span></span><span style="display:flex;"><span>dns_search:
</span></span><span style="display:flex;"><span>  - domain1.example.com
</span></span><span style="display:flex;"><span>  - domain2.example.com</span></span></code></pre></div><h2 id="tmpfs">tmpfs<a class="anchor" href="#tmpfs">#</a></h2>
<p>æŒ‚è½½ä¸€ä¸ª tmpfs æ–‡ä»¶ç³»ç»Ÿåˆ°å®¹å™¨ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>tmpfs: /run
</span></span><span style="display:flex;"><span>tmpfs:
</span></span><span style="display:flex;"><span>  - /run
</span></span><span style="display:flex;"><span>  - /tmp</span></span></code></pre></div><h2 id="env_file">env_file<a class="anchor" href="#env_file">#</a></h2>
<p>ä»æ–‡ä»¶ä¸­è·å–ç¯å¢ƒå˜é‡ï¼Œå¯ä»¥ä¸ºå•ç‹¬çš„æ–‡ä»¶è·¯å¾„æˆ–åˆ—è¡¨ã€‚å¦‚æœé€šè¿‡ <code>docker-compose -f FILE</code> æ–¹å¼æ¥æŒ‡å®š Compose æ¨¡æ¿æ–‡ä»¶ï¼Œåˆ™ <code>env_file</code> ä¸­å˜é‡çš„è·¯å¾„ä¼šåŸºäºæ¨¡æ¿æ–‡ä»¶è·¯å¾„ã€‚å¦‚æœæœ‰å˜é‡åç§°ä¸ <code>environment</code> æŒ‡ä»¤å†²çªï¼Œåˆ™æŒ‰ç…§æƒ¯ä¾‹ï¼Œä»¥åè€…ä¸ºå‡†ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>env_file: .env
</span></span><span style="display:flex;"><span>env_file:
</span></span><span style="display:flex;"><span>  - ./common.env
</span></span><span style="display:flex;"><span>  - ./apps/web.env
</span></span><span style="display:flex;"><span>  - /opt/secrets.env</span></span></code></pre></div><p>ç¯å¢ƒå˜é‡æ–‡ä»¶ä¸­æ¯ä¸€è¡Œå¿…é¡»ç¬¦åˆæ ¼å¼ï¼Œæ”¯æŒ <code>#</code> å¼€å¤´çš„æ³¨é‡Šè¡Œã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># common.env: Set development environment</span>
</span></span><span style="display:flex;"><span>PROG_ENV<span style="color:#f92672">=</span>development</span></span></code></pre></div><h2 id="environment">environment<a class="anchor" href="#environment">#</a></h2>
<p>è®¾ç½®ç¯å¢ƒå˜é‡ã€‚å¯ä»¥ä½¿ç”¨æ•°ç»„æˆ–å­—å…¸ä¸¤ç§æ ¼å¼ã€‚åªç»™å®šåç§°çš„å˜é‡ä¼šè‡ªåŠ¨è·å–è¿è¡Œ Compose ä¸»æœºä¸Šå¯¹åº”å˜é‡çš„å€¼ï¼Œå¯ä»¥ç”¨æ¥é˜²æ­¢æ³„éœ²ä¸å¿…è¦çš„æ•°æ®ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>environment:
</span></span><span style="display:flex;"><span>  RACK_ENV: development
</span></span><span style="display:flex;"><span>  SESSION_SECRET:
</span></span><span style="display:flex;"><span>environment:
</span></span><span style="display:flex;"><span>  - RACK_ENV<span style="color:#f92672">=</span>development
</span></span><span style="display:flex;"><span>  - SESSION_SECRET</span></span></code></pre></div><p>å¦‚æœå˜é‡åç§°æˆ–è€…å€¼ä¸­ç”¨åˆ° <code>true|falseï¼Œyes|no</code> ç­‰è¡¨è¾¾ <a href="http://yaml.org/type/bool.html">å¸ƒå°”</a> å«ä¹‰çš„è¯æ±‡ï¼Œæœ€å¥½æ”¾åˆ°å¼•å·é‡Œï¼Œé¿å… YAML è‡ªåŠ¨è§£ææŸäº›å†…å®¹ä¸ºå¯¹åº”çš„å¸ƒå°”è¯­ä¹‰ã€‚è¿™äº›ç‰¹å®šè¯æ±‡ï¼ŒåŒ…æ‹¬</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>y|Y|yes|Yes|YES|n|N|no|No|NO|true|True|TRUE|false|False|FALSE|on|On|ON|off|Off|OFF</span></span></code></pre></div><h2 id="expose">expose<a class="anchor" href="#expose">#</a></h2>
<p>æš´éœ²ç«¯å£ï¼Œä½†ä¸æ˜ å°„åˆ°å®¿ä¸»æœºï¼Œåªè¢«è¿æ¥çš„æœåŠ¡è®¿é—®ã€‚ä»…å¯ä»¥æŒ‡å®šå†…éƒ¨ç«¯å£ä¸ºå‚æ•°ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>expose:
</span></span><span style="display:flex;"><span>  - <span style="color:#e6db74">&#34;3000&#34;</span>
</span></span><span style="display:flex;"><span>  - <span style="color:#e6db74">&#34;8000&#34;</span></span></span></code></pre></div><h2 id="external_links">external_links<a class="anchor" href="#external_links">#</a></h2>
<p>é“¾æ¥åˆ° <code>docker-compose.yml</code> å¤–éƒ¨çš„å®¹å™¨ï¼Œç”šè‡³å¹¶é <code>Compose</code> ç®¡ç†çš„å¤–éƒ¨å®¹å™¨ã€‚</p>
<blockquote class='book-hint '>
<p>æ³¨æ„ï¼šä¸å»ºè®®ä½¿ç”¨è¯¥æŒ‡ä»¤</p>
</blockquote><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>external_links:
</span></span><span style="display:flex;"><span> - redis_1
</span></span><span style="display:flex;"><span> - project_db_1:mysql
</span></span><span style="display:flex;"><span> - project_db_1:postgresql</span></span></code></pre></div><h2 id="extra_hosts">extra_hosts<a class="anchor" href="#extra_hosts">#</a></h2>
<p>ç±»ä¼¼ Docker ä¸­çš„ <code>--add-host</code> å‚æ•°ï¼ŒæŒ‡å®šé¢å¤–çš„ host åç§°æ˜ å°„ä¿¡æ¯ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>extra_hosts:
</span></span><span style="display:flex;"><span> - <span style="color:#e6db74">&#34;googledns:8.8.8.8&#34;</span>
</span></span><span style="display:flex;"><span> - <span style="color:#e6db74">&#34;dockerhub:52.1.157.61&#34;</span></span></span></code></pre></div><p>ä¼šåœ¨å¯åŠ¨åçš„æœåŠ¡å®¹å™¨ä¸­ <code>/etc/hosts</code> æ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹ä¸¤æ¡æ¡ç›®</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>8.8.8.8 googledns
</span></span><span style="display:flex;"><span>52.1.157.61 dockerhub</span></span></code></pre></div><h2 id="healthcheck">healthcheck<a class="anchor" href="#healthcheck">#</a></h2>
<p>é€šè¿‡å‘½ä»¤æ£€æŸ¥å®¹å™¨æ˜¯å¦å¥åº·è¿è¡Œã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>healthcheck:
</span></span><span style="display:flex;"><span>  test: <span style="color:#f92672">[</span><span style="color:#e6db74">&#34;CMD&#34;</span>, <span style="color:#e6db74">&#34;curl&#34;</span>, <span style="color:#e6db74">&#34;-f&#34;</span>, <span style="color:#e6db74">&#34;http://localhost&#34;</span><span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>  interval: 1m30s
</span></span><span style="display:flex;"><span>  timeout: 10s
</span></span><span style="display:flex;"><span>  retries: <span style="color:#ae81ff">3</span></span></span></code></pre></div><h2 id="image">image<a class="anchor" href="#image">#</a></h2>
<p>æŒ‡å®šä¸ºé•œåƒåç§°æˆ–é•œåƒ IDã€‚å¦‚æœé•œåƒåœ¨æœ¬åœ°ä¸å­˜åœ¨ï¼Œ<code>Compose</code> å°†ä¼šå°è¯•æ‹‰å–è¿™ä¸ªé•œåƒã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>image: ubuntu
</span></span><span style="display:flex;"><span>image: orchardup/postgresql
</span></span><span style="display:flex;"><span>image: a4bc65fd</span></span></code></pre></div><h2 id="labels">labels<a class="anchor" href="#labels">#</a></h2>
<p>ä¸ºå®¹å™¨æ·»åŠ  Docker å…ƒæ•°æ®ï¼ˆmetadataï¼‰ä¿¡æ¯ã€‚ä¾‹å¦‚å¯ä»¥ä¸ºå®¹å™¨æ·»åŠ è¾…åŠ©è¯´æ˜ä¿¡æ¯ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>labels:
</span></span><span style="display:flex;"><span>  com.startupteam.description: <span style="color:#e6db74">&#34;webapp for a startup team&#34;</span>
</span></span><span style="display:flex;"><span>  com.startupteam.department: <span style="color:#e6db74">&#34;devops department&#34;</span>
</span></span><span style="display:flex;"><span>  com.startupteam.release: <span style="color:#e6db74">&#34;rc3 for v1.0&#34;</span></span></span></code></pre></div><h2 id="links">links<a class="anchor" href="#links">#</a></h2>
<blockquote class='book-hint '>
<p>æ³¨æ„ï¼šä¸æ¨èä½¿ç”¨è¯¥æŒ‡ä»¤</p>
</blockquote><h2 id="logging">logging<a class="anchor" href="#logging">#</a></h2>
<p>é…ç½®æ—¥å¿—é€‰é¡¹ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>logging:
</span></span><span style="display:flex;"><span>  driver: syslog
</span></span><span style="display:flex;"><span>  options:
</span></span><span style="display:flex;"><span>    syslog-address: <span style="color:#e6db74">&#34;tcp://192.168.0.42:123&#34;</span></span></span></code></pre></div><p>ç›®å‰æ”¯æŒä¸‰ç§æ—¥å¿—é©±åŠ¨ç±»å‹</p>
<ul>
<li><code>driver: &quot;json-file&quot;</code></li>
<li><code>driver: &quot;syslog&quot;</code></li>
<li><code>driver: &quot;none&quot;</code></li>
</ul>
<p><code>options</code> é…ç½®æ—¥å¿—é©±åŠ¨çš„ç›¸å…³å‚æ•°</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>options:
</span></span><span style="display:flex;"><span>  max-size: <span style="color:#e6db74">&#34;200k&#34;</span>
</span></span><span style="display:flex;"><span>  max-file: <span style="color:#e6db74">&#34;10&#34;</span></span></span></code></pre></div><h2 id="network_mode">network_mode<a class="anchor" href="#network_mode">#</a></h2>
<p>è®¾ç½®ç½‘ç»œæ¨¡å¼ã€‚ä½¿ç”¨å’Œ <code>docker run</code> çš„ <code>--network</code> å‚æ•°ä¸€æ ·çš„å€¼ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>network_mode: <span style="color:#e6db74">&#34;bridge&#34;</span>
</span></span><span style="display:flex;"><span>network_mode: <span style="color:#e6db74">&#34;host&#34;</span>
</span></span><span style="display:flex;"><span>network_mode: <span style="color:#e6db74">&#34;none&#34;</span>
</span></span><span style="display:flex;"><span>network_mode: <span style="color:#e6db74">&#34;service:[service name]&#34;</span>
</span></span><span style="display:flex;"><span>network_mode: <span style="color:#e6db74">&#34;container:[container name/id]&#34;</span></span></span></code></pre></div><h2 id="networks">networks<a class="anchor" href="#networks">#</a></h2>
<p>é…ç½®å®¹å™¨è¿æ¥çš„ç½‘ç»œã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>version: <span style="color:#e6db74">&#34;3&#34;</span>
</span></span><span style="display:flex;"><span>services:
</span></span><span style="display:flex;"><span>  some-service:
</span></span><span style="display:flex;"><span>    networks:
</span></span><span style="display:flex;"><span>     - some-network
</span></span><span style="display:flex;"><span>     - other-network
</span></span><span style="display:flex;"><span>networks:
</span></span><span style="display:flex;"><span>  some-network:
</span></span><span style="display:flex;"><span>  other-network:</span></span></code></pre></div><h2 id="pid">pid<a class="anchor" href="#pid">#</a></h2>
<p>è·Ÿä¸»æœºç³»ç»Ÿå…±äº«è¿›ç¨‹å‘½åç©ºé—´ã€‚æ‰“å¼€è¯¥é€‰é¡¹çš„å®¹å™¨ä¹‹é—´ï¼Œä»¥åŠå®¹å™¨å’Œå®¿ä¸»æœºç³»ç»Ÿä¹‹é—´å¯ä»¥é€šè¿‡è¿›ç¨‹ ID æ¥ç›¸äº’è®¿é—®å’Œæ“ä½œã€‚<code>pid: &quot;host&quot;</code></p>
<h2 id="ports">ports<a class="anchor" href="#ports">#</a></h2>
<p>æš´éœ²ç«¯å£ä¿¡æ¯ã€‚ä½¿ç”¨å®¿ä¸»ç«¯å£ï¼šå®¹å™¨ç«¯å£ <code>(HOST:CONTAINER)</code> æ ¼å¼ï¼Œæˆ–è€…ä»…ä»…æŒ‡å®šå®¹å™¨çš„ç«¯å£ï¼ˆå®¿ä¸»å°†ä¼šéšæœºé€‰æ‹©ç«¯å£ï¼‰éƒ½å¯ä»¥ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ports:
</span></span><span style="display:flex;"><span> - <span style="color:#e6db74">&#34;3000&#34;</span>
</span></span><span style="display:flex;"><span> - <span style="color:#e6db74">&#34;8000:8000&#34;</span>
</span></span><span style="display:flex;"><span> - <span style="color:#e6db74">&#34;49100:22&#34;</span>
</span></span><span style="display:flex;"><span> - <span style="color:#e6db74">&#34;127.0.0.1:8001:8001&#34;</span></span></span></code></pre></div><blockquote class='book-hint '>
<p>æ³¨æ„ï¼šå½“ä½¿ç”¨ <code>HOST:CONTAINER</code> æ ¼å¼æ¥æ˜ å°„ç«¯å£æ—¶ï¼Œå¦‚æœä½¿ç”¨çš„å®¹å™¨ç«¯å£å°äº 60 å¹¶ä¸”æ²¡æ”¾åˆ°å¼•å·é‡Œï¼Œå¯èƒ½ä¼šå¾—åˆ°é”™è¯¯ç»“æœï¼Œå› ä¸º <code>YAML</code> ä¼šè‡ªåŠ¨è§£æ <code>xx:yy</code> è¿™ç§æ•°å­—æ ¼å¼ä¸º 60 è¿›åˆ¶ã€‚ä¸ºé¿å…å‡ºç°è¿™ç§é—®é¢˜ï¼Œå»ºè®®æ•°å­—ä¸²éƒ½é‡‡ç”¨å¼•å·åŒ…æ‹¬èµ·æ¥çš„å­—ç¬¦ä¸²æ ¼å¼</p>
</blockquote><h2 id="secrets">secrets<a class="anchor" href="#secrets">#</a></h2>
<p>å­˜å‚¨æ•æ„Ÿæ•°æ®ï¼Œä¾‹å¦‚ <code>mysql</code> æœåŠ¡å¯†ç ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>version: <span style="color:#e6db74">&#34;3.1&#34;</span>
</span></span><span style="display:flex;"><span>services:
</span></span><span style="display:flex;"><span>mysql:
</span></span><span style="display:flex;"><span>  image: mysql
</span></span><span style="display:flex;"><span>  environment:
</span></span><span style="display:flex;"><span>    MYSQL_ROOT_PASSWORD_FILE: /run/secrets/db_root_password
</span></span><span style="display:flex;"><span>  secrets:
</span></span><span style="display:flex;"><span>    - db_root_password
</span></span><span style="display:flex;"><span>    - my_other_secret
</span></span><span style="display:flex;"><span>secrets:
</span></span><span style="display:flex;"><span>  my_secret:
</span></span><span style="display:flex;"><span>    file: ./my_secret.txt
</span></span><span style="display:flex;"><span>  my_other_secret:
</span></span><span style="display:flex;"><span>    external: true</span></span></code></pre></div><h2 id="security_opt">security_opt<a class="anchor" href="#security_opt">#</a></h2>
<p>æŒ‡å®šå®¹å™¨æ¨¡æ¿æ ‡ç­¾ï¼ˆlabelï¼‰æœºåˆ¶çš„é»˜è®¤å±æ€§ï¼ˆç”¨æˆ·ã€è§’è‰²ã€ç±»å‹ã€çº§åˆ«ç­‰ï¼‰ã€‚ä¾‹å¦‚é…ç½®æ ‡ç­¾çš„ç”¨æˆ·åå’Œè§’è‰²åã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>security_opt:
</span></span><span style="display:flex;"><span>    - label:user:USER
</span></span><span style="display:flex;"><span>    - label:role:ROLE</span></span></code></pre></div><h2 id="stop_signal">stop_signal<a class="anchor" href="#stop_signal">#</a></h2>
<p>è®¾ç½®å¦ä¸€ä¸ªä¿¡å·æ¥åœæ­¢å®¹å™¨ã€‚åœ¨é»˜è®¤æƒ…å†µä¸‹ä½¿ç”¨çš„æ˜¯ SIGTERM åœæ­¢å®¹å™¨ã€‚<code>stop_signal: SIGUSR1</code></p>
<h2 id="sysctls">sysctls<a class="anchor" href="#sysctls">#</a></h2>
<p>é…ç½®å®¹å™¨å†…æ ¸å‚æ•°ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sysctls:
</span></span><span style="display:flex;"><span>  net.core.somaxconn: <span style="color:#ae81ff">1024</span>
</span></span><span style="display:flex;"><span>  net.ipv4.tcp_syncookies: <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>sysctls:
</span></span><span style="display:flex;"><span>  - net.core.somaxconn<span style="color:#f92672">=</span><span style="color:#ae81ff">1024</span>
</span></span><span style="display:flex;"><span>  - net.ipv4.tcp_syncookies<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span></span></span></code></pre></div><h2 id="ulimits">ulimits<a class="anchor" href="#ulimits">#</a></h2>
<p>æŒ‡å®šå®¹å™¨çš„ ulimits é™åˆ¶å€¼ã€‚ä¾‹å¦‚ï¼ŒæŒ‡å®šæœ€å¤§è¿›ç¨‹æ•°ä¸º 65535ï¼ŒæŒ‡å®šæ–‡ä»¶å¥æŸ„æ•°ä¸º 20000ï¼ˆè½¯é™åˆ¶ï¼Œåº”ç”¨å¯ä»¥éšæ—¶ä¿®æ”¹ï¼Œä¸èƒ½è¶…è¿‡ç¡¬é™åˆ¶ï¼‰ å’Œ 40000ï¼ˆç³»ç»Ÿç¡¬é™åˆ¶ï¼Œåªèƒ½ root ç”¨æˆ·æé«˜ï¼‰ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ulimits:
</span></span><span style="display:flex;"><span>    nproc: <span style="color:#ae81ff">65535</span>
</span></span><span style="display:flex;"><span>    nofile:
</span></span><span style="display:flex;"><span>      soft: <span style="color:#ae81ff">20000</span>
</span></span><span style="display:flex;"><span>      hard: <span style="color:#ae81ff">40000</span></span></span></code></pre></div><h2 id="volumes">volumes<a class="anchor" href="#volumes">#</a></h2>
<p>æ•°æ®å·æ‰€æŒ‚è½½è·¯å¾„è®¾ç½®ã€‚å¯ä»¥è®¾ç½®å®¿ä¸»æœºè·¯å¾„ ï¼ˆ<code>HOST:CONTAINER</code>ï¼‰ æˆ–åŠ ä¸Šè®¿é—®æ¨¡å¼ ï¼ˆ<code>HOST:CONTAINER:ro</code>ï¼‰ã€‚è¯¥æŒ‡ä»¤ä¸­è·¯å¾„æ”¯æŒç›¸å¯¹è·¯å¾„ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>volumes:
</span></span><span style="display:flex;"><span> - /var/lib/mysql
</span></span><span style="display:flex;"><span> - cache/:/tmp/cache
</span></span><span style="display:flex;"><span> - ~/configs:/etc/configs/:ro</span></span></code></pre></div><h2 id="å…¶å®ƒæŒ‡ä»¤">å…¶å®ƒæŒ‡ä»¤<a class="anchor" href="#%e5%85%b6%e5%ae%83%e6%8c%87%e4%bb%a4">#</a></h2>
<p>æ­¤å¤–ï¼Œè¿˜æœ‰åŒ…æ‹¬ <code>domainname, entrypoint, hostname, ipc, mac_address, privileged, read_only, shm_size, restart, stdin_open, tty, user, working_dir</code> ç­‰æŒ‡ä»¤ï¼ŒåŸºæœ¬è·Ÿ <code>docker run</code> ä¸­å¯¹åº”å‚æ•°çš„åŠŸèƒ½ä¸€è‡´ã€‚</p>
<p><strong>æŒ‡å®šæœåŠ¡å®¹å™¨å¯åŠ¨åæ‰§è¡Œçš„å…¥å£æ–‡ä»¶</strong></p>
<p><code>entrypoint: /code/entrypoint.sh</code></p>
<p><strong>æŒ‡å®šå®¹å™¨ä¸­è¿è¡Œåº”ç”¨çš„ç”¨æˆ·å</strong>
<code>user: nginx</code></p>
<p><strong>æŒ‡å®šå®¹å™¨ä¸­å·¥ä½œç›®å½•</strong>
<code>working_dir: /code</code></p>
<p><strong>æŒ‡å®šå®¹å™¨ä¸­æœç´¢åŸŸåã€ä¸»æœºåã€mac åœ°å€ç­‰</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>domainname: your_website.com
</span></span><span style="display:flex;"><span>hostname: test
</span></span><span style="display:flex;"><span>mac_address: 08-00-27-00-0C-0A</span></span></code></pre></div><p><strong>å…è®¸å®¹å™¨ä¸­è¿è¡Œä¸€äº›ç‰¹æƒå‘½ä»¤</strong>
<code>privileged: true</code></p>
<p><strong>æŒ‡å®šå®¹å™¨é€€å‡ºåçš„é‡å¯ç­–ç•¥ä¸ºå§‹ç»ˆé‡å¯ã€‚è¯¥å‘½ä»¤å¯¹ä¿æŒæœåŠ¡å§‹ç»ˆè¿è¡Œååˆ†æœ‰æ•ˆï¼Œåœ¨ç”Ÿäº§ç¯å¢ƒä¸­æ¨èé…ç½®ä¸º <code>always</code> æˆ–è€… <code>unless-stopped</code></strong>
<code>restart: always</code></p>
<p><strong>ä»¥åªè¯»æ¨¡å¼æŒ‚è½½å®¹å™¨çš„ root æ–‡ä»¶ç³»ç»Ÿï¼Œæ„å‘³ç€ä¸èƒ½å¯¹å®¹å™¨å†…å®¹è¿›è¡Œä¿®æ”¹</strong>
<code>read_only: true</code></p>
<p><strong>æ‰“å¼€æ ‡å‡†è¾“å…¥ï¼Œå¯ä»¥æ¥å—å¤–éƒ¨è¾“å…¥</strong>
<code>stdin_open: true</code></p>
<p><strong>æ¨¡æ‹Ÿä¸€ä¸ªä¼ªç»ˆç«¯</strong>
<code>tty: true</code></p>
<h2 id="è¯»å–å˜é‡">è¯»å–å˜é‡<a class="anchor" href="#%e8%af%bb%e5%8f%96%e5%8f%98%e9%87%8f">#</a></h2>
<p>Compose æ¨¡æ¿æ–‡ä»¶æ”¯æŒåŠ¨æ€è¯»å–ä¸»æœºçš„ç³»ç»Ÿç¯å¢ƒå˜é‡å’Œå½“å‰ç›®å½•ä¸‹çš„ <code>.env</code> æ–‡ä»¶ä¸­çš„å˜é‡ã€‚
ä¾‹å¦‚ï¼Œä¸‹é¢çš„ Compose æ–‡ä»¶å°†ä»è¿è¡Œå®ƒçš„ç¯å¢ƒä¸­è¯»å–å˜é‡ <code>${MONGO_VERSION}</code> çš„å€¼ï¼Œå¹¶å†™å…¥æ‰§è¡Œçš„æŒ‡ä»¤ä¸­ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>version: <span style="color:#e6db74">&#34;3&#34;</span>
</span></span><span style="display:flex;"><span>services:
</span></span><span style="display:flex;"><span>db:
</span></span><span style="display:flex;"><span>  image: <span style="color:#e6db74">&#34;mongo:</span><span style="color:#e6db74">${</span>MONGO_VERSION<span style="color:#e6db74">}</span><span style="color:#e6db74">&#34;</span></span></span></code></pre></div><p>å¦‚æœæ‰§è¡Œ <code>MONGO_VERSION=3.2 docker-compose up</code> åˆ™ä¼šå¯åŠ¨ä¸€ä¸ª <code>mongo:3.2</code> é•œåƒçš„å®¹å™¨ï¼›å¦‚æœæ‰§è¡Œ <code>MONGO_VERSION=2.8 docker-compose up</code> åˆ™ä¼šå¯åŠ¨ä¸€ä¸ª <code>mongo:2.8</code> é•œåƒçš„å®¹å™¨ã€‚
è‹¥å½“å‰ç›®å½•å­˜åœ¨ <code>.env</code> æ–‡ä»¶ï¼Œæ‰§è¡Œ <code>docker-compose</code> å‘½ä»¤æ—¶å°†ä»è¯¥æ–‡ä»¶ä¸­è¯»å–å˜é‡ã€‚
åœ¨å½“å‰ç›®å½•æ–°å»º <code>.env</code> æ–‡ä»¶å¹¶å†™å…¥ä»¥ä¸‹å†…å®¹ã€‚</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># æ”¯æŒ # å·æ³¨é‡Š</span>
</span></span><span style="display:flex;"><span>MONGO_VERSION<span style="color:#f92672">=</span>3.6</span></span></code></pre></div><p>æ‰§è¡Œ <code>docker-compose up</code> åˆ™ä¼šå¯åŠ¨ä¸€ä¸ª <code>mongo:3.6</code> é•œåƒçš„å®¹å™¨ã€‚</p>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">

<div>

</div>

<div>

</div>

</div>





  
  
  
  <div class="flex flex-wrap justify-between">
    <span>
    
      <a href="/docs/docker/1.8dockerfile/" class="flex align-center">
        <img src="/icons/backward.svg" class="book-icon" alt="Backward" />
        <span>1.8 Dockerfile</span>
      </a>
    
    </span>
    <span>
    
      <a href="/docs/docker/2.0dockermachine/" class="flex align-center">
        <span>2.0 Docker Machine</span>
        <img src="/icons/forward.svg" class="book-icon" alt="Forward" />
      </a>
    
    </span>
  </div>
  


 
        
  
 
        
        
  
 
        
  
  
    <script>(function(){document.querySelectorAll("pre:has(code)").forEach(e=>{e.addEventListener("click",e.focus),e.addEventListener("copy",function(t){if(t.preventDefault(),navigator.clipboard){const t=window.getSelection().toString()||e.textContent;navigator.clipboard.writeText(t)}})})})()</script>
  

      </footer>

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
  
  <aside class="book-toc">
    <div class="book-toc-content">
      
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#å‘½ä»¤é€‰é¡¹">å‘½ä»¤é€‰é¡¹</a></li>
    <li><a href="#å‘½ä»¤ä½¿ç”¨è¯´æ˜">å‘½ä»¤ä½¿ç”¨è¯´æ˜</a>
      <ul>
        <li><a href="#build">build</a></li>
        <li><a href="#config">config</a></li>
        <li><a href="#down">down</a></li>
        <li><a href="#exec">exec</a></li>
        <li><a href="#help">help</a></li>
        <li><a href="#images">images</a></li>
        <li><a href="#kill">kill</a></li>
        <li><a href="#logs">logs</a></li>
        <li><a href="#pause">pause</a></li>
        <li><a href="#port">port</a></li>
        <li><a href="#ps">ps</a></li>
        <li><a href="#pull">pull</a></li>
        <li><a href="#push">push</a></li>
        <li><a href="#restart">restart</a></li>
        <li><a href="#rm">rm</a></li>
        <li><a href="#run">run</a></li>
        <li><a href="#scale">scale</a></li>
        <li><a href="#start">start</a></li>
        <li><a href="#stop">stop</a></li>
        <li><a href="#top">top</a></li>
        <li><a href="#unpause">unpause</a></li>
        <li><a href="#up">up</a></li>
        <li><a href="#version">version</a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li><a href="#build-1">build</a></li>
    <li><a href="#cap_add-cap_drop">cap_add, cap_drop</a></li>
    <li><a href="#command">command</a></li>
    <li><a href="#cgroup_parent">cgroup_parent</a></li>
    <li><a href="#container_name">container_name</a></li>
    <li><a href="#devices">devices</a></li>
    <li><a href="#depends_on">depends_on</a></li>
    <li><a href="#dns">dns</a></li>
    <li><a href="#dns_search">dns_search</a></li>
    <li><a href="#tmpfs">tmpfs</a></li>
    <li><a href="#env_file">env_file</a></li>
    <li><a href="#environment">environment</a></li>
    <li><a href="#expose">expose</a></li>
    <li><a href="#external_links">external_links</a></li>
    <li><a href="#extra_hosts">extra_hosts</a></li>
    <li><a href="#healthcheck">healthcheck</a></li>
    <li><a href="#image">image</a></li>
    <li><a href="#labels">labels</a></li>
    <li><a href="#links">links</a></li>
    <li><a href="#logging">logging</a></li>
    <li><a href="#network_mode">network_mode</a></li>
    <li><a href="#networks">networks</a></li>
    <li><a href="#pid">pid</a></li>
    <li><a href="#ports">ports</a></li>
    <li><a href="#secrets">secrets</a></li>
    <li><a href="#security_opt">security_opt</a></li>
    <li><a href="#stop_signal">stop_signal</a></li>
    <li><a href="#sysctls">sysctls</a></li>
    <li><a href="#ulimits">ulimits</a></li>
    <li><a href="#volumes">volumes</a></li>
    <li><a href="#å…¶å®ƒæŒ‡ä»¤">å…¶å®ƒæŒ‡ä»¤</a></li>
    <li><a href="#è¯»å–å˜é‡">è¯»å–å˜é‡</a></li>
  </ul>
</nav>



    </div>
  </aside>
  
 
  </main>

  
</body>
</html>





















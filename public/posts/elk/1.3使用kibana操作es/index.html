<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="之前说到 ES 提供了 RESTful 风格的接口以便于我们操作，需要借助能够发送HTTP请求的工具调用这些API，工具是可以任意的，包括网页浏览器，当然也可以使用比如 Postman / Talend API tester等工具。这里为了学习 ElK 所以选择使用 Kibana，关于 Kibana 如何安装参考其他文章。
集群相关# 查看集群健康信息# GET _cat/health?vepoch timestamp cluster status node.total node.data shards pri relo init unassign pending_tasks max_task_wait_time active_shards_percent 1646502528 17:48:48 elasticsearch green 1 1 3 3 0 0 0 0 - 100.0%主要字段描述：
cluster：集群名称 status：集群状态 node.total：集群中的节点数 node.data：集群中的数据节点数 shards：集群中总的分片数量 pri：主分片数量，英文全称为 private relo：复制分片总数 unassign：未指定的分片数量，是应有分片数和现有的分片数的差值（包括主分片和复制分片） 集群共有 green 、yellow 、 red 三种状态：
green 代表一切正常，集群功能齐全 yellow 代表所有数据都是可用的，但是某些复制没有被分配（集群功能齐全） red 代表因为某些原因，某些数据不可用。如果是red状态，数据很有可能已经丢失 可以在请求中添加 help 参数来查看每个操作返回结果字段的描述
GET _cat/health?helpepoch | t,time | seconds since 1970-01-01 00:00:00 timestamp | ts,hms,hhmmss | time in HH:MM:SS cluster | cl | cluster name status | st | health status node.total | nt,nodeTotal | total number of nodes node.data | nd,nodeData | number of nodes that can store data shards | t,sh,shards.total,shardsTotal | total number of shards pri | p,shards.primary,shardsPrimary | number of primary shards relo | r,shards.relocating,shardsRelocating | number of relocating nodes init | i,shards.initializing,shardsInitializing | number of initializing nodes unassign | u,shards.unassigned,shardsUnassigned | number of unassigned shards pending_tasks | pt,pendingTasks | number of pending tasks max_task_wait_time | mtwt,maxTaskWaitTime | wait time of longest task pending active_shards_percent | asp,activeShardsPercent | active number of shards in percent ES中许多API都可以添加 help 参数来显示字段含义，如果觉得返回的东西太多看着烦，也可以人为指定返回的字段，比如：
">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="#ffffff">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="#343a40">
<meta name="color-scheme" content="light dark"><meta property="og:url" content="http://localhost:1313/posts/elk/1.3%E4%BD%BF%E7%94%A8kibana%E6%93%8D%E4%BD%9Ces/">
  <meta property="og:site_name" content="CODE&#39;NOTE">
  <meta property="og:title" content="CODE&#39;NOTE">
  <meta property="og:description" content="之前说到 ES 提供了 RESTful 风格的接口以便于我们操作，需要借助能够发送HTTP请求的工具调用这些API，工具是可以任意的，包括网页浏览器，当然也可以使用比如 Postman / Talend API tester等工具。这里为了学习 ElK 所以选择使用 Kibana，关于 Kibana 如何安装参考其他文章。
集群相关# 查看集群健康信息# GET _cat/health?vepoch timestamp cluster status node.total node.data shards pri relo init unassign pending_tasks max_task_wait_time active_shards_percent 1646502528 17:48:48 elasticsearch green 1 1 3 3 0 0 0 0 - 100.0%主要字段描述：
cluster：集群名称 status：集群状态 node.total：集群中的节点数 node.data：集群中的数据节点数 shards：集群中总的分片数量 pri：主分片数量，英文全称为 private relo：复制分片总数 unassign：未指定的分片数量，是应有分片数和现有的分片数的差值（包括主分片和复制分片） 集群共有 green 、yellow 、 red 三种状态：
green 代表一切正常，集群功能齐全 yellow 代表所有数据都是可用的，但是某些复制没有被分配（集群功能齐全） red 代表因为某些原因，某些数据不可用。如果是red状态，数据很有可能已经丢失 可以在请求中添加 help 参数来查看每个操作返回结果字段的描述
GET _cat/health?helpepoch | t,time | seconds since 1970-01-01 00:00:00 timestamp | ts,hms,hhmmss | time in HH:MM:SS cluster | cl | cluster name status | st | health status node.total | nt,nodeTotal | total number of nodes node.data | nd,nodeData | number of nodes that can store data shards | t,sh,shards.total,shardsTotal | total number of shards pri | p,shards.primary,shardsPrimary | number of primary shards relo | r,shards.relocating,shardsRelocating | number of relocating nodes init | i,shards.initializing,shardsInitializing | number of initializing nodes unassign | u,shards.unassigned,shardsUnassigned | number of unassigned shards pending_tasks | pt,pendingTasks | number of pending tasks max_task_wait_time | mtwt,maxTaskWaitTime | wait time of longest task pending active_shards_percent | asp,activeShardsPercent | active number of shards in percent ES中许多API都可以添加 help 参数来显示字段含义，如果觉得返回的东西太多看着烦，也可以人为指定返回的字段，比如：">
  <meta property="og:locale" content="zh_cn">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">


  <meta itemprop="name" content="CODE&#39;NOTE">
  <meta itemprop="description" content="之前说到 ES 提供了 RESTful 风格的接口以便于我们操作，需要借助能够发送HTTP请求的工具调用这些API，工具是可以任意的，包括网页浏览器，当然也可以使用比如 Postman / Talend API tester等工具。这里为了学习 ElK 所以选择使用 Kibana，关于 Kibana 如何安装参考其他文章。
集群相关# 查看集群健康信息# GET _cat/health?vepoch timestamp cluster status node.total node.data shards pri relo init unassign pending_tasks max_task_wait_time active_shards_percent 1646502528 17:48:48 elasticsearch green 1 1 3 3 0 0 0 0 - 100.0%主要字段描述：
cluster：集群名称 status：集群状态 node.total：集群中的节点数 node.data：集群中的数据节点数 shards：集群中总的分片数量 pri：主分片数量，英文全称为 private relo：复制分片总数 unassign：未指定的分片数量，是应有分片数和现有的分片数的差值（包括主分片和复制分片） 集群共有 green 、yellow 、 red 三种状态：
green 代表一切正常，集群功能齐全 yellow 代表所有数据都是可用的，但是某些复制没有被分配（集群功能齐全） red 代表因为某些原因，某些数据不可用。如果是red状态，数据很有可能已经丢失 可以在请求中添加 help 参数来查看每个操作返回结果字段的描述
GET _cat/health?helpepoch | t,time | seconds since 1970-01-01 00:00:00 timestamp | ts,hms,hhmmss | time in HH:MM:SS cluster | cl | cluster name status | st | health status node.total | nt,nodeTotal | total number of nodes node.data | nd,nodeData | number of nodes that can store data shards | t,sh,shards.total,shardsTotal | total number of shards pri | p,shards.primary,shardsPrimary | number of primary shards relo | r,shards.relocating,shardsRelocating | number of relocating nodes init | i,shards.initializing,shardsInitializing | number of initializing nodes unassign | u,shards.unassigned,shardsUnassigned | number of unassigned shards pending_tasks | pt,pendingTasks | number of pending tasks max_task_wait_time | mtwt,maxTaskWaitTime | wait time of longest task pending active_shards_percent | asp,activeShardsPercent | active number of shards in percent ES中许多API都可以添加 help 参数来显示字段含义，如果觉得返回的东西太多看着烦，也可以人为指定返回的字段，比如：">
  <meta itemprop="wordCount" content="468">

<title>1.3使用 Kibana操作 Es | CODE&#39;NOTE</title>
<link rel="icon" href="/favicon.png" >
<link rel="manifest" href="/manifest.json">
<link rel="canonical" href="http://localhost:1313/posts/elk/1.3%E4%BD%BF%E7%94%A8kibana%E6%93%8D%E4%BD%9Ces/">
<link rel="stylesheet" href="/book.min.6970156cec683193d93c9c4edaf0d56574e4361df2e0c1be4f697ae81c3ba55f.css" integrity="sha256-aXAVbOxoMZPZPJxO2vDVZXTkNh3y4MG&#43;T2l66Bw7pV8=" crossorigin="anonymous">


  <script defer src="/fuse.min.js"></script>
  <script defer src="/en.search.min.3ed9c79c605914c45e19db90edfda0ca8d87c63064c1d6252862250c4e917346.js" integrity="sha256-PtnHnGBZFMReGduQ7f2gyo2HxjBkwdYlKGIlDE6Rc0Y=" crossorigin="anonymous"></script>



  
</head>
<body dir="ltr" class="book-kind-page book-type-posts">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    
<aside class="book-menu">
  <div class="book-menu-content">
    
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/"><span>CODE&#39;NOTE</span>
  </a>
</h2>


<div class="book-search hidden">
  <input id="book-search-input" type="text" 
    placeholder="Search"
    aria-label="Search"
    maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>
<script>document.querySelector(".book-search").classList.remove("hidden")</script>
























</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>



  </div>
</aside>
 

    <div class="book-page">
      <header class="book-header hidden">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/icons/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <h3>1.3使用 Kibana操作 Es</h3>

  <label for="toc-control">
    
    <img src="/icons/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden">
    
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#查看集群健康信息">查看集群健康信息</a></li>
    <li><a href="#查看集群中节点信息">查看集群中节点信息</a></li>
    <li><a href="#查看集群中索引信息">查看集群中索引信息</a></li>
  </ul>

  <ul>
    <li><a href="#创建索引">创建索引</a></li>
    <li><a href="#查看索引">查看索引</a></li>
    <li><a href="#删除索引">删除索引</a></li>
    <li><a href="#查看某字母开头的索引">查看某字母开头的索引</a></li>
    <li><a href="#查询所有索引">查询所有索引</a></li>
    <li><a href="#mappings--settings">mappings / settings</a>
      <ul>
        <li><a href="#创建索引时指定-map">创建索引时指定 map</a></li>
        <li><a href="#创建索引后指定-map">创建索引后指定 map</a></li>
        <li><a href="#创建索引时同时指定">创建索引时同时指定</a></li>
        <li><a href="#修改副本数量">修改副本数量</a></li>
        <li><a href="#修改分片数量">修改分片数量</a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li><a href="#语法">语法</a></li>
    <li><a href="#实例">实例</a></li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
<article class="markdown book-post">
  <h1>
    1.3使用 Kibana操作 Es
  </h1>
  


  

  


  <div class="book-post-content markdown-inner"><p>之前说到 ES 提供了 <code>RESTful</code> 风格的接口以便于我们操作，需要借助能够发送HTTP请求的工具调用这些API，工具是可以任意的，包括网页浏览器，当然也可以使用比如 <code>Postman</code> / <code>Talend API tester</code>等工具。这里为了学习 <code>ElK</code> 所以选择使用  <code>Kibana</code>，关于 <code>Kibana</code> 如何安装参考其他文章。</p>
<!-- more -->
<h1 id="集群相关">集群相关<a class="anchor" href="#%e9%9b%86%e7%be%a4%e7%9b%b8%e5%85%b3">#</a></h1>
<h2 id="查看集群健康信息">查看集群健康信息<a class="anchor" href="#%e6%9f%a5%e7%9c%8b%e9%9b%86%e7%be%a4%e5%81%a5%e5%ba%b7%e4%bf%a1%e6%81%af">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>GET _cat/health?v</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>epoch      timestamp cluster       status node.total node.data shards pri relo init unassign pending_tasks max_task_wait_time active_shards_percent
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1646502528</span> 17:48:48  elasticsearch green           <span style="color:#ae81ff">1</span>         <span style="color:#ae81ff">1</span>      <span style="color:#ae81ff">3</span>   <span style="color:#ae81ff">3</span>    <span style="color:#ae81ff">0</span>    <span style="color:#ae81ff">0</span>        <span style="color:#ae81ff">0</span>             <span style="color:#ae81ff">0</span>                  -                100.0%</span></span></code></pre></div><p>主要字段描述：</p>
<ul>
<li><code>cluster</code>：集群名称</li>
<li><code>status</code>：集群状态</li>
<li><code>node.total</code>：集群中的节点数</li>
<li><code>node.data</code>：集群中的数据节点数</li>
<li><code>shards</code>：集群中总的分片数量</li>
<li><code>pri</code>：主分片数量，英文全称为 <code>private</code></li>
<li><code>relo</code>：复制分片总数</li>
<li><code>unassign</code>：未指定的分片数量，是应有分片数和现有的分片数的差值（包括主分片和复制分片）</li>
</ul>
<p>集群共有 <code>green</code> 、<code>yellow</code> 、 <code>red</code> 三种状态：</p>
<ul>
<li><code>green</code> 代表一切正常，集群功能齐全</li>
<li><code>yellow</code> 代表所有数据都是可用的，但是某些复制没有被分配（集群功能齐全）</li>
<li><code>red</code> 代表因为某些原因，某些数据不可用。如果是red状态，数据很有可能已经丢失</li>
</ul>
<p>可以在请求中添加 <code>help</code> 参数来查看每个操作返回结果字段的描述</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>GET _cat/health?help</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>epoch                 | t,time                                   | seconds since 1970-01-01 00:00:00  
</span></span><span style="display:flex;"><span>timestamp             | ts,hms,hhmmss                            | time in HH:MM:SS                   
</span></span><span style="display:flex;"><span>cluster               | cl                                       | cluster name                       
</span></span><span style="display:flex;"><span>status                | st                                       | health status                      
</span></span><span style="display:flex;"><span>node.total            | nt,nodeTotal                             | total number of nodes              
</span></span><span style="display:flex;"><span>node.data             | nd,nodeData                              | number of nodes that can store data
</span></span><span style="display:flex;"><span>shards                | t,sh,shards.total,shardsTotal            | total number of shards             
</span></span><span style="display:flex;"><span>pri                   | p,shards.primary,shardsPrimary           | number of primary shards           
</span></span><span style="display:flex;"><span>relo                  | r,shards.relocating,shardsRelocating     | number of relocating nodes         
</span></span><span style="display:flex;"><span>init                  | i,shards.initializing,shardsInitializing | number of initializing nodes       
</span></span><span style="display:flex;"><span>unassign              | u,shards.unassigned,shardsUnassigned     | number of unassigned shards        
</span></span><span style="display:flex;"><span>pending_tasks         | pt,pendingTasks                          | number of pending tasks            
</span></span><span style="display:flex;"><span>max_task_wait_time    | mtwt,maxTaskWaitTime                     | wait time of longest task pending  
</span></span><span style="display:flex;"><span>active_shards_percent | asp,activeShardsPercent                  | active number of shards in percent </span></span></code></pre></div><p>ES中许多API都可以添加 <code>help</code> 参数来显示字段含义，如果觉得返回的东西太多看着烦，也可以人为指定返回的字段，比如：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>GET _cat/health?h<span style="color:#f92672">=</span>cluster,status&amp;v</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cluster       status
</span></span><span style="display:flex;"><span>elasticsearch green</span></span></code></pre></div><h2 id="查看集群中节点信息">查看集群中节点信息<a class="anchor" href="#%e6%9f%a5%e7%9c%8b%e9%9b%86%e7%be%a4%e4%b8%ad%e8%8a%82%e7%82%b9%e4%bf%a1%e6%81%af">#</a></h2>
<pre tabindex="0"><code>GET _cat/nodes?v</code></pre><pre tabindex="0"><code>ip        heap.percent ram.percent cpu load_1m load_5m load_15m node.role master name
127.0.0.1           28          59  11                          dilm      *      WANGPENGLIANG</code></pre><h2 id="查看集群中索引信息">查看集群中索引信息<a class="anchor" href="#%e6%9f%a5%e7%9c%8b%e9%9b%86%e7%be%a4%e4%b8%ad%e7%b4%a2%e5%bc%95%e4%bf%a1%e6%81%af">#</a></h2>
<pre tabindex="0"><code>GET _cat/indices?v</code></pre><pre tabindex="0"><code>health status index                    uuid                   pri rep docs.count docs.deleted store.size pri.store.size
green  open   .kibana_task_manager_1   BT3RImw0S9mVrEwQaKIc1Q   1   0          2            0     41.3kb         41.3kb
green  open   .apm-agent-configuration 82PMto3PSt2UsRf7qYmfJg   1   0          0            0       283b           283b
green  open   .kibana_1                xSc4xPL6TXica1mIT8005A   1   0         12            6     60.4kb         60.4kb</code></pre><p>更多的查看和监视 <code>ElastaticSearch</code> 的API查看：<a href="http://www.elastic.co/guide/en/elasticsearch/reference/current/cat.html">官网文档</a></p>
<h1 id="索引相关index">索引相关（Index）<a class="anchor" href="#%e7%b4%a2%e5%bc%95%e7%9b%b8%e5%85%b3index">#</a></h1>
<h2 id="创建索引">创建索引<a class="anchor" href="#%e5%88%9b%e5%bb%ba%e7%b4%a2%e5%bc%95">#</a></h2>
<p>创建名为 <code>movies</code> 的 <code>index</code> ，两种写法等同，名字不能包含特殊字符，只能小写，不能以<code>-</code> , <code>_</code> , <code>+</code> 开头，不能超过255字节。</p>
<p>第一种方式：</p>
<pre tabindex="0"><code>PUT movies</code></pre><p>第二种方式：本质是 <code>PUT http://ip:9200/test</code>，kibana 做了优化因此写不写之前的 <code>/</code> 都可以</p>
<pre tabindex="0"><code>PUT /movies</code></pre><p>第三种方式：当向一个不存在的索引写入文档时，索引会自动被创建</p>
<pre tabindex="0"><code>PUT movies/_doc/1
{
  &#34;name&#34;:&#34;大话西游&#34;
}</code></pre><h2 id="查看索引">查看索引<a class="anchor" href="#%e6%9f%a5%e7%9c%8b%e7%b4%a2%e5%bc%95">#</a></h2>
<p>如果试图访问一个不存在的索引会报错。</p>
<pre tabindex="0"><code>GET movies</code></pre><h2 id="删除索引">删除索引<a class="anchor" href="#%e5%88%a0%e9%99%a4%e7%b4%a2%e5%bc%95">#</a></h2>
<p>如果试图删除一个不存在的索引会报错。</p>
<pre tabindex="0"><code>DELETE movies</code></pre><h2 id="查看某字母开头的索引">查看某字母开头的索引<a class="anchor" href="#%e6%9f%a5%e7%9c%8b%e6%9f%90%e5%ad%97%e6%af%8d%e5%bc%80%e5%a4%b4%e7%9a%84%e7%b4%a2%e5%bc%95">#</a></h2>
<pre tabindex="0"><code>GET _cat/indices/m*?v</code></pre><h2 id="查询所有索引">查询所有索引<a class="anchor" href="#%e6%9f%a5%e8%af%a2%e6%89%80%e6%9c%89%e7%b4%a2%e5%bc%95">#</a></h2>
<pre tabindex="0"><code>GET _cat/indices</code></pre><h2 id="mappings--settings">mappings / settings<a class="anchor" href="#mappings--settings">#</a></h2>
<h3 id="创建索引时指定-map">创建索引时指定 map<a class="anchor" href="#%e5%88%9b%e5%bb%ba%e7%b4%a2%e5%bc%95%e6%97%b6%e6%8c%87%e5%ae%9a-map">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-plain" data-lang="plain"><span style="display:flex;"><span>PUT movies
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  &#34;mappings&#34; : {
</span></span><span style="display:flex;"><span>    &#34;properties&#34; : {
</span></span><span style="display:flex;"><span>      &#34;name&#34; : {
</span></span><span style="display:flex;"><span>        &#34;type&#34; : &#34;keyword&#34;
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><h3 id="创建索引后指定-map">创建索引后指定 map<a class="anchor" href="#%e5%88%9b%e5%bb%ba%e7%b4%a2%e5%bc%95%e5%90%8e%e6%8c%87%e5%ae%9a-map">#</a></h3>
<pre tabindex="0"><code>PUT movies</code></pre><pre tabindex="0"><code>PUT movies/_mapping
{
    &#34;properties&#34; : {
      &#34;name&#34; : {
        &#34;type&#34; : &#34;keyword&#34;
      }
    }
}</code></pre><h3 id="创建索引时同时指定">创建索引时同时指定<a class="anchor" href="#%e5%88%9b%e5%bb%ba%e7%b4%a2%e5%bc%95%e6%97%b6%e5%90%8c%e6%97%b6%e6%8c%87%e5%ae%9a">#</a></h3>
<p>创建索引时指定分片数和副本数。</p>
<pre tabindex="0"><code>PUT movies
{
  &#34;mappings&#34; : {
    &#34;properties&#34; : {
      &#34;name&#34; : {
        &#34;type&#34; : &#34;keyword&#34;
      }
    }
  },
  &#34;settings&#34; : {
    &#34;index&#34; : {
      &#34;number_of_shards&#34; : 1,
      &#34;number_of_replicas&#34; : 2
    }
  }
}</code></pre><h3 id="修改副本数量">修改副本数量<a class="anchor" href="#%e4%bf%ae%e6%94%b9%e5%89%af%e6%9c%ac%e6%95%b0%e9%87%8f">#</a></h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span><span style="color:#960050;background-color:#1e0010">PUT</span> <span style="color:#960050;background-color:#1e0010">movie/_settings</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">&#34;index&#34;</span> : {
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">&#34;number_of_replicas&#34;</span> : <span style="color:#ae81ff">3</span>
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><h3 id="修改分片数量">修改分片数量<a class="anchor" href="#%e4%bf%ae%e6%94%b9%e5%88%86%e7%89%87%e6%95%b0%e9%87%8f">#</a></h3>
<p>分片数量必须在索引创建时指定，创建后无法修改。尝试修改时会报错：</p>
<pre tabindex="0"><code># 请求
PUT movie/_settings
{
  &#34;index&#34; : {
    &#34;number_of_shards&#34; : 3
  }
}

# 响应
{
  &#34;error&#34;: {
    &#34;root_cause&#34;: [
      {
        &#34;type&#34;: &#34;illegal_argument_exception&#34;,
        &#34;reason&#34;: &#34;Can&#39;t update non dynamic settings [[index.number_of_shards]] for open indices [[movie/BPnIxSCwTvWNtze-4gDJaw]]&#34;
      }
    ],
    &#34;type&#34;: &#34;illegal_argument_exception&#34;,
    &#34;reason&#34;: &#34;Can&#39;t update non dynamic settings [[index.number_of_shards]] for open indices [[movie/BPnIxSCwTvWNtze-4gDJaw]]&#34;
  },
  &#34;status&#34;: 400
}</code></pre><h1 id="数据相关">数据相关<a class="anchor" href="#%e6%95%b0%e6%8d%ae%e7%9b%b8%e5%85%b3">#</a></h1>
<h2 id="语法">语法<a class="anchor" href="#%e8%af%ad%e6%b3%95">#</a></h2>
<p>添加</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>  *****************添加*************************
</span></span><span style="display:flex;"><span>  // 如果不传id, 则系统自动生成一个UUID
</span></span><span style="display:flex;"><span>  POST /index/type/
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>  	<span style="color:#e6db74">&#34;属性名&#34;</span>:修改值
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># 或者</span>
</span></span><span style="display:flex;"><span>  POST /index/type/id
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>  	<span style="color:#e6db74">&#34;属性名&#34;</span>:修改值
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>  *****************修改*************************
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># 没有带上的属性会被清除</span>
</span></span><span style="display:flex;"><span>  POST /index/type/id
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>  	<span style="color:#e6db74">&#34;属性名&#34;</span>:修改值
</span></span><span style="display:flex;"><span>  <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>  *****************查询*************************
</span></span><span style="display:flex;"><span>  GET /index/type/id  
</span></span><span style="display:flex;"><span>  *****************删除*************************
</span></span><span style="display:flex;"><span>  <span style="color:#75715e"># 只是逻辑删除, 将其标记为 `delete` ，数据越来越多时, ES会自动物理删除</span>
</span></span><span style="display:flex;"><span>  DELETE /index/type/id</span></span></code></pre></div><h2 id="实例">实例<a class="anchor" href="#%e5%ae%9e%e4%be%8b">#</a></h2>
</div>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">
  <div>
  
    <a href="/posts/elk/1.2elastaticsearch%E9%85%8D%E7%BD%AE/" class="flex align-center">
      <img src="/icons/backward.svg" class="book-icon" alt="Backward" />
      <span>1.2 Elastatic Search配置</span>
    </a>
  
  </div>
  <div>
  
    <a href="/posts/go/01%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/" class="flex align-center">
      <span>01开发环境搭建</span>
      <img src="/icons/forward.svg" class="book-icon" alt="Forward" />
    </a>
  
  </div>
</div>
 
        
  
 
        
        
  
 
        
  
  
    <script>(function(){document.querySelectorAll("pre:has(code)").forEach(e=>{e.addEventListener("click",e.focus),e.addEventListener("copy",function(t){if(t.preventDefault(),navigator.clipboard){const t=window.getSelection().toString()||e.textContent;navigator.clipboard.writeText(t)}})})})()</script>
  

      </footer>

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
  
  <aside class="book-toc">
    <div class="book-toc-content">
      
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#查看集群健康信息">查看集群健康信息</a></li>
    <li><a href="#查看集群中节点信息">查看集群中节点信息</a></li>
    <li><a href="#查看集群中索引信息">查看集群中索引信息</a></li>
  </ul>

  <ul>
    <li><a href="#创建索引">创建索引</a></li>
    <li><a href="#查看索引">查看索引</a></li>
    <li><a href="#删除索引">删除索引</a></li>
    <li><a href="#查看某字母开头的索引">查看某字母开头的索引</a></li>
    <li><a href="#查询所有索引">查询所有索引</a></li>
    <li><a href="#mappings--settings">mappings / settings</a>
      <ul>
        <li><a href="#创建索引时指定-map">创建索引时指定 map</a></li>
        <li><a href="#创建索引后指定-map">创建索引后指定 map</a></li>
        <li><a href="#创建索引时同时指定">创建索引时同时指定</a></li>
        <li><a href="#修改副本数量">修改副本数量</a></li>
        <li><a href="#修改分片数量">修改分片数量</a></li>
      </ul>
    </li>
  </ul>

  <ul>
    <li><a href="#语法">语法</a></li>
    <li><a href="#实例">实例</a></li>
  </ul>
</nav>



    </div>
  </aside>
  
 
  </main>

  
</body>
</html>





















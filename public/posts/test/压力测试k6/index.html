<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="k6 是GitHub上提供的开源负载测试工具，使用Go编写。测试脚本使用JavaScript编写。
先决条件# 安装K6 https://k6.io/docs/getting-started/installation 环境变量配置；cd 到压测脚本目录 概念# vu：虚拟用户 duration:持续时长 入门# import http from &#39;k6/http&#39;; import { sleep } from &#39;k6&#39;; export default function() { http.get(&#39;http://localhost:5000/api/values&#39;); }k6 run ValuesApiK6.js多Vu和指定时长# k6 run --vus 10 --duration 10s ValuesApiK6.js使用配置选项# import http from &#34;k6/http&#34;; import { sleep,check } from &#34;k6&#34;; export let options = { vus: 10, duration: &#39;10s&#39;, }; // 脚本至少必须包含一个default函数,这定义了VU的入口点，类似于许多其他语言中的main()函数 export default function() { let res = http.get(&#34;http://localhost:5000/api/values&#34;); check(res, { &#39;status was 200&#39;: r =&gt; r.status == 200 }); sleep(1); }阶段负载# import http from &#34;k6/http&#34;; import { sleep, check } from &#34;k6&#34;; export let options = { // 阶段负载 stages: [ { duration: &#34;3s&#34;, target: 2 }, { duration: &#34;5s&#34;, target: 3 }, { duration: &#34;6s&#34;, target: 10 }, ], }; // 脚本至少必须包含一个default函数,这定义了VU的入口点，类似于许多其他语言中的main()函数 export default function () { let res = http.get(&#34;http://localhost:5000/api/values&#34;); check(res, { &#34;status was 200&#34;: (r) =&gt; r.status == 200 }); sleep(1); }可能出现的异常：using multiple execution config shortcuts (durationandstages) simultaneously is not allowed 不允许同时使用多个执行配置快捷方式(“duration”和“stages”)。
">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="#ffffff">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="#343a40">
<meta name="color-scheme" content="light dark"><meta property="og:url" content="http://localhost:1313/posts/test/%E5%8E%8B%E5%8A%9B%E6%B5%8B%E8%AF%95k6/">
  <meta property="og:site_name" content="CODE&#39;NOTE">
  <meta property="og:title" content="CODE&#39;NOTE">
  <meta property="og:description" content="k6 是GitHub上提供的开源负载测试工具，使用Go编写。测试脚本使用JavaScript编写。
先决条件# 安装K6 https://k6.io/docs/getting-started/installation 环境变量配置；cd 到压测脚本目录 概念# vu：虚拟用户 duration:持续时长 入门# import http from &#39;k6/http&#39;; import { sleep } from &#39;k6&#39;; export default function() { http.get(&#39;http://localhost:5000/api/values&#39;); }k6 run ValuesApiK6.js多Vu和指定时长# k6 run --vus 10 --duration 10s ValuesApiK6.js使用配置选项# import http from &#34;k6/http&#34;; import { sleep,check } from &#34;k6&#34;; export let options = { vus: 10, duration: &#39;10s&#39;, }; // 脚本至少必须包含一个default函数,这定义了VU的入口点，类似于许多其他语言中的main()函数 export default function() { let res = http.get(&#34;http://localhost:5000/api/values&#34;); check(res, { &#39;status was 200&#39;: r =&gt; r.status == 200 }); sleep(1); }阶段负载# import http from &#34;k6/http&#34;; import { sleep, check } from &#34;k6&#34;; export let options = { // 阶段负载 stages: [ { duration: &#34;3s&#34;, target: 2 }, { duration: &#34;5s&#34;, target: 3 }, { duration: &#34;6s&#34;, target: 10 }, ], }; // 脚本至少必须包含一个default函数,这定义了VU的入口点，类似于许多其他语言中的main()函数 export default function () { let res = http.get(&#34;http://localhost:5000/api/values&#34;); check(res, { &#34;status was 200&#34;: (r) =&gt; r.status == 200 }); sleep(1); }可能出现的异常：using multiple execution config shortcuts (durationandstages) simultaneously is not allowed 不允许同时使用多个执行配置快捷方式(“duration”和“stages”)。">
  <meta property="og:locale" content="zh_cn">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">


  <meta itemprop="name" content="CODE&#39;NOTE">
  <meta itemprop="description" content="k6 是GitHub上提供的开源负载测试工具，使用Go编写。测试脚本使用JavaScript编写。
先决条件# 安装K6 https://k6.io/docs/getting-started/installation 环境变量配置；cd 到压测脚本目录 概念# vu：虚拟用户 duration:持续时长 入门# import http from &#39;k6/http&#39;; import { sleep } from &#39;k6&#39;; export default function() { http.get(&#39;http://localhost:5000/api/values&#39;); }k6 run ValuesApiK6.js多Vu和指定时长# k6 run --vus 10 --duration 10s ValuesApiK6.js使用配置选项# import http from &#34;k6/http&#34;; import { sleep,check } from &#34;k6&#34;; export let options = { vus: 10, duration: &#39;10s&#39;, }; // 脚本至少必须包含一个default函数,这定义了VU的入口点，类似于许多其他语言中的main()函数 export default function() { let res = http.get(&#34;http://localhost:5000/api/values&#34;); check(res, { &#39;status was 200&#39;: r =&gt; r.status == 200 }); sleep(1); }阶段负载# import http from &#34;k6/http&#34;; import { sleep, check } from &#34;k6&#34;; export let options = { // 阶段负载 stages: [ { duration: &#34;3s&#34;, target: 2 }, { duration: &#34;5s&#34;, target: 3 }, { duration: &#34;6s&#34;, target: 10 }, ], }; // 脚本至少必须包含一个default函数,这定义了VU的入口点，类似于许多其他语言中的main()函数 export default function () { let res = http.get(&#34;http://localhost:5000/api/values&#34;); check(res, { &#34;status was 200&#34;: (r) =&gt; r.status == 200 }); sleep(1); }可能出现的异常：using multiple execution config shortcuts (durationandstages) simultaneously is not allowed 不允许同时使用多个执行配置快捷方式(“duration”和“stages”)。">
  <meta itemprop="wordCount" content="373">

<title>压力测试k6 | CODE&#39;NOTE</title>
<link rel="icon" href="/favicon.png" >
<link rel="manifest" href="/manifest.json">
<link rel="canonical" href="http://localhost:1313/posts/test/%E5%8E%8B%E5%8A%9B%E6%B5%8B%E8%AF%95k6/">
<link rel="stylesheet" href="/book.min.6970156cec683193d93c9c4edaf0d56574e4361df2e0c1be4f697ae81c3ba55f.css" integrity="sha256-aXAVbOxoMZPZPJxO2vDVZXTkNh3y4MG&#43;T2l66Bw7pV8=" crossorigin="anonymous">


  <script defer src="/fuse.min.js"></script>
  <script defer src="/en.search.min.3ed9c79c605914c45e19db90edfda0ca8d87c63064c1d6252862250c4e917346.js" integrity="sha256-PtnHnGBZFMReGduQ7f2gyo2HxjBkwdYlKGIlDE6Rc0Y=" crossorigin="anonymous"></script>



  
</head>
<body dir="ltr" class="book-kind-page book-type-posts">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    
<aside class="book-menu">
  <div class="book-menu-content">
    
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/"><span>CODE&#39;NOTE</span>
  </a>
</h2>


<div class="book-search hidden">
  <input id="book-search-input" type="text" 
    placeholder="Search"
    aria-label="Search"
    maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>
<script>document.querySelector(".book-search").classList.remove("hidden")</script>
























</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>



  </div>
</aside>
 

    <div class="book-page">
      <header class="book-header hidden">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/icons/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <h3>压力测试k6</h3>

  <label for="toc-control">
    
  </label>
</div>


  
 
      </header>

      
      
<article class="markdown book-post">
  <h1>
    压力测试k6
  </h1>
  


  

  


  <div class="book-post-content markdown-inner"><p><code>k6</code> 是GitHub上提供的开源负载测试工具，使用Go编写。测试脚本使用JavaScript编写。</p>
<!-- more -->
<h1 id="先决条件">先决条件<a class="anchor" href="#%e5%85%88%e5%86%b3%e6%9d%a1%e4%bb%b6">#</a></h1>
<ul>
<li>安装K6 <a href="https://k6.io/docs/getting-started/installation">https://k6.io/docs/getting-started/installation</a></li>
<li>环境变量配置；<code>cd</code> 到压测脚本目录</li>
</ul>
<h1 id="概念">概念<a class="anchor" href="#%e6%a6%82%e5%bf%b5">#</a></h1>
<ul>
<li>vu：虚拟用户</li>
<li>duration:持续时长</li>
</ul>
<h1 id="入门">入门<a class="anchor" href="#%e5%85%a5%e9%97%a8">#</a></h1>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">import</span> <span style="color:#a6e22e">http</span> <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;k6/http&#39;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">sleep</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#39;k6&#39;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#66d9ef">default</span> <span style="color:#66d9ef">function</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">get</span>(<span style="color:#e6db74">&#39;http://localhost:5000/api/values&#39;</span>);
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>k6 run ValuesApiK6.js</span></span></code></pre></div><h1 id="多vu和指定时长">多Vu和指定时长<a class="anchor" href="#%e5%a4%9avu%e5%92%8c%e6%8c%87%e5%ae%9a%e6%97%b6%e9%95%bf">#</a></h1>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>k6 run --vus <span style="color:#ae81ff">10</span> --duration 10s ValuesApiK6.js</span></span></code></pre></div><h1 id="使用配置选项">使用配置选项<a class="anchor" href="#%e4%bd%bf%e7%94%a8%e9%85%8d%e7%bd%ae%e9%80%89%e9%a1%b9">#</a></h1>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">import</span> <span style="color:#a6e22e">http</span> <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#34;k6/http&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">sleep</span>,<span style="color:#a6e22e">check</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#34;k6&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">options</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">vus</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">10</span>,
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">duration</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#39;10s&#39;</span>,
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// 脚本至少必须包含一个default函数,这定义了VU的入口点，类似于许多其他语言中的main()函数
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">export</span> <span style="color:#66d9ef">default</span> <span style="color:#66d9ef">function</span>() {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">res</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">get</span>(<span style="color:#e6db74">&#34;http://localhost:5000/api/values&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">check</span>(<span style="color:#a6e22e">res</span>, { <span style="color:#e6db74">&#39;status was 200&#39;</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">r</span> =&gt; <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">status</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">200</span> });
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">sleep</span>(<span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><h1 id="阶段负载">阶段负载<a class="anchor" href="#%e9%98%b6%e6%ae%b5%e8%b4%9f%e8%bd%bd">#</a></h1>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#66d9ef">import</span> <span style="color:#a6e22e">http</span> <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#34;k6/http&#34;</span>;
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">import</span> { <span style="color:#a6e22e">sleep</span>, <span style="color:#a6e22e">check</span> } <span style="color:#a6e22e">from</span> <span style="color:#e6db74">&#34;k6&#34;</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">export</span> <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">options</span> <span style="color:#f92672">=</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#75715e">// 阶段负载
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span>  <span style="color:#a6e22e">stages</span><span style="color:#f92672">:</span> [
</span></span><span style="display:flex;"><span>    { <span style="color:#a6e22e">duration</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;3s&#34;</span>, <span style="color:#a6e22e">target</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">2</span> },
</span></span><span style="display:flex;"><span>    { <span style="color:#a6e22e">duration</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;5s&#34;</span>, <span style="color:#a6e22e">target</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">3</span> },
</span></span><span style="display:flex;"><span>    { <span style="color:#a6e22e">duration</span><span style="color:#f92672">:</span> <span style="color:#e6db74">&#34;6s&#34;</span>, <span style="color:#a6e22e">target</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">10</span> },
</span></span><span style="display:flex;"><span>  ],
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e">// 脚本至少必须包含一个default函数,这定义了VU的入口点，类似于许多其他语言中的main()函数
</span></span></span><span style="display:flex;"><span><span style="color:#75715e"></span><span style="color:#66d9ef">export</span> <span style="color:#66d9ef">default</span> <span style="color:#66d9ef">function</span> () {
</span></span><span style="display:flex;"><span>  <span style="color:#66d9ef">let</span> <span style="color:#a6e22e">res</span> <span style="color:#f92672">=</span> <span style="color:#a6e22e">http</span>.<span style="color:#a6e22e">get</span>(<span style="color:#e6db74">&#34;http://localhost:5000/api/values&#34;</span>);
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">check</span>(<span style="color:#a6e22e">res</span>, { <span style="color:#e6db74">&#34;status was 200&#34;</span><span style="color:#f92672">:</span> (<span style="color:#a6e22e">r</span>) =&gt; <span style="color:#a6e22e">r</span>.<span style="color:#a6e22e">status</span> <span style="color:#f92672">==</span> <span style="color:#ae81ff">200</span> });
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">sleep</span>(<span style="color:#ae81ff">1</span>);
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><p>可能出现的异常：<code>using multiple execution config shortcuts (</code>duration<code>and</code>stages<code>) simultaneously is not allowed</code>  不允许同时使用多个执行配置快捷方式(“duration”和“stages”)。</p>
<h1 id="断言">断言<a class="anchor" href="#%e6%96%ad%e8%a8%80">#</a></h1>
<p>需要<code>import { sleep, check } from &quot;k6&quot;;</code> 引入check模块。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>check<span style="color:#f92672">(</span>res, <span style="color:#f92672">{</span> <span style="color:#e6db74">&#34;status was 200&#34;</span>: <span style="color:#f92672">(</span>r<span style="color:#f92672">)</span> <span style="color:#f92672">=</span>&gt; r.status <span style="color:#f92672">==</span> <span style="color:#ae81ff">200</span> <span style="color:#f92672">})</span>;</span></span></code></pre></div><h1 id="测试结果">测试结果<a class="anchor" href="#%e6%b5%8b%e8%af%95%e7%bb%93%e6%9e%9c">#</a></h1>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span> <span style="color:#a6e22e">execution</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">local</span><span style="color:#f92672">-</span>
</span></span><span style="display:flex;"><span>     <span style="color:#a6e22e">script</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">ValuesApiK6</span>.<span style="color:#a6e22e">js</span>
</span></span><span style="display:flex;"><span>     <span style="color:#a6e22e">output</span><span style="color:#f92672">:</span> <span style="color:#f92672">-</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#a6e22e">scenarios</span><span style="color:#f92672">:</span> (<span style="color:#ae81ff">100.00</span><span style="color:#f92672">%</span>) <span style="color:#ae81ff">1</span> <span style="color:#a6e22e">executors</span>, <span style="color:#ae81ff">10</span> <span style="color:#a6e22e">max</span> <span style="color:#a6e22e">VUs</span>, <span style="color:#ae81ff">44</span><span style="color:#a6e22e">s</span> <span style="color:#a6e22e">max</span> <span style="color:#a6e22e">duration</span> (<span style="color:#a6e22e">incl</span>. <span style="color:#a6e22e">graceful</span> <span style="color:#a6e22e">stop</span>)<span style="color:#f92672">:</span>
</span></span><span style="display:flex;"><span>           <span style="color:#f92672">*</span> <span style="color:#66d9ef">default</span><span style="color:#f92672">:</span> <span style="color:#a6e22e">Up</span> <span style="color:#a6e22e">to</span> <span style="color:#ae81ff">10</span> <span style="color:#a6e22e">looping</span> <span style="color:#a6e22e">VUs</span> <span style="color:#66d9ef">for</span> <span style="color:#ae81ff">14</span><span style="color:#a6e22e">s</span> <span style="color:#a6e22e">over</span> <span style="color:#ae81ff">3</span> <span style="color:#a6e22e">stages</span> (<span style="color:#a6e22e">gracefulRampDown</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">30</span><span style="color:#a6e22e">s</span>, <span style="color:#a6e22e">gracefulStop</span><span style="color:#f92672">:</span> <span style="color:#ae81ff">30</span><span style="color:#a6e22e">s</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">I</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">running</span> (<span style="color:#ae81ff">16.0</span><span style="color:#a6e22e">s</span>), <span style="color:#ae81ff">00</span><span style="color:#f92672">/</span><span style="color:#ae81ff">10</span> <span style="color:#a6e22e">VUs</span>, <span style="color:#ae81ff">38</span> <span style="color:#a6e22e">complete</span> <span style="color:#a6e22e">and</span> <span style="color:#ae81ff">0</span> <span style="color:#a6e22e">interrupted</span> <span style="color:#a6e22e">iterations</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">default</span> <span style="color:#960050;background-color:#1e0010">✓</span> [<span style="color:#f92672">======================================</span>] <span style="color:#ae81ff">00</span><span style="color:#f92672">/</span><span style="color:#ae81ff">10</span> <span style="color:#a6e22e">VUs</span>  <span style="color:#ae81ff">14</span><span style="color:#a6e22e">s9</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#960050;background-color:#1e0010">✓</span> <span style="color:#a6e22e">status</span> <span style="color:#a6e22e">was</span> <span style="color:#ae81ff">200</span> 
</span></span><span style="display:flex;"><span> 
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">checks</span>.....................<span style="color:#f92672">:</span> <span style="color:#ae81ff">100.00</span><span style="color:#f92672">%</span> <span style="color:#960050;background-color:#1e0010">✓</span> <span style="color:#ae81ff">38</span>   <span style="color:#960050;background-color:#1e0010">✗</span> <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">data_received</span>..............<span style="color:#f92672">:</span> <span style="color:#ae81ff">176</span> <span style="color:#a6e22e">MB</span>  <span style="color:#ae81ff">11</span> <span style="color:#a6e22e">MB</span><span style="color:#f92672">/</span><span style="color:#a6e22e">s</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">data_sent</span>..................<span style="color:#f92672">:</span> <span style="color:#ae81ff">3.3</span> <span style="color:#a6e22e">kB</span>  <span style="color:#ae81ff">208</span> <span style="color:#a6e22e">B</span><span style="color:#f92672">/</span><span style="color:#a6e22e">s</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">http_req_blocked</span>...........<span style="color:#f92672">:</span> <span style="color:#a6e22e">avg</span><span style="color:#f92672">=</span><span style="color:#ae81ff">79.1</span><span style="color:#a6e22e">µs</span>   <span style="color:#a6e22e">min</span><span style="color:#f92672">=</span><span style="color:#ae81ff">0</span><span style="color:#a6e22e">s</span>       <span style="color:#a6e22e">med</span><span style="color:#f92672">=</span><span style="color:#ae81ff">0</span><span style="color:#a6e22e">s</span>       <span style="color:#a6e22e">max</span><span style="color:#f92672">=</span><span style="color:#ae81ff">2</span><span style="color:#a6e22e">ms</span>     <span style="color:#a6e22e">p</span>(<span style="color:#ae81ff">90</span>)<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span><span style="color:#a6e22e">s</span>      <span style="color:#a6e22e">p</span>(<span style="color:#ae81ff">95</span>)<span style="color:#f92672">=</span><span style="color:#ae81ff">149.71</span><span style="color:#a6e22e">µs</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">http_req_connecting</span>........<span style="color:#f92672">:</span> <span style="color:#a6e22e">avg</span><span style="color:#f92672">=</span><span style="color:#ae81ff">52.85</span><span style="color:#a6e22e">µs</span>  <span style="color:#a6e22e">min</span><span style="color:#f92672">=</span><span style="color:#ae81ff">0</span><span style="color:#a6e22e">s</span>       <span style="color:#a6e22e">med</span><span style="color:#f92672">=</span><span style="color:#ae81ff">0</span><span style="color:#a6e22e">s</span>       <span style="color:#a6e22e">max</span><span style="color:#f92672">=</span><span style="color:#ae81ff">1.01</span><span style="color:#a6e22e">ms</span>  <span style="color:#a6e22e">p</span>(<span style="color:#ae81ff">90</span>)<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span><span style="color:#a6e22e">s</span>      <span style="color:#a6e22e">p</span>(<span style="color:#ae81ff">95</span>)<span style="color:#f92672">=</span><span style="color:#ae81ff">149.71</span><span style="color:#a6e22e">µs</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">http_req_duration</span>..........<span style="color:#f92672">:</span> <span style="color:#a6e22e">avg</span><span style="color:#f92672">=</span><span style="color:#ae81ff">682.14</span><span style="color:#a6e22e">ms</span> <span style="color:#a6e22e">min</span><span style="color:#f92672">=</span><span style="color:#ae81ff">332.4</span><span style="color:#a6e22e">ms</span>  <span style="color:#a6e22e">med</span><span style="color:#f92672">=</span><span style="color:#ae81ff">516.59</span><span style="color:#a6e22e">ms</span> <span style="color:#a6e22e">max</span><span style="color:#f92672">=</span><span style="color:#ae81ff">1.66</span><span style="color:#a6e22e">s</span>   <span style="color:#a6e22e">p</span>(<span style="color:#ae81ff">90</span>)<span style="color:#f92672">=</span><span style="color:#ae81ff">1.22</span><span style="color:#a6e22e">s</span>   <span style="color:#a6e22e">p</span>(<span style="color:#ae81ff">95</span>)<span style="color:#f92672">=</span><span style="color:#ae81ff">1.44</span><span style="color:#a6e22e">s</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">http_req_receiving</span>.........<span style="color:#f92672">:</span> <span style="color:#a6e22e">avg</span><span style="color:#f92672">=</span><span style="color:#ae81ff">10.39</span><span style="color:#a6e22e">ms</span>  <span style="color:#a6e22e">min</span><span style="color:#f92672">=</span><span style="color:#ae81ff">3.98</span><span style="color:#a6e22e">ms</span>   <span style="color:#a6e22e">med</span><span style="color:#f92672">=</span><span style="color:#ae81ff">8.97</span><span style="color:#a6e22e">ms</span>   <span style="color:#a6e22e">max</span><span style="color:#f92672">=</span><span style="color:#ae81ff">37.89</span><span style="color:#a6e22e">ms</span> <span style="color:#a6e22e">p</span>(<span style="color:#ae81ff">90</span>)<span style="color:#f92672">=</span><span style="color:#ae81ff">16.85</span><span style="color:#a6e22e">ms</span> <span style="color:#a6e22e">p</span>(<span style="color:#ae81ff">95</span>)<span style="color:#f92672">=</span><span style="color:#ae81ff">23.37</span><span style="color:#a6e22e">ms</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">http_req_sending</span>...........<span style="color:#f92672">:</span> <span style="color:#a6e22e">avg</span><span style="color:#f92672">=</span><span style="color:#ae81ff">0</span><span style="color:#a6e22e">s</span>       <span style="color:#a6e22e">min</span><span style="color:#f92672">=</span><span style="color:#ae81ff">0</span><span style="color:#a6e22e">s</span>       <span style="color:#a6e22e">med</span><span style="color:#f92672">=</span><span style="color:#ae81ff">0</span><span style="color:#a6e22e">s</span>       <span style="color:#a6e22e">max</span><span style="color:#f92672">=</span><span style="color:#ae81ff">0</span><span style="color:#a6e22e">s</span>      <span style="color:#a6e22e">p</span>(<span style="color:#ae81ff">90</span>)<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span><span style="color:#a6e22e">s</span>      <span style="color:#a6e22e">p</span>(<span style="color:#ae81ff">95</span>)<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span><span style="color:#a6e22e">s</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">http_req_tls_handshaking</span>...<span style="color:#f92672">:</span> <span style="color:#a6e22e">avg</span><span style="color:#f92672">=</span><span style="color:#ae81ff">0</span><span style="color:#a6e22e">s</span>       <span style="color:#a6e22e">min</span><span style="color:#f92672">=</span><span style="color:#ae81ff">0</span><span style="color:#a6e22e">s</span>       <span style="color:#a6e22e">med</span><span style="color:#f92672">=</span><span style="color:#ae81ff">0</span><span style="color:#a6e22e">s</span>       <span style="color:#a6e22e">max</span><span style="color:#f92672">=</span><span style="color:#ae81ff">0</span><span style="color:#a6e22e">s</span>      <span style="color:#a6e22e">p</span>(<span style="color:#ae81ff">90</span>)<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span><span style="color:#a6e22e">s</span>      <span style="color:#a6e22e">p</span>(<span style="color:#ae81ff">95</span>)<span style="color:#f92672">=</span><span style="color:#ae81ff">0</span><span style="color:#a6e22e">s</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">http_req_waiting</span>...........<span style="color:#f92672">:</span> <span style="color:#a6e22e">avg</span><span style="color:#f92672">=</span><span style="color:#ae81ff">671.75</span><span style="color:#a6e22e">ms</span> <span style="color:#a6e22e">min</span><span style="color:#f92672">=</span><span style="color:#ae81ff">323.42</span><span style="color:#a6e22e">ms</span> <span style="color:#a6e22e">med</span><span style="color:#f92672">=</span><span style="color:#ae81ff">508.61</span><span style="color:#a6e22e">ms</span> <span style="color:#a6e22e">max</span><span style="color:#f92672">=</span><span style="color:#ae81ff">1.65</span><span style="color:#a6e22e">s</span>   <span style="color:#a6e22e">p</span>(<span style="color:#ae81ff">90</span>)<span style="color:#f92672">=</span><span style="color:#ae81ff">1.21</span><span style="color:#a6e22e">s</span>   <span style="color:#a6e22e">p</span>(<span style="color:#ae81ff">95</span>)<span style="color:#f92672">=</span><span style="color:#ae81ff">1.43</span><span style="color:#a6e22e">s</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">http_reqs</span>..................<span style="color:#f92672">:</span> <span style="color:#ae81ff">38</span>      <span style="color:#ae81ff">2.374567</span><span style="color:#f92672">/</span><span style="color:#a6e22e">s</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">iteration_duration</span>.........<span style="color:#f92672">:</span> <span style="color:#a6e22e">avg</span><span style="color:#f92672">=</span><span style="color:#ae81ff">1.68</span><span style="color:#a6e22e">s</span>    <span style="color:#a6e22e">min</span><span style="color:#f92672">=</span><span style="color:#ae81ff">1.33</span><span style="color:#a6e22e">s</span>    <span style="color:#a6e22e">med</span><span style="color:#f92672">=</span><span style="color:#ae81ff">1.51</span><span style="color:#a6e22e">s</span>    <span style="color:#a6e22e">max</span><span style="color:#f92672">=</span><span style="color:#ae81ff">2.66</span><span style="color:#a6e22e">s</span>   <span style="color:#a6e22e">p</span>(<span style="color:#ae81ff">90</span>)<span style="color:#f92672">=</span><span style="color:#ae81ff">2.22</span><span style="color:#a6e22e">s</span>   <span style="color:#a6e22e">p</span>(<span style="color:#ae81ff">95</span>)<span style="color:#f92672">=</span><span style="color:#ae81ff">2.44</span><span style="color:#a6e22e">s</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">iterations</span>.................<span style="color:#f92672">:</span> <span style="color:#ae81ff">38</span>      <span style="color:#ae81ff">2.374567</span><span style="color:#f92672">/</span><span style="color:#a6e22e">s</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">vus</span>........................<span style="color:#f92672">:</span> <span style="color:#ae81ff">0</span>       <span style="color:#a6e22e">min</span><span style="color:#f92672">=</span><span style="color:#ae81ff">0</span>  <span style="color:#a6e22e">max</span><span style="color:#f92672">=</span><span style="color:#ae81ff">9</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a6e22e">vus_max</span>....................<span style="color:#f92672">:</span> <span style="color:#ae81ff">10</span>      <span style="color:#a6e22e">min</span><span style="color:#f92672">=</span><span style="color:#ae81ff">10</span> <span style="color:#a6e22e">max</span><span style="color:#f92672">=</span><span style="color:#ae81ff">10</span></span></span></code></pre></div><p>测试细节</p>
<ul>
<li><code>execution </code>k6执行模式（本地或云）</li>
<li><code>output</code> 测试结果的输出。默认值为stdout</li>
<li><code>script: script.js</code> 显示正在执行的脚本的名称</li>
<li><code>duration</code> 测试运行时间</li>
<li><code>iterations</code>  VU 迭代的总数</li>
<li><code>vus</code>  测试将开始运行的VU的初始数量</li>
<li><code>max</code>  测试将扩展的VU的最大数量</li>
</ul>
<p>测试指标分析参考：<a href="https://k6.io/docs/using-k6/metrics">https://k6.io/docs/using-k6/metrics</a></p>
<h1 id="测试结果输出第三方平台">测试结果输出第三方平台<a class="anchor" href="#%e6%b5%8b%e8%af%95%e7%bb%93%e6%9e%9c%e8%be%93%e5%87%ba%e7%ac%ac%e4%b8%89%e6%96%b9%e5%b9%b3%e5%8f%b0">#</a></h1>
<p>参考：<a href="https://k6.io/docs/getting-started/results-output#output-plugins">https://k6.io/docs/getting-started/results-output#output-plugins</a></p>
<h1 id="输出json格式">输出Json格式<a class="anchor" href="#%e8%be%93%e5%87%bajson%e6%a0%bc%e5%bc%8f">#</a></h1>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>k6 run --summary-export<span style="color:#f92672">=</span>export.json test.js</span></span></code></pre></div><h1 id="输出json格式详细信息">输出JSON格式详细信息<a class="anchor" href="#%e8%be%93%e5%87%bajson%e6%a0%bc%e5%bc%8f%e8%af%a6%e7%bb%86%e4%bf%a1%e6%81%af">#</a></h1>
<p>使用 <code>--out/-o</code> 选项使k6输出JSON格式的详细统计信息</p>
<pre tabindex="0"><code>k6 run --out json=my_test_result.json test.js</code></pre><h1 id="tags打标签分组">tags打标签分组<a class="anchor" href="#tags%e6%89%93%e6%a0%87%e7%ad%be%e5%88%86%e7%bb%84">#</a></h1>
<p>参考：<a href="https://k6.io/docs/using-k6/http-requests#url-grouping">https://k6.io/docs/using-k6/http-requests#url-grouping</a></p>
<h1 id="k6内置指标">K6内置指标<a class="anchor" href="#k6%e5%86%85%e7%bd%ae%e6%8c%87%e6%a0%87">#</a></h1>
<p>参考：<a href="https://k6.io/docs/using-k6/metrics#custom-metrics">https://k6.io/docs/using-k6/metrics#custom-metrics</a></p>
<h1 id="http内置指标">HTTP内置指标<a class="anchor" href="#http%e5%86%85%e7%bd%ae%e6%8c%87%e6%a0%87">#</a></h1>
<p>参考：<a href="https://k6.io/docs/using-k6/metrics#metric-types">https://k6.io/docs/using-k6/metrics#metric-types</a></p>
<h1 id="阈值">阈值<a class="anchor" href="#%e9%98%88%e5%80%bc">#</a></h1>
<p>阈值是通过/失败标准，用于指定被测系统的性能期望</p>
<p>预期示例（阈值）：</p>
<ul>
<li>系统产生的错误不超过1％</li>
<li>95％的请求的响应时间应小于200ms</li>
<li>99％的请求的响应时间应低于400毫秒</li>
<li>特定端点必须始终在300毫秒内响应</li>
<li>阈值分析性能指标并确定最终测试结果（通过/失败）。阈值对于负载测试自动化至关重要</li>
</ul>
<p>参考：<a href="https://k6.io/docs/using-k6/thresholds">https://k6.io/docs/using-k6/thresholds</a></p>
<h1 id="分析结果可视化">分析结果可视化<a class="anchor" href="#%e5%88%86%e6%9e%90%e7%bb%93%e6%9e%9c%e5%8f%af%e8%a7%86%e5%8c%96">#</a></h1>
<h1 id="influxdb">influxdb<a class="anchor" href="#influxdb">#</a></h1>
<ol>
<li>安装目录下运行启动 <code>influxdb</code></li>
<li>启动客户端输入命令开始操作 <code>influx</code></li>
<li><code>k6 run --out influxdb=http://localhost:8080/test ValuesApiK6.js</code></li>
</ol>
<h1 id="grafana">Grafana<a class="anchor" href="#grafana">#</a></h1>
<p><img src="/images/2021-09-26-14-43-35.png" alt="" /></p>
</div>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">
  <div>
  
    <a href="/posts/test/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/" class="flex align-center">
      <img src="/icons/backward.svg" class="book-icon" alt="Backward" />
      <span>单元测试</span>
    </a>
  
  </div>
  <div>
  
    <a href="/posts/test/%E8%87%AA%E5%8A%A8%E5%8C%96ui%E6%B5%8B%E8%AF%95/" class="flex align-center">
      <span>自动化 Ui测试</span>
      <img src="/icons/forward.svg" class="book-icon" alt="Forward" />
    </a>
  
  </div>
</div>
 
        
  
 
        
        
  
 
        
  
  
    <script>(function(){document.querySelectorAll("pre:has(code)").forEach(e=>{e.addEventListener("click",e.focus),e.addEventListener("copy",function(t){if(t.preventDefault(),navigator.clipboard){const t=window.getSelection().toString()||e.textContent;navigator.clipboard.writeText(t)}})})})()</script>
  

      </footer>

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
  
 
  </main>

  
</body>
</html>





















<!doctype html><html lang=zh-cn dir=ltr><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Redisé›†ç¾¤# Redisæ”¯æŒä¸‰ç§é›†ç¾¤æ–¹æ¡ˆ
ä¸»ä»å¤åˆ¶ Sentinelï¼ˆå“¨å…µï¼‰ Cluster ä¸»ä»å¤åˆ¶# é€šè¿‡æŒä¹…åŒ–åŠŸèƒ½ï¼ŒRedisä¿è¯äº†å³ä½¿åœ¨æœåŠ¡å™¨é‡å¯çš„æƒ…å†µä¸‹ä¹Ÿä¸ä¼šä¸¢å¤±ï¼ˆæˆ–å°‘é‡ä¸¢å¤±ï¼‰æ•°æ®ï¼Œå› ä¸ºæŒä¹…åŒ–ä¼šæŠŠå†…å­˜ä¸­æ•°æ®ä¿å­˜åˆ°ç¡¬ç›˜ä¸Šï¼Œé‡å¯ä¼šä»ç¡¬ç›˜ä¸ŠåŠ è½½æ•°æ®ã€‚ ä½†æ˜¯ç”±äºæ•°æ®æ˜¯å­˜å‚¨åœ¨ä¸€å°æœåŠ¡å™¨ä¸Šçš„ï¼Œå¦‚æœè¿™å°æœåŠ¡å™¨å‡ºç°ç¡¬ç›˜æ•…éšœç­‰é—®é¢˜ï¼Œä¹Ÿä¼šå¯¼è‡´æ•°æ®ä¸¢å¤±ã€‚ä¸ºäº†é¿å…å•ç‚¹æ•…éšœï¼Œé€šå¸¸çš„åšæ³•æ˜¯å°†æ•°æ®åº“å¤åˆ¶å¤šä¸ªå‰¯æœ¬ä»¥éƒ¨ç½²åœ¨ä¸åŒçš„æœåŠ¡å™¨ä¸Šï¼Œè¿™æ ·å³ä½¿æœ‰ä¸€å°æœåŠ¡å™¨å‡ºç°æ•…éšœï¼Œå…¶ä»–æœåŠ¡å™¨ä¾ç„¶å¯ä»¥ç»§ç»­æä¾›æœåŠ¡ã€‚
ä¸ºæ­¤ï¼š Redis æä¾›äº†å¤åˆ¶ï¼ˆreplicationï¼‰åŠŸèƒ½ï¼Œå¯ä»¥å®ç°å½“ä¸€å°æ•°æ®åº“ä¸­çš„æ•°æ®æ›´æ–°åï¼Œè‡ªåŠ¨å°†æ›´æ–°çš„æ•°æ®åŒæ­¥åˆ°å…¶ä»–æ•°æ®åº“ä¸Šã€‚
åœ¨å¤åˆ¶çš„æ¦‚å¿µä¸­ï¼Œæ•°æ®åº“åˆ†ä¸ºä¸¤ç±»ï¼Œä¸€ç±»æ˜¯ä¸»æ•°æ®åº“ï¼ˆmasterï¼‰ï¼Œå¦ä¸€ç±»æ˜¯ä»æ•°æ®åº“(slaveï¼‰ã€‚ä¸»æ•°æ®åº“å¯ä»¥è¿›è¡Œè¯»å†™æ“ä½œï¼Œå½“å†™æ“ä½œå¯¼è‡´æ•°æ®å˜åŒ–æ—¶ä¼šè‡ªåŠ¨å°†æ•°æ®åŒæ­¥ç»™ä»æ•°æ®åº“ã€‚è€Œä»æ•°æ®åº“ä¸€èˆ¬æ˜¯åªè¯»çš„ï¼Œåªæ¥å—ä¸»æ•°æ®åº“åŒæ­¥è¿‡æ¥çš„æ•°æ®ã€‚ä¸€ä¸ªä¸»æ•°æ®åº“å¯ä»¥æ‹¥æœ‰å¤šä¸ªä»æ•°æ®åº“ï¼Œè€Œä¸€ä¸ªä»æ•°æ®åº“åªèƒ½æ‹¥æœ‰ä¸€ä¸ªä¸»æ•°æ®åº“ã€‚
å®ç°åŸç†# ä»åº“å¯åŠ¨æˆåŠŸåè¿æ¥ä¸»åº“ï¼Œå‘é€ SYNC å‘½ä»¤ ä¸»åº“æ¥æ”¶åˆ° SYNC å‘½ä»¤åï¼Œå¼€å§‹æ‰§è¡Œ BGSAVE å‘½ä»¤ç”Ÿæˆ rdb æ–‡ä»¶å¹¶ä½¿ç”¨ç¼“å†²åŒºè®°å½•æ­¤åæ‰§è¡Œçš„æ‰€æœ‰å†™å‘½ä»¤ ä¸»åº“ BGSAVE æ‰§è¡Œå®Œæ¯•åï¼Œå‘æ‰€æœ‰ä»åº“å‘é€å¿«ç…§æ–‡ä»¶ï¼Œå¹¶åœ¨å‘é€æœŸé—´ç»§ç»­è®°å½•è¢«æ‰§è¡Œçš„å†™å‘½ä»¤ ä»åº“æ”¶åˆ°å¿«ç…§æ–‡ä»¶åä¸¢å¼ƒæ‰€æœ‰æ—§æ•°æ®ï¼Œè½½å…¥æ”¶åˆ°çš„å¿«ç…§ ä¸»åº“å¿«ç…§å‘é€å®Œæ¯•åå¼€å§‹å‘ä»åº“å‘é€ç¼“å†²åŒºä¸­çš„å†™å‘½ä»¤ ä»åº“å®Œæˆå¯¹å¿«ç…§çš„è½½å…¥ï¼Œå¼€å§‹æ¥æ”¶å‘½ä»¤è¯·æ±‚ï¼Œå¹¶æ‰§è¡Œæ¥è‡ªä¸»åº“ç¼“å†²åŒºçš„å†™å‘½ä»¤ï¼ˆè‡³æ­¤ï¼šä»åº“åˆå§‹åŒ–å®Œæˆï¼‰ ä¸»åº“æ¯æ‰§è¡Œä¸€ä¸ªå†™å‘½ä»¤å°±ä¼šå‘ä»åº“å‘é€ç›¸åŒçš„å†™å‘½ä»¤ï¼Œä»åº“æ¥æ”¶å¹¶æ‰§è¡Œæ”¶åˆ°çš„å†™å‘½ä»¤ï¼ˆå¤‡æ³¨ï¼šä»åº“åˆå§‹åŒ–å®Œæˆåçš„æ“ä½œï¼‰ å‡ºç°æ–­å¼€é‡è¿åï¼Œ2.8ä¹‹åçš„ç‰ˆæœ¬ä¼šå°†æ–­çº¿æœŸé—´çš„å‘½ä»¤ä¼ ç»™ä»åº“ã€‚å¢é‡å¤åˆ¶ ä¸»ä»åˆšè¿æ¥æ—¶ï¼šè¿›è¡Œå…¨é‡åŒæ­¥ã€‚å…¨åŒæ­¥ç»“æŸåï¼šè¿›è¡Œå¢é‡åŒæ­¥ã€‚å½“ç„¶å¦‚æœæœ‰éœ€è¦ slave å¯ä»¥åœ¨ä»»ä½•æ—¶å€™éƒ½å¯ä»¥å‘èµ·å…¨é‡åŒæ­¥ã€‚Redis çš„ç­–ç•¥æ˜¯ï¼šæ— è®ºå¦‚ä½•ï¼Œé¦–å…ˆä¼šå°è¯•è¿›è¡Œå¢é‡åŒæ­¥ï¼Œå¦‚ä¸æˆåŠŸï¼Œè¦æ±‚ä»æœºè¿›è¡Œå…¨é‡åŒæ­¥ ä¸»ä»å¤åˆ¶ä¼˜ç¼ºç‚¹# ä¼˜ç‚¹
ä¸»æœºä¼šè‡ªåŠ¨å°†æ•°æ®åŒæ­¥åˆ°ä»æœºï¼Œå¯ä»¥è¿›è¡Œè¯»å†™åˆ†ç¦» ä¸ºäº†åˆ†è½½ master çš„è¯»æ“ä½œå‹åŠ›ï¼Œslave æœåŠ¡å™¨å¯ä»¥ä¸ºå®¢æˆ·ç«¯æä¾›åªè¯»æ“ä½œçš„æœåŠ¡ï¼Œä½†å†™æœåŠ¡ä»å¿…é¡»ç”± master å®Œæˆ slave åŒæ ·å¯ä»¥æ¥å—å…¶å®ƒ slaves çš„è¿æ¥å’ŒåŒæ­¥è¯·æ±‚ï¼Œè¿™æ ·å¯ä»¥æœ‰æ•ˆçš„åˆ†è½½ master çš„åŒæ­¥å‹åŠ› master-server æ˜¯ä»¥éé˜»å¡çš„æ–¹å¼ä¸º slavesæä¾›æœåŠ¡ã€‚æ‰€ä»¥åœ¨ master-slave åŒæ­¥æœŸé—´ï¼Œå®¢æˆ·ç«¯ä»ç„¶å¯ä»¥æäº¤æŸ¥è¯¢æˆ–ä¿®æ”¹è¯·æ±‚ slave-server åŒæ ·æ˜¯ä»¥éé˜»å¡çš„æ–¹å¼å®Œæˆæ•°æ®åŒæ­¥ã€‚åœ¨åŒæ­¥æœŸé—´ï¼Œå¦‚æœæœ‰å®¢æˆ·ç«¯æäº¤æŸ¥è¯¢è¯·æ±‚ï¼Œåˆ™è¿”å›åŒæ­¥ä¹‹å‰çš„æ•°æ® ç¼ºç‚¹
ä¸å…·å¤‡è‡ªåŠ¨å®¹é”™å’Œæ¢å¤åŠŸèƒ½ï¼Œä¸»æœºä»æœºçš„å®•æœºéƒ½ä¼šå¯¼è‡´å‰ç«¯éƒ¨åˆ†è¯»å†™è¯·æ±‚å¤±è´¥ï¼Œéœ€è¦ç­‰å¾…æœºå™¨é‡å¯æˆ–è€…æ‰‹åŠ¨åˆ‡æ¢ IP æ‰èƒ½æ¢å¤ï¼ˆäººå·¥ä»‹å…¥æ–¹å¼ï¼‰ ä¸»æœºå®•æœºï¼Œå®•æœºå‰å¦‚æœ‰éƒ¨åˆ†æ•°æ®æœªèƒ½åŠæ—¶åŒæ­¥åˆ°ä»æœºï¼Œåˆ‡æ¢IPåè¿˜ä¼šå¼•å…¥æ•°æ®ä¸ä¸€è‡´çš„é—®é¢˜ï¼Œé™ä½äº†ç³»ç»Ÿçš„å¯ç”¨æ€§ å¦‚æœå¤šä¸ª slave æ‰çº¿éœ€è¦é‡å¯æ—¶ï¼Œå°½é‡ä¸è¦åœ¨åŒä¸€æ—¶é—´æ®µè¿›è¡Œé‡å¯ã€‚å› ä¸ºåªè¦ slave å¯åŠ¨ï¼Œå°±ä¼šå‘é€sync è¯·æ±‚å’Œä¸»æœºå…¨é‡åŒæ­¥ï¼Œå½“å¤šä¸ª slave é‡å¯æ—¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´ master IO å‰§å¢ä»è€Œå®•æœº è¾ƒéš¾æ”¯æŒåœ¨çº¿æ‰©å®¹ï¼Œåœ¨é›†ç¾¤å®¹é‡è¾¾åˆ°ä¸Šé™æ—¶åœ¨çº¿æ‰©å®¹ä¼šå˜å¾—å¾ˆå¤æ‚ ä¸»ä»å¤åˆ¶æ­å»º# é›†ç¾¤è‡³å°‘éœ€è¦3ä¸ªèŠ‚ç‚¹ï¼Œå› ä¸ºæŠ•ç¥¨å®¹é”™æœºåˆ¶è¦æ±‚è¶…è¿‡åŠæ•°èŠ‚ç‚¹è®¤ä¸ºæŸä¸ªèŠ‚ç‚¹æŒ‚äº†è¯¥èŠ‚ç‚¹æ‰æ˜¯æŒ‚äº†ï¼Œæ‰€ä»¥ä½äº3ä¸ªèŠ‚ç‚¹æ— æ³•æ„æˆé›†ç¾¤ è¦ä¿è¯é›†ç¾¤çš„é«˜å¯ç”¨ï¼Œéœ€è¦æ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰ä»èŠ‚ç‚¹ï¼Œä¹Ÿå°±æ˜¯å¤‡ä»½èŠ‚ç‚¹ã€‚æ‰€ä»¥Redisé›†ç¾¤è‡³å°‘éœ€è¦6å°æœåŠ¡å™¨ã€‚è¿™é‡Œæ¨¡æ‹Ÿæ­å»ºçš„æ˜¯ä¼ªåˆ†å¸ƒå¼é›†ç¾¤ï¼ˆå•æœºå¤šå®ä¾‹ï¼‰ é»˜è®¤æƒ…å†µä¸‹ä¸æŒ‡å®šä¸»æœºçš„è¯ï¼Œæ¯å° Redis éƒ½æ˜¯ä¸»èŠ‚ç‚¹ 1)ï¼šè™šæœºè¿è¡Œ3ä¸ª Redis å®ä¾‹ï¼ˆä¸€ä¸»äºŒä»ï¼‰ï¼Œä¿®æ”¹ç«¯å£å·ä¸ºï¼ˆ79-81ï¼‰ã€‚å¤åˆ¶2ä»½ redis.conf æ¨¡æ‹Ÿ2ä¸ªä»æœºå®ä¾‹
"><meta name=theme-color media="(prefers-color-scheme: light)" content="#ffffff"><meta name=theme-color media="(prefers-color-scheme: dark)" content="#343a40"><meta name=color-scheme content="light dark"><meta property="og:url" content="https://wangpengliang815.github.io/docs/redis/1.9redis%E9%9B%86%E7%BE%A4%E6%96%B9%E6%A1%88/"><meta property="og:site_name" content="CODE'NOTE"><meta property="og:title" content="CODE'NOTE"><meta property="og:description" content="Redisé›†ç¾¤# Redisæ”¯æŒä¸‰ç§é›†ç¾¤æ–¹æ¡ˆ
ä¸»ä»å¤åˆ¶ Sentinelï¼ˆå“¨å…µï¼‰ Cluster ä¸»ä»å¤åˆ¶# é€šè¿‡æŒä¹…åŒ–åŠŸèƒ½ï¼ŒRedisä¿è¯äº†å³ä½¿åœ¨æœåŠ¡å™¨é‡å¯çš„æƒ…å†µä¸‹ä¹Ÿä¸ä¼šä¸¢å¤±ï¼ˆæˆ–å°‘é‡ä¸¢å¤±ï¼‰æ•°æ®ï¼Œå› ä¸ºæŒä¹…åŒ–ä¼šæŠŠå†…å­˜ä¸­æ•°æ®ä¿å­˜åˆ°ç¡¬ç›˜ä¸Šï¼Œé‡å¯ä¼šä»ç¡¬ç›˜ä¸ŠåŠ è½½æ•°æ®ã€‚ ä½†æ˜¯ç”±äºæ•°æ®æ˜¯å­˜å‚¨åœ¨ä¸€å°æœåŠ¡å™¨ä¸Šçš„ï¼Œå¦‚æœè¿™å°æœåŠ¡å™¨å‡ºç°ç¡¬ç›˜æ•…éšœç­‰é—®é¢˜ï¼Œä¹Ÿä¼šå¯¼è‡´æ•°æ®ä¸¢å¤±ã€‚ä¸ºäº†é¿å…å•ç‚¹æ•…éšœï¼Œé€šå¸¸çš„åšæ³•æ˜¯å°†æ•°æ®åº“å¤åˆ¶å¤šä¸ªå‰¯æœ¬ä»¥éƒ¨ç½²åœ¨ä¸åŒçš„æœåŠ¡å™¨ä¸Šï¼Œè¿™æ ·å³ä½¿æœ‰ä¸€å°æœåŠ¡å™¨å‡ºç°æ•…éšœï¼Œå…¶ä»–æœåŠ¡å™¨ä¾ç„¶å¯ä»¥ç»§ç»­æä¾›æœåŠ¡ã€‚
ä¸ºæ­¤ï¼š Redis æä¾›äº†å¤åˆ¶ï¼ˆreplicationï¼‰åŠŸèƒ½ï¼Œå¯ä»¥å®ç°å½“ä¸€å°æ•°æ®åº“ä¸­çš„æ•°æ®æ›´æ–°åï¼Œè‡ªåŠ¨å°†æ›´æ–°çš„æ•°æ®åŒæ­¥åˆ°å…¶ä»–æ•°æ®åº“ä¸Šã€‚
åœ¨å¤åˆ¶çš„æ¦‚å¿µä¸­ï¼Œæ•°æ®åº“åˆ†ä¸ºä¸¤ç±»ï¼Œä¸€ç±»æ˜¯ä¸»æ•°æ®åº“ï¼ˆmasterï¼‰ï¼Œå¦ä¸€ç±»æ˜¯ä»æ•°æ®åº“(slaveï¼‰ã€‚ä¸»æ•°æ®åº“å¯ä»¥è¿›è¡Œè¯»å†™æ“ä½œï¼Œå½“å†™æ“ä½œå¯¼è‡´æ•°æ®å˜åŒ–æ—¶ä¼šè‡ªåŠ¨å°†æ•°æ®åŒæ­¥ç»™ä»æ•°æ®åº“ã€‚è€Œä»æ•°æ®åº“ä¸€èˆ¬æ˜¯åªè¯»çš„ï¼Œåªæ¥å—ä¸»æ•°æ®åº“åŒæ­¥è¿‡æ¥çš„æ•°æ®ã€‚ä¸€ä¸ªä¸»æ•°æ®åº“å¯ä»¥æ‹¥æœ‰å¤šä¸ªä»æ•°æ®åº“ï¼Œè€Œä¸€ä¸ªä»æ•°æ®åº“åªèƒ½æ‹¥æœ‰ä¸€ä¸ªä¸»æ•°æ®åº“ã€‚
å®ç°åŸç†# ä»åº“å¯åŠ¨æˆåŠŸåè¿æ¥ä¸»åº“ï¼Œå‘é€ SYNC å‘½ä»¤ ä¸»åº“æ¥æ”¶åˆ° SYNC å‘½ä»¤åï¼Œå¼€å§‹æ‰§è¡Œ BGSAVE å‘½ä»¤ç”Ÿæˆ rdb æ–‡ä»¶å¹¶ä½¿ç”¨ç¼“å†²åŒºè®°å½•æ­¤åæ‰§è¡Œçš„æ‰€æœ‰å†™å‘½ä»¤ ä¸»åº“ BGSAVE æ‰§è¡Œå®Œæ¯•åï¼Œå‘æ‰€æœ‰ä»åº“å‘é€å¿«ç…§æ–‡ä»¶ï¼Œå¹¶åœ¨å‘é€æœŸé—´ç»§ç»­è®°å½•è¢«æ‰§è¡Œçš„å†™å‘½ä»¤ ä»åº“æ”¶åˆ°å¿«ç…§æ–‡ä»¶åä¸¢å¼ƒæ‰€æœ‰æ—§æ•°æ®ï¼Œè½½å…¥æ”¶åˆ°çš„å¿«ç…§ ä¸»åº“å¿«ç…§å‘é€å®Œæ¯•åå¼€å§‹å‘ä»åº“å‘é€ç¼“å†²åŒºä¸­çš„å†™å‘½ä»¤ ä»åº“å®Œæˆå¯¹å¿«ç…§çš„è½½å…¥ï¼Œå¼€å§‹æ¥æ”¶å‘½ä»¤è¯·æ±‚ï¼Œå¹¶æ‰§è¡Œæ¥è‡ªä¸»åº“ç¼“å†²åŒºçš„å†™å‘½ä»¤ï¼ˆè‡³æ­¤ï¼šä»åº“åˆå§‹åŒ–å®Œæˆï¼‰ ä¸»åº“æ¯æ‰§è¡Œä¸€ä¸ªå†™å‘½ä»¤å°±ä¼šå‘ä»åº“å‘é€ç›¸åŒçš„å†™å‘½ä»¤ï¼Œä»åº“æ¥æ”¶å¹¶æ‰§è¡Œæ”¶åˆ°çš„å†™å‘½ä»¤ï¼ˆå¤‡æ³¨ï¼šä»åº“åˆå§‹åŒ–å®Œæˆåçš„æ“ä½œï¼‰ å‡ºç°æ–­å¼€é‡è¿åï¼Œ2.8ä¹‹åçš„ç‰ˆæœ¬ä¼šå°†æ–­çº¿æœŸé—´çš„å‘½ä»¤ä¼ ç»™ä»åº“ã€‚å¢é‡å¤åˆ¶ ä¸»ä»åˆšè¿æ¥æ—¶ï¼šè¿›è¡Œå…¨é‡åŒæ­¥ã€‚å…¨åŒæ­¥ç»“æŸåï¼šè¿›è¡Œå¢é‡åŒæ­¥ã€‚å½“ç„¶å¦‚æœæœ‰éœ€è¦ slave å¯ä»¥åœ¨ä»»ä½•æ—¶å€™éƒ½å¯ä»¥å‘èµ·å…¨é‡åŒæ­¥ã€‚Redis çš„ç­–ç•¥æ˜¯ï¼šæ— è®ºå¦‚ä½•ï¼Œé¦–å…ˆä¼šå°è¯•è¿›è¡Œå¢é‡åŒæ­¥ï¼Œå¦‚ä¸æˆåŠŸï¼Œè¦æ±‚ä»æœºè¿›è¡Œå…¨é‡åŒæ­¥ ä¸»ä»å¤åˆ¶ä¼˜ç¼ºç‚¹# ä¼˜ç‚¹
ä¸»æœºä¼šè‡ªåŠ¨å°†æ•°æ®åŒæ­¥åˆ°ä»æœºï¼Œå¯ä»¥è¿›è¡Œè¯»å†™åˆ†ç¦» ä¸ºäº†åˆ†è½½ master çš„è¯»æ“ä½œå‹åŠ›ï¼Œslave æœåŠ¡å™¨å¯ä»¥ä¸ºå®¢æˆ·ç«¯æä¾›åªè¯»æ“ä½œçš„æœåŠ¡ï¼Œä½†å†™æœåŠ¡ä»å¿…é¡»ç”± master å®Œæˆ slave åŒæ ·å¯ä»¥æ¥å—å…¶å®ƒ slaves çš„è¿æ¥å’ŒåŒæ­¥è¯·æ±‚ï¼Œè¿™æ ·å¯ä»¥æœ‰æ•ˆçš„åˆ†è½½ master çš„åŒæ­¥å‹åŠ› master-server æ˜¯ä»¥éé˜»å¡çš„æ–¹å¼ä¸º slavesæä¾›æœåŠ¡ã€‚æ‰€ä»¥åœ¨ master-slave åŒæ­¥æœŸé—´ï¼Œå®¢æˆ·ç«¯ä»ç„¶å¯ä»¥æäº¤æŸ¥è¯¢æˆ–ä¿®æ”¹è¯·æ±‚ slave-server åŒæ ·æ˜¯ä»¥éé˜»å¡çš„æ–¹å¼å®Œæˆæ•°æ®åŒæ­¥ã€‚åœ¨åŒæ­¥æœŸé—´ï¼Œå¦‚æœæœ‰å®¢æˆ·ç«¯æäº¤æŸ¥è¯¢è¯·æ±‚ï¼Œåˆ™è¿”å›åŒæ­¥ä¹‹å‰çš„æ•°æ® ç¼ºç‚¹
ä¸å…·å¤‡è‡ªåŠ¨å®¹é”™å’Œæ¢å¤åŠŸèƒ½ï¼Œä¸»æœºä»æœºçš„å®•æœºéƒ½ä¼šå¯¼è‡´å‰ç«¯éƒ¨åˆ†è¯»å†™è¯·æ±‚å¤±è´¥ï¼Œéœ€è¦ç­‰å¾…æœºå™¨é‡å¯æˆ–è€…æ‰‹åŠ¨åˆ‡æ¢ IP æ‰èƒ½æ¢å¤ï¼ˆäººå·¥ä»‹å…¥æ–¹å¼ï¼‰ ä¸»æœºå®•æœºï¼Œå®•æœºå‰å¦‚æœ‰éƒ¨åˆ†æ•°æ®æœªèƒ½åŠæ—¶åŒæ­¥åˆ°ä»æœºï¼Œåˆ‡æ¢IPåè¿˜ä¼šå¼•å…¥æ•°æ®ä¸ä¸€è‡´çš„é—®é¢˜ï¼Œé™ä½äº†ç³»ç»Ÿçš„å¯ç”¨æ€§ å¦‚æœå¤šä¸ª slave æ‰çº¿éœ€è¦é‡å¯æ—¶ï¼Œå°½é‡ä¸è¦åœ¨åŒä¸€æ—¶é—´æ®µè¿›è¡Œé‡å¯ã€‚å› ä¸ºåªè¦ slave å¯åŠ¨ï¼Œå°±ä¼šå‘é€sync è¯·æ±‚å’Œä¸»æœºå…¨é‡åŒæ­¥ï¼Œå½“å¤šä¸ª slave é‡å¯æ—¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´ master IO å‰§å¢ä»è€Œå®•æœº è¾ƒéš¾æ”¯æŒåœ¨çº¿æ‰©å®¹ï¼Œåœ¨é›†ç¾¤å®¹é‡è¾¾åˆ°ä¸Šé™æ—¶åœ¨çº¿æ‰©å®¹ä¼šå˜å¾—å¾ˆå¤æ‚ ä¸»ä»å¤åˆ¶æ­å»º# é›†ç¾¤è‡³å°‘éœ€è¦3ä¸ªèŠ‚ç‚¹ï¼Œå› ä¸ºæŠ•ç¥¨å®¹é”™æœºåˆ¶è¦æ±‚è¶…è¿‡åŠæ•°èŠ‚ç‚¹è®¤ä¸ºæŸä¸ªèŠ‚ç‚¹æŒ‚äº†è¯¥èŠ‚ç‚¹æ‰æ˜¯æŒ‚äº†ï¼Œæ‰€ä»¥ä½äº3ä¸ªèŠ‚ç‚¹æ— æ³•æ„æˆé›†ç¾¤ è¦ä¿è¯é›†ç¾¤çš„é«˜å¯ç”¨ï¼Œéœ€è¦æ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰ä»èŠ‚ç‚¹ï¼Œä¹Ÿå°±æ˜¯å¤‡ä»½èŠ‚ç‚¹ã€‚æ‰€ä»¥Redisé›†ç¾¤è‡³å°‘éœ€è¦6å°æœåŠ¡å™¨ã€‚è¿™é‡Œæ¨¡æ‹Ÿæ­å»ºçš„æ˜¯ä¼ªåˆ†å¸ƒå¼é›†ç¾¤ï¼ˆå•æœºå¤šå®ä¾‹ï¼‰ é»˜è®¤æƒ…å†µä¸‹ä¸æŒ‡å®šä¸»æœºçš„è¯ï¼Œæ¯å° Redis éƒ½æ˜¯ä¸»èŠ‚ç‚¹ 1)ï¼šè™šæœºè¿è¡Œ3ä¸ª Redis å®ä¾‹ï¼ˆä¸€ä¸»äºŒä»ï¼‰ï¼Œä¿®æ”¹ç«¯å£å·ä¸ºï¼ˆ79-81ï¼‰ã€‚å¤åˆ¶2ä»½ redis.conf æ¨¡æ‹Ÿ2ä¸ªä»æœºå®ä¾‹"><meta property="og:locale" content="zh_cn"><meta property="og:type" content="article"><meta property="article:section" content="docs"><meta itemprop=name content="CODE'NOTE"><meta itemprop=description content="Redisé›†ç¾¤# Redisæ”¯æŒä¸‰ç§é›†ç¾¤æ–¹æ¡ˆ
ä¸»ä»å¤åˆ¶ Sentinelï¼ˆå“¨å…µï¼‰ Cluster ä¸»ä»å¤åˆ¶# é€šè¿‡æŒä¹…åŒ–åŠŸèƒ½ï¼ŒRedisä¿è¯äº†å³ä½¿åœ¨æœåŠ¡å™¨é‡å¯çš„æƒ…å†µä¸‹ä¹Ÿä¸ä¼šä¸¢å¤±ï¼ˆæˆ–å°‘é‡ä¸¢å¤±ï¼‰æ•°æ®ï¼Œå› ä¸ºæŒä¹…åŒ–ä¼šæŠŠå†…å­˜ä¸­æ•°æ®ä¿å­˜åˆ°ç¡¬ç›˜ä¸Šï¼Œé‡å¯ä¼šä»ç¡¬ç›˜ä¸ŠåŠ è½½æ•°æ®ã€‚ ä½†æ˜¯ç”±äºæ•°æ®æ˜¯å­˜å‚¨åœ¨ä¸€å°æœåŠ¡å™¨ä¸Šçš„ï¼Œå¦‚æœè¿™å°æœåŠ¡å™¨å‡ºç°ç¡¬ç›˜æ•…éšœç­‰é—®é¢˜ï¼Œä¹Ÿä¼šå¯¼è‡´æ•°æ®ä¸¢å¤±ã€‚ä¸ºäº†é¿å…å•ç‚¹æ•…éšœï¼Œé€šå¸¸çš„åšæ³•æ˜¯å°†æ•°æ®åº“å¤åˆ¶å¤šä¸ªå‰¯æœ¬ä»¥éƒ¨ç½²åœ¨ä¸åŒçš„æœåŠ¡å™¨ä¸Šï¼Œè¿™æ ·å³ä½¿æœ‰ä¸€å°æœåŠ¡å™¨å‡ºç°æ•…éšœï¼Œå…¶ä»–æœåŠ¡å™¨ä¾ç„¶å¯ä»¥ç»§ç»­æä¾›æœåŠ¡ã€‚
ä¸ºæ­¤ï¼š Redis æä¾›äº†å¤åˆ¶ï¼ˆreplicationï¼‰åŠŸèƒ½ï¼Œå¯ä»¥å®ç°å½“ä¸€å°æ•°æ®åº“ä¸­çš„æ•°æ®æ›´æ–°åï¼Œè‡ªåŠ¨å°†æ›´æ–°çš„æ•°æ®åŒæ­¥åˆ°å…¶ä»–æ•°æ®åº“ä¸Šã€‚
åœ¨å¤åˆ¶çš„æ¦‚å¿µä¸­ï¼Œæ•°æ®åº“åˆ†ä¸ºä¸¤ç±»ï¼Œä¸€ç±»æ˜¯ä¸»æ•°æ®åº“ï¼ˆmasterï¼‰ï¼Œå¦ä¸€ç±»æ˜¯ä»æ•°æ®åº“(slaveï¼‰ã€‚ä¸»æ•°æ®åº“å¯ä»¥è¿›è¡Œè¯»å†™æ“ä½œï¼Œå½“å†™æ“ä½œå¯¼è‡´æ•°æ®å˜åŒ–æ—¶ä¼šè‡ªåŠ¨å°†æ•°æ®åŒæ­¥ç»™ä»æ•°æ®åº“ã€‚è€Œä»æ•°æ®åº“ä¸€èˆ¬æ˜¯åªè¯»çš„ï¼Œåªæ¥å—ä¸»æ•°æ®åº“åŒæ­¥è¿‡æ¥çš„æ•°æ®ã€‚ä¸€ä¸ªä¸»æ•°æ®åº“å¯ä»¥æ‹¥æœ‰å¤šä¸ªä»æ•°æ®åº“ï¼Œè€Œä¸€ä¸ªä»æ•°æ®åº“åªèƒ½æ‹¥æœ‰ä¸€ä¸ªä¸»æ•°æ®åº“ã€‚
å®ç°åŸç†# ä»åº“å¯åŠ¨æˆåŠŸåè¿æ¥ä¸»åº“ï¼Œå‘é€ SYNC å‘½ä»¤ ä¸»åº“æ¥æ”¶åˆ° SYNC å‘½ä»¤åï¼Œå¼€å§‹æ‰§è¡Œ BGSAVE å‘½ä»¤ç”Ÿæˆ rdb æ–‡ä»¶å¹¶ä½¿ç”¨ç¼“å†²åŒºè®°å½•æ­¤åæ‰§è¡Œçš„æ‰€æœ‰å†™å‘½ä»¤ ä¸»åº“ BGSAVE æ‰§è¡Œå®Œæ¯•åï¼Œå‘æ‰€æœ‰ä»åº“å‘é€å¿«ç…§æ–‡ä»¶ï¼Œå¹¶åœ¨å‘é€æœŸé—´ç»§ç»­è®°å½•è¢«æ‰§è¡Œçš„å†™å‘½ä»¤ ä»åº“æ”¶åˆ°å¿«ç…§æ–‡ä»¶åä¸¢å¼ƒæ‰€æœ‰æ—§æ•°æ®ï¼Œè½½å…¥æ”¶åˆ°çš„å¿«ç…§ ä¸»åº“å¿«ç…§å‘é€å®Œæ¯•åå¼€å§‹å‘ä»åº“å‘é€ç¼“å†²åŒºä¸­çš„å†™å‘½ä»¤ ä»åº“å®Œæˆå¯¹å¿«ç…§çš„è½½å…¥ï¼Œå¼€å§‹æ¥æ”¶å‘½ä»¤è¯·æ±‚ï¼Œå¹¶æ‰§è¡Œæ¥è‡ªä¸»åº“ç¼“å†²åŒºçš„å†™å‘½ä»¤ï¼ˆè‡³æ­¤ï¼šä»åº“åˆå§‹åŒ–å®Œæˆï¼‰ ä¸»åº“æ¯æ‰§è¡Œä¸€ä¸ªå†™å‘½ä»¤å°±ä¼šå‘ä»åº“å‘é€ç›¸åŒçš„å†™å‘½ä»¤ï¼Œä»åº“æ¥æ”¶å¹¶æ‰§è¡Œæ”¶åˆ°çš„å†™å‘½ä»¤ï¼ˆå¤‡æ³¨ï¼šä»åº“åˆå§‹åŒ–å®Œæˆåçš„æ“ä½œï¼‰ å‡ºç°æ–­å¼€é‡è¿åï¼Œ2.8ä¹‹åçš„ç‰ˆæœ¬ä¼šå°†æ–­çº¿æœŸé—´çš„å‘½ä»¤ä¼ ç»™ä»åº“ã€‚å¢é‡å¤åˆ¶ ä¸»ä»åˆšè¿æ¥æ—¶ï¼šè¿›è¡Œå…¨é‡åŒæ­¥ã€‚å…¨åŒæ­¥ç»“æŸåï¼šè¿›è¡Œå¢é‡åŒæ­¥ã€‚å½“ç„¶å¦‚æœæœ‰éœ€è¦ slave å¯ä»¥åœ¨ä»»ä½•æ—¶å€™éƒ½å¯ä»¥å‘èµ·å…¨é‡åŒæ­¥ã€‚Redis çš„ç­–ç•¥æ˜¯ï¼šæ— è®ºå¦‚ä½•ï¼Œé¦–å…ˆä¼šå°è¯•è¿›è¡Œå¢é‡åŒæ­¥ï¼Œå¦‚ä¸æˆåŠŸï¼Œè¦æ±‚ä»æœºè¿›è¡Œå…¨é‡åŒæ­¥ ä¸»ä»å¤åˆ¶ä¼˜ç¼ºç‚¹# ä¼˜ç‚¹
ä¸»æœºä¼šè‡ªåŠ¨å°†æ•°æ®åŒæ­¥åˆ°ä»æœºï¼Œå¯ä»¥è¿›è¡Œè¯»å†™åˆ†ç¦» ä¸ºäº†åˆ†è½½ master çš„è¯»æ“ä½œå‹åŠ›ï¼Œslave æœåŠ¡å™¨å¯ä»¥ä¸ºå®¢æˆ·ç«¯æä¾›åªè¯»æ“ä½œçš„æœåŠ¡ï¼Œä½†å†™æœåŠ¡ä»å¿…é¡»ç”± master å®Œæˆ slave åŒæ ·å¯ä»¥æ¥å—å…¶å®ƒ slaves çš„è¿æ¥å’ŒåŒæ­¥è¯·æ±‚ï¼Œè¿™æ ·å¯ä»¥æœ‰æ•ˆçš„åˆ†è½½ master çš„åŒæ­¥å‹åŠ› master-server æ˜¯ä»¥éé˜»å¡çš„æ–¹å¼ä¸º slavesæä¾›æœåŠ¡ã€‚æ‰€ä»¥åœ¨ master-slave åŒæ­¥æœŸé—´ï¼Œå®¢æˆ·ç«¯ä»ç„¶å¯ä»¥æäº¤æŸ¥è¯¢æˆ–ä¿®æ”¹è¯·æ±‚ slave-server åŒæ ·æ˜¯ä»¥éé˜»å¡çš„æ–¹å¼å®Œæˆæ•°æ®åŒæ­¥ã€‚åœ¨åŒæ­¥æœŸé—´ï¼Œå¦‚æœæœ‰å®¢æˆ·ç«¯æäº¤æŸ¥è¯¢è¯·æ±‚ï¼Œåˆ™è¿”å›åŒæ­¥ä¹‹å‰çš„æ•°æ® ç¼ºç‚¹
ä¸å…·å¤‡è‡ªåŠ¨å®¹é”™å’Œæ¢å¤åŠŸèƒ½ï¼Œä¸»æœºä»æœºçš„å®•æœºéƒ½ä¼šå¯¼è‡´å‰ç«¯éƒ¨åˆ†è¯»å†™è¯·æ±‚å¤±è´¥ï¼Œéœ€è¦ç­‰å¾…æœºå™¨é‡å¯æˆ–è€…æ‰‹åŠ¨åˆ‡æ¢ IP æ‰èƒ½æ¢å¤ï¼ˆäººå·¥ä»‹å…¥æ–¹å¼ï¼‰ ä¸»æœºå®•æœºï¼Œå®•æœºå‰å¦‚æœ‰éƒ¨åˆ†æ•°æ®æœªèƒ½åŠæ—¶åŒæ­¥åˆ°ä»æœºï¼Œåˆ‡æ¢IPåè¿˜ä¼šå¼•å…¥æ•°æ®ä¸ä¸€è‡´çš„é—®é¢˜ï¼Œé™ä½äº†ç³»ç»Ÿçš„å¯ç”¨æ€§ å¦‚æœå¤šä¸ª slave æ‰çº¿éœ€è¦é‡å¯æ—¶ï¼Œå°½é‡ä¸è¦åœ¨åŒä¸€æ—¶é—´æ®µè¿›è¡Œé‡å¯ã€‚å› ä¸ºåªè¦ slave å¯åŠ¨ï¼Œå°±ä¼šå‘é€sync è¯·æ±‚å’Œä¸»æœºå…¨é‡åŒæ­¥ï¼Œå½“å¤šä¸ª slave é‡å¯æ—¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´ master IO å‰§å¢ä»è€Œå®•æœº è¾ƒéš¾æ”¯æŒåœ¨çº¿æ‰©å®¹ï¼Œåœ¨é›†ç¾¤å®¹é‡è¾¾åˆ°ä¸Šé™æ—¶åœ¨çº¿æ‰©å®¹ä¼šå˜å¾—å¾ˆå¤æ‚ ä¸»ä»å¤åˆ¶æ­å»º# é›†ç¾¤è‡³å°‘éœ€è¦3ä¸ªèŠ‚ç‚¹ï¼Œå› ä¸ºæŠ•ç¥¨å®¹é”™æœºåˆ¶è¦æ±‚è¶…è¿‡åŠæ•°èŠ‚ç‚¹è®¤ä¸ºæŸä¸ªèŠ‚ç‚¹æŒ‚äº†è¯¥èŠ‚ç‚¹æ‰æ˜¯æŒ‚äº†ï¼Œæ‰€ä»¥ä½äº3ä¸ªèŠ‚ç‚¹æ— æ³•æ„æˆé›†ç¾¤ è¦ä¿è¯é›†ç¾¤çš„é«˜å¯ç”¨ï¼Œéœ€è¦æ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰ä»èŠ‚ç‚¹ï¼Œä¹Ÿå°±æ˜¯å¤‡ä»½èŠ‚ç‚¹ã€‚æ‰€ä»¥Redisé›†ç¾¤è‡³å°‘éœ€è¦6å°æœåŠ¡å™¨ã€‚è¿™é‡Œæ¨¡æ‹Ÿæ­å»ºçš„æ˜¯ä¼ªåˆ†å¸ƒå¼é›†ç¾¤ï¼ˆå•æœºå¤šå®ä¾‹ï¼‰ é»˜è®¤æƒ…å†µä¸‹ä¸æŒ‡å®šä¸»æœºçš„è¯ï¼Œæ¯å° Redis éƒ½æ˜¯ä¸»èŠ‚ç‚¹ 1)ï¼šè™šæœºè¿è¡Œ3ä¸ª Redis å®ä¾‹ï¼ˆä¸€ä¸»äºŒä»ï¼‰ï¼Œä¿®æ”¹ç«¯å£å·ä¸ºï¼ˆ79-81ï¼‰ã€‚å¤åˆ¶2ä»½ redis.conf æ¨¡æ‹Ÿ2ä¸ªä»æœºå®ä¾‹"><meta itemprop=wordCount content="1646"><title>1.9 Redisé›†ç¾¤æ–¹æ¡ˆ | CODE'NOTE</title><link rel=icon href=/favicon.png><link rel=manifest href=/manifest.json><link rel=canonical href=https://wangpengliang815.github.io/docs/redis/1.9redis%E9%9B%86%E7%BE%A4%E6%96%B9%E6%A1%88/><link rel=stylesheet href=/book.min.6970156cec683193d93c9c4edaf0d56574e4361df2e0c1be4f697ae81c3ba55f.css integrity="sha256-aXAVbOxoMZPZPJxO2vDVZXTkNh3y4MG+T2l66Bw7pV8=" crossorigin=anonymous><script defer src=/fuse.min.js></script><script defer src=/en.search.min.16bbea805e586532aeca5e48249564b81bcbb5a9d44401ea4658ef5e6a5e812f.js integrity="sha256-FrvqgF5YZTKuyl5IJJVkuBvLtanURAHqRljvXmpegS8=" crossorigin=anonymous></script></head><body dir=ltr class="book-kind-page book-type-docs"><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/><span>CODE'NOTE</span></a></h2><div class="book-search hidden"><input id=book-search-input type=text placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><script>document.querySelector(".book-search").classList.remove("hidden")</script><ul><li><input type=checkbox id=section-f32afe48992fac3b3fc76dc3b27dd1d5 class=toggle>
<label for=section-f32afe48992fac3b3fc76dc3b27dd1d5 class=flex><a role=button>ğŸ“š .NET</a>
<img src=/icons/chevron-right.svg class=book-icon alt=Expand></label><ul><li><a href=/docs/dotnet/%E5%80%BC%E7%B1%BB%E5%9E%8B%E5%92%8C%E5%BC%95%E7%94%A8%E7%B1%BB%E5%9E%8B%E7%9A%84%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D/>å€¼ç±»å‹å’Œå¼•ç”¨ç±»å‹çš„å†…å­˜åˆ†é…</a></li><li><a href=/docs/dotnet/%E5%8F%8D%E5%B0%84%E6%8A%80%E6%9C%AF/>åå°„æŠ€æœ¯</a></li><li><a href=/docs/dotnet/%E5%9F%BA%E7%A1%80%E5%90%88%E9%9B%86/>åŸºç¡€åˆé›†</a></li><li><a href=/docs/dotnet/%E5%A4%9A%E7%BA%BF%E7%A8%8B/>å¤šçº¿ç¨‹</a></li><li><a href=/docs/dotnet/%E5%A7%94%E6%89%98%E5%92%8C%E4%BA%8B%E4%BB%B6/>å§”æ‰˜å’Œäº‹ä»¶</a></li><li><a href=/docs/dotnet/%E5%B9%B6%E8%A1%8C%E7%BC%96%E7%A8%8B/>å¹¶è¡Œç¼–ç¨‹</a></li><li><a href=/docs/dotnet/%E5%BC%82%E6%AD%A5%E7%BC%96%E7%A8%8B/>å¼‚æ­¥ç¼–ç¨‹</a></li><li><a href=/docs/dotnet/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/>æ•°æ®ç»“æ„</a></li><li><a href=/docs/dotnet/%E6%B3%9B%E5%9E%8B%E6%8A%80%E6%9C%AF/>æ³›å‹æŠ€æœ¯</a></li><li><a href=/docs/dotnet/%E7%BA%BF%E7%A8%8B%E5%90%8C%E6%AD%A5/>çº¿ç¨‹åŒæ­¥</a></li><li><a href=/docs/dotnet/%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1/>é¢å‘å¯¹è±¡</a></li></ul></li><li><input type=checkbox id=section-17ee4616d3316ecf2ecdb7c27cfa2a63 class=toggle>
<label for=section-17ee4616d3316ecf2ecdb7c27cfa2a63 class=flex><a role=button>ğŸ­ PMI-ACP</a>
<img src=/icons/chevron-right.svg class=book-icon alt=Expand></label><ul><li><a href=/docs/acp/pmi-acp%E5%9F%BA%E7%A1%80%E4%BA%86%E8%A7%A3/>Pmi AcpåŸºç¡€äº†è§£</a></li><li><a href=/docs/acp/pmi-acpdown/>Pmi Acpdown</a></li><li><a href=/docs/acp/pmi-acp%E5%A4%87%E8%80%83%E7%AC%94%E8%AE%B001/>Pmi Acpå¤‡è€ƒç¬”è®°01</a></li><li><a href=/docs/acp/pmi-acp%E5%A4%87%E8%80%83%E7%AC%94%E8%AE%B002/>Pmi Acpå¤‡è€ƒç¬”è®°02</a></li><li><a href=/docs/acp/pmi-acp%E5%A4%87%E8%80%83%E7%AC%94%E8%AE%B003/>Pmi Acpå¤‡è€ƒç¬”è®°03</a></li></ul></li><li><input type=checkbox id=section-fba10961f5d9c66eab238d766cb1a791 class=toggle>
<label for=section-fba10961f5d9c66eab238d766cb1a791 class=flex><a role=button>âŒ› è½¯ä»¶æµ‹è¯•</a>
<img src=/icons/chevron-right.svg class=book-icon alt=Expand></label><ul><li><a href=/docs/test/%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95/>å•å…ƒæµ‹è¯•</a></li><li><a href=/docs/test/%E5%8E%8B%E5%8A%9B%E6%B5%8B%E8%AF%95k6/>å‹åŠ›æµ‹è¯•k6</a></li><li><a href=/docs/test/%E8%87%AA%E5%8A%A8%E5%8C%96ui%E6%B5%8B%E8%AF%95/>è‡ªåŠ¨åŒ– Uiæµ‹è¯•</a></li><li><a href=/docs/test/%E9%9B%86%E6%88%90%E6%B5%8B%E8%AF%95/>é›†æˆæµ‹è¯•</a></li></ul></li><li><input type=checkbox id=section-92cef1621a3b87cdf19787a11c3e85e0 class=toggle>
<label for=section-92cef1621a3b87cdf19787a11c3e85e0 class=flex><a role=button>â›·ï¸ Prometheus</a>
<img src=/icons/chevron-right.svg class=book-icon alt=Expand></label><ul><li><a href=/docs/prometheus/1.1prometheus%E7%AE%80%E4%BB%8B%E5%8F%8A%E5%AE%89%E8%A3%85/>1.1 Prometheusç®€ä»‹åŠå®‰è£…</a></li><li><a href=/docs/prometheus/1.2exporter%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86/>1.2 Exporteræ•°æ®é‡‡é›†</a></li><li><a href=/docs/prometheus/1.3promql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E8%A8%80/>1.3 Prom QlæŸ¥è¯¢è¯­è¨€</a></li><li><a href=/docs/prometheus/1.4alertmanager%E5%91%8A%E8%AD%A6%E5%A4%84%E7%90%86/>1.4 Alertmanagerå‘Šè­¦å¤„ç†</a></li><li><a href=/docs/prometheus/1.5grafana%E7%9B%91%E6%8E%A7%E5%8F%AF%E8%A7%86%E5%8C%96/>1.5 Grafanaç›‘æ§å¯è§†åŒ–</a></li></ul></li><li><input type=checkbox id=section-c4b81cc06a2cdd0259ab09c2dde93fb5 class=toggle>
<label for=section-c4b81cc06a2cdd0259ab09c2dde93fb5 class=flex><a role=button>ğŸ‡ RabbitMq</a>
<img src=/icons/chevron-right.svg class=book-icon alt=Expand></label><ul><li><a href=/docs/rabbitmq/1.1rabbitmq%E6%A6%82%E5%BF%B5%E5%8F%8A%E5%AE%89%E8%A3%85/>1.1 Rabbit Mqæ¦‚å¿µåŠå®‰è£…</a></li><li><a href=/docs/rabbitmq/1.2%E5%B7%A5%E4%BD%9C%E6%A8%A1%E5%BC%8F%E4%BB%8B%E7%BB%8D/>1.2å·¥ä½œæ¨¡å¼ä»‹ç»</a></li><li><a href=/docs/rabbitmq/1.3%E6%B6%88%E6%81%AF%E7%A1%AE%E8%AE%A4%E5%8F%8A%E6%8C%81%E4%B9%85%E5%8C%96/>1.3æ¶ˆæ¯ç¡®è®¤åŠæŒä¹…åŒ–</a></li><li><a href=/docs/rabbitmq/1.4%E4%B8%A4%E7%A7%8D%E6%B6%88%E8%B4%B9%E6%A8%A1%E5%BC%8F%E5%92%8Cqos%E7%9A%84%E5%AE%9E%E7%8E%B0/>1.4ä¸¤ç§æ¶ˆè´¹æ¨¡å¼å’Œ Qosçš„å®ç°</a></li><li><a href=/docs/rabbitmq/1.5channel%E5%B8%B8%E8%A7%81%E6%96%B9%E6%B3%95/>1.5 Channelå¸¸è§æ–¹æ³•</a></li><li><a href=/docs/rabbitmq/1.6rabbitmq%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/>1.6 Rabbit Mqå¸¸ç”¨å‘½ä»¤</a></li><li><a href=/docs/rabbitmq/1.7rabbitmq%E5%B8%B8%E8%A7%81%E7%AD%96%E7%95%A5/>1.7 Rabbit Mqå¸¸è§ç­–ç•¥</a></li><li><a href=/docs/rabbitmq/1.8rabbitmq%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98/>1.8 Rabbit Mqå¸¸è§é—®é¢˜</a></li><li><a href=/docs/rabbitmq/1.9rabbitmq%E9%9B%86%E7%BE%A4%E6%96%B9%E6%A1%88/>1.9 Rabbit Mqé›†ç¾¤æ–¹æ¡ˆ</a></li><li><a href=/docs/rabbitmq/%E5%AE%A2%E6%88%B7%E7%AB%AF%E8%BF%9E%E6%8E%A5rabbitmq/>å®¢æˆ·ç«¯è¿æ¥ Rabbit Mq</a></li></ul></li><li><input type=checkbox id=section-45de5b9a6214c965d493f727c3af2aae class=toggle>
<label for=section-45de5b9a6214c965d493f727c3af2aae class=flex><a role=button>ğŸ¹ Golang</a>
<img src=/icons/chevron-right.svg class=book-icon alt=Expand></label><ul><li><a href=/docs/go/01%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/>01å¼€å‘ç¯å¢ƒæ­å»º</a></li><li><a href=/docs/go/02%E5%8F%98%E9%87%8F%E5%92%8C%E5%B8%B8%E9%87%8F/>02å˜é‡å’Œå¸¸é‡</a></li><li><a href=/docs/go/03%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/>03åŸºæœ¬æ•°æ®ç±»å‹</a></li><li><a href=/docs/go/04%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6%E5%92%8C%E8%BF%90%E7%AE%97%E7%AC%A6/>04æµç¨‹æ§åˆ¶å’Œè¿ç®—ç¬¦</a></li><li><a href=/docs/go/05%E6%95%B0%E7%BB%84/>05æ•°ç»„</a></li><li><a href=/docs/go/06%E5%88%87%E7%89%87/>06åˆ‡ç‰‡</a></li><li><a href=/docs/go/07map/>07map</a></li><li><a href=/docs/go/08%E5%87%BD%E6%95%B0/>08å‡½æ•°</a></li><li><a href=/docs/go/09%E6%8C%87%E9%92%88/>09æŒ‡é’ˆ</a></li><li><a href=/docs/go/10%E5%8F%8D%E5%B0%84/>10åå°„</a></li><li><a href=/docs/go/11%E7%BB%93%E6%9E%84%E4%BD%93/>11ç»“æ„ä½“</a></li><li><a href=/docs/go/12%E6%8E%A5%E5%8F%A3/>12æ¥å£</a></li><li><a href=/docs/go/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/channel/>Channel</a></li><li><a href=/docs/go/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/csp%E5%B9%B6%E5%8F%91%E6%A8%A1%E5%9E%8B/>Cspå¹¶å‘æ¨¡å‹</a></li><li><a href=/docs/go/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/goroutine/>Goroutine</a></li><li><a href=/docs/go/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/gpm%E5%8E%9F%E7%90%86%E4%B8%8E%E8%B0%83%E5%BA%A6/>GpmåŸç†ä¸è°ƒåº¦</a></li><li><a href=/docs/go/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/%E5%8E%9F%E5%AD%90%E6%93%8D%E4%BD%9C/>åŸå­æ“ä½œ</a></li><li><a href=/docs/go/%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B/%E5%B9%B6%E5%8F%91%E5%AE%89%E5%85%A8%E5%92%8C%E9%94%81/>å¹¶å‘å®‰å…¨å’Œé”</a></li><li><a href=/docs/go/%E6%A0%87%E5%87%86%E5%BA%93/flag/>Flag</a></li><li><a href=/docs/go/%E6%A0%87%E5%87%86%E5%BA%93/fmt/>Fmt</a></li><li><a href=/docs/go/%E6%A0%87%E5%87%86%E5%BA%93/log/>Log</a></li><li><a href=/docs/go/%E6%A0%87%E5%87%86%E5%BA%93/time/>Time</a></li></ul></li><li><input type=checkbox id=section-61dde4567035e1fd2b5d2aa51b82a7a0 class=toggle>
<label for=section-61dde4567035e1fd2b5d2aa51b82a7a0 class=flex><a role=button>ğŸ’« Microservice</a>
<img src=/icons/chevron-right.svg class=book-icon alt=Expand></label><ul><li><a href=/docs/microservice/1.1%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%85%A5%E9%97%A8%E4%B9%8B%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA/>1.1å¾®æœåŠ¡å…¥é—¨ä¹‹é¡¹ç›®æ­å»º</a></li><li><a href=/docs/microservice/1.2%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%85%A5%E9%97%A8%E4%B9%8B%E6%9C%8D%E5%8A%A1%E6%B3%A8%E5%86%8C%E4%B8%8E%E5%8F%91%E7%8E%B0/>1.2å¾®æœåŠ¡å…¥é—¨ä¹‹æœåŠ¡æ³¨å†Œä¸å‘ç°</a></li><li><a href=/docs/microservice/1.3%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%85%A5%E9%97%A8%E4%B9%8B%E7%BD%91%E5%85%B3/>1.3å¾®æœåŠ¡å…¥é—¨ä¹‹ç½‘å…³</a></li><li><a href=/docs/microservice/1.4%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%85%A5%E9%97%A8%E4%B9%8B%E4%BA%8B%E4%BB%B6%E6%80%BB%E7%BA%BF/>1.4å¾®æœåŠ¡å…¥é—¨ä¹‹äº‹ä»¶æ€»çº¿</a></li><li><a href=/docs/microservice/1.5%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%85%A5%E9%97%A8%E4%B9%8Bdockercompose/>1.5å¾®æœåŠ¡å…¥é—¨ä¹‹ Docker Compose</a></li><li><a href=/docs/microservice/consul%E6%9C%8D%E5%8A%A1%E6%B3%A8%E5%86%8C%E5%8F%91%E7%8E%B0/>ConsulæœåŠ¡æ³¨å†Œå‘ç°</a></li></ul></li><li><input type=checkbox id=section-e6c26370c56585ceaa14c64b7d769452 class=toggle checked>
<label for=section-e6c26370c56585ceaa14c64b7d769452 class=flex><a role=button>ğŸ“¦ Redis</a>
<img src=/icons/chevron-right.svg class=book-icon alt=Expand></label><ul><li><a href=/docs/redis/1.10redis%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98/>1.10 Rediså¸¸è§é—®é¢˜</a></li><li><a href=/docs/redis/1.1nosql%E6%A6%82%E8%BF%B0/>1.1 No Sqlæ¦‚è¿°</a></li><li><a href=/docs/redis/1.2redis%E5%AE%89%E8%A3%85/>1.2 Rediså®‰è£…</a></li><li><a href=/docs/redis/1.3redis%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/>1.3 RedisåŸºæœ¬æ•°æ®ç±»å‹</a></li><li><a href=/docs/redis/1.4redis%E7%89%B9%E6%AE%8A%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B/>1.4 Redisç‰¹æ®Šæ•°æ®ç±»å‹</a></li><li><a href=/docs/redis/1.5redis%E4%BA%8B%E5%8A%A1%E6%93%8D%E4%BD%9C/>1.5 Redisäº‹åŠ¡æ“ä½œ</a></li><li><a href=/docs/redis/1.6redis%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E8%AF%A6%E8%A7%A3/>1.6 Redisé…ç½®æ–‡ä»¶è¯¦è§£</a></li><li><a href=/docs/redis/1.7redis%E6%8C%81%E4%B9%85%E5%8C%96/>1.7 RedisæŒä¹…åŒ–</a></li><li><a href=/docs/redis/1.8redis%E5%8F%91%E5%B8%83%E8%AE%A2%E9%98%85/>1.8 Rediså‘å¸ƒè®¢é˜…</a></li><li><a href=/docs/redis/1.9redis%E9%9B%86%E7%BE%A4%E6%96%B9%E6%A1%88/ class=active>1.9 Redisé›†ç¾¤æ–¹æ¡ˆ</a></li><li><a href=/docs/redis/%E4%BD%BF%E7%94%A8docker%E6%90%AD%E5%BB%BAredis%E9%9B%86%E7%BE%A4/>ä½¿ç”¨ Dockeræ­å»º Redisé›†ç¾¤</a></li><li><a href=/docs/redis/%E5%AE%A2%E6%88%B7%E7%AB%AF%E8%BF%9E%E6%8E%A5redis/>å®¢æˆ·ç«¯è¿æ¥ Redis</a></li></ul></li><li><input type=checkbox id=section-f781adde1ca4021db6751ec1e71e0572 class=toggle>
<label for=section-f781adde1ca4021db6751ec1e71e0572 class=flex><a role=button>ğŸ” ELK</a>
<img src=/icons/chevron-right.svg class=book-icon alt=Expand></label><ul><li><a href=/docs/elk/1.1elastaticsearch%E5%85%A5%E9%97%A8/>1.1 Elastatic Searchå…¥é—¨</a></li><li><a href=/docs/elk/1.2elastaticsearch%E9%85%8D%E7%BD%AE/>1.2 Elastatic Searché…ç½®</a></li><li><a href=/docs/elk/1.3%E4%BD%BF%E7%94%A8kibana%E6%93%8D%E4%BD%9Ces/>1.3ä½¿ç”¨ Kibanaæ“ä½œ Es</a></li></ul></li><li><input type=checkbox id=section-17df8bdb44c678e43d193647c6ae88f1 class=toggle>
<label for=section-17df8bdb44c678e43d193647c6ae88f1 class=flex><a role=button>ğŸš¢ Docker</a>
<img src=/icons/chevron-right.svg class=book-icon alt=Expand></label><ul><li><a href=/docs/docker/1.1docker%E6%A6%82%E5%BF%B5%E5%8F%8A%E5%AE%89%E8%A3%85/>1.1 Dockeræ¦‚å¿µåŠå®‰è£…</a></li><li><a href=/docs/docker/1.2docker%E9%95%9C%E5%83%8F/>1.2 Dockeré•œåƒ</a></li><li><a href=/docs/docker/1.3docker%E5%AE%B9%E5%99%A8/>1.3 Dockerå®¹å™¨</a></li><li><a href=/docs/docker/1.4docker%E4%BB%93%E5%BA%93/>1.4 Dockerä»“åº“</a></li><li><a href=/docs/docker/1.5docker%E6%95%B0%E6%8D%AE%E7%AE%A1%E7%90%86/>1.5 Dockeræ•°æ®ç®¡ç†</a></li><li><a href=/docs/docker/1.6docker%E5%AE%B9%E5%99%A8%E7%BD%91%E7%BB%9C%E6%A8%A1%E5%BC%8F/>1.6 Dockerå®¹å™¨ç½‘ç»œæ¨¡å¼</a></li><li><a href=/docs/docker/1.7docker%E9%AB%98%E7%BA%A7%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE/>1.7 Dockeré«˜çº§ç½‘ç»œé…ç½®</a></li><li><a href=/docs/docker/1.8dockerfile/>1.8 Dockerfile</a></li><li><a href=/docs/docker/1.9dockercompose/>1.9 Docker Compose</a></li><li><a href=/docs/docker/2.0dockermachine/>2.0 Docker Machine</a></li><li><a href=/docs/docker/2.1dockerswarm/>2.1 Docker Swarm</a></li><li><a href=/docs/docker/2.2docker%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/>2.2 Dockerå¸¸ç”¨å‘½ä»¤</a></li><li><a href=/docs/docker/2.3portainer%E5%8F%AF%E8%A7%86%E5%8C%96%E9%9D%A2%E6%9D%BF/>2.3 Portainerå¯è§†åŒ–é¢æ¿</a></li></ul></li><li><input type=checkbox id=section-566aa18ccd5b6b6934a70aded3a8361a class=toggle>
<label for=section-566aa18ccd5b6b6934a70aded3a8361a class=flex><a role=button>ğŸ•¸ï¸ K8s</a>
<img src=/icons/chevron-right.svg class=book-icon alt=Expand></label><ul><li><a href=/docs/kubernetes/kubernetes%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/>KubernetesåŸºç¡€çŸ¥è¯†</a></li><li><a href=/docs/kubernetes/kubernetes%E9%9B%86%E7%BE%A4%E5%AE%89%E8%A3%85/>Kubernetesé›†ç¾¤å®‰è£…</a></li></ul></li><li><input type=checkbox id=section-04176b4c8c5f502db36c25b60db03d67 class=toggle>
<label for=section-04176b4c8c5f502db36c25b60db03d67 class=flex><a role=button>ğŸ–¥ï¸ Linux</a>
<img src=/icons/chevron-right.svg class=book-icon alt=Expand></label><ul><li><a href=/docs/linux/centos7%E5%8D%87%E7%BA%A7gcc%E7%89%88%E6%9C%AC/>Centos7å‡çº§gccç‰ˆæœ¬</a></li><li><a href=/docs/linux/centos%E5%AE%89%E8%A3%85hexo/>Centoså®‰è£… Hexo</a></li><li><a href=/docs/linux/centos%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE/>Centosç½‘ç»œé…ç½®</a></li><li><a href=/docs/linux/linux%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/>Linuxå¸¸ç”¨å‘½ä»¤</a></li><li><a href=/docs/linux/linux%E7%9B%AE%E5%BD%95%E8%AF%B4%E6%98%8E/>Linuxç›®å½•è¯´æ˜</a></li><li><a href=/docs/linux/vmware%E5%AE%89%E8%A3%85centos/>Vmwareå®‰è£… Centos</a></li></ul></li><li><input type=checkbox id=section-9397a01455952fcbd887e2206a8a3054 class=toggle>
<label for=section-9397a01455952fcbd887e2206a8a3054 class=flex><a role=button>ğŸ›ï¸ Devops</a>
<img src=/icons/chevron-right.svg class=book-icon alt=Expand></label><ul><li><a href=/docs/devops/gitlab%E5%AE%89%E8%A3%85/>Gitlabå®‰è£…</a></li><li><a href=/docs/devops/jenkins%E5%AE%89%E8%A3%85/>Jenkinså®‰è£…</a></li><li><a href=/docs/devops/jenkins%E5%B8%B8%E8%A7%81%E6%93%8D%E4%BD%9C/>Jenkinså¸¸è§æ“ä½œ</a></li><li><a href=/docs/devops/nugetserver%E6%90%AD%E5%BB%BA/>Nuget Serveræ­å»º</a></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class="book-header hidden"><div class="flex align-center justify-between"><label for=menu-control><img src=/icons/menu.svg class=book-icon alt=Menu></label><h3>1.9 Redisé›†ç¾¤æ–¹æ¡ˆ</h3><label for=toc-control><img src=/icons/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class=hidden><nav id=TableOfContents><ul><li><a href=#ä¸»ä»å¤åˆ¶>ä¸»ä»å¤åˆ¶</a><ul><li><a href=#å®ç°åŸç†>å®ç°åŸç†</a></li><li><a href=#ä¸»ä»å¤åˆ¶ä¼˜ç¼ºç‚¹><strong>ä¸»ä»å¤åˆ¶ä¼˜ç¼ºç‚¹</strong></a></li><li><a href=#ä¸»ä»å¤åˆ¶æ­å»º>ä¸»ä»å¤åˆ¶æ­å»º</a></li></ul></li><li><a href=#sentinelå“¨å…µæ¨¡å¼>Sentinelï¼ˆå“¨å…µï¼‰æ¨¡å¼</a><ul><li><a href=#å“¨å…µä½œç”¨>å“¨å…µä½œç”¨</a></li><li><a href=#æ•…éšœåˆ‡æ¢failoverè¿‡ç¨‹>æ•…éšœåˆ‡æ¢ï¼ˆfailoverï¼‰è¿‡ç¨‹</a></li><li><a href=#å“¨å…µå·¥ä½œæ–¹å¼>å“¨å…µå·¥ä½œæ–¹å¼</a></li><li><a href=#å“¨å…µæ¨¡å¼ä¼˜ç¼ºç‚¹>å“¨å…µæ¨¡å¼ä¼˜ç¼ºç‚¹</a></li><li><a href=#å“¨å…µæ¨¡å¼æ­å»º>å“¨å…µæ¨¡å¼æ­å»º</a></li></ul></li><li><a href=#cluster-é›†ç¾¤æ¨¡å¼>Cluster é›†ç¾¤æ¨¡å¼</a><ul><li><a href=#clusterç‰¹ç‚¹>Clusterç‰¹ç‚¹</a></li><li><a href=#clusteré›†ç¾¤æ¨¡å¼å¯¹æ¯”>Clusteré›†ç¾¤æ¨¡å¼å¯¹æ¯”</a></li><li><a href=#æ•°æ®å­˜å‚¨è®¾è®¡><strong>æ•°æ®å­˜å‚¨è®¾è®¡</strong></a></li><li><a href=#å“ˆå¸Œæ§½slot>å“ˆå¸Œæ§½Slot</a></li><li><a href=#é›†ç¾¤å†…éƒ¨é€šè®¯æœºåˆ¶>é›†ç¾¤å†…éƒ¨é€šè®¯æœºåˆ¶</a></li><li><a href=#clusteré›†ç¾¤æ­å»º>Clusteré›†ç¾¤æ­å»º</a></li></ul></li></ul></nav></aside></header><article class="markdown book-article"><h1 id=redisé›†ç¾¤>Redisé›†ç¾¤<a class=anchor href=#redis%e9%9b%86%e7%be%a4>#</a></h1><p>Redisæ”¯æŒä¸‰ç§é›†ç¾¤æ–¹æ¡ˆ</p><ul><li>ä¸»ä»å¤åˆ¶</li><li>Sentinelï¼ˆå“¨å…µï¼‰</li><li>Cluster</li></ul><h2 id=ä¸»ä»å¤åˆ¶>ä¸»ä»å¤åˆ¶<a class=anchor href=#%e4%b8%bb%e4%bb%8e%e5%a4%8d%e5%88%b6>#</a></h2><p>é€šè¿‡æŒä¹…åŒ–åŠŸèƒ½ï¼ŒRedisä¿è¯äº†å³ä½¿åœ¨æœåŠ¡å™¨é‡å¯çš„æƒ…å†µä¸‹ä¹Ÿä¸ä¼šä¸¢å¤±ï¼ˆæˆ–å°‘é‡ä¸¢å¤±ï¼‰æ•°æ®ï¼Œå› ä¸ºæŒä¹…åŒ–ä¼šæŠŠå†…å­˜ä¸­æ•°æ®ä¿å­˜åˆ°ç¡¬ç›˜ä¸Šï¼Œé‡å¯ä¼šä»ç¡¬ç›˜ä¸ŠåŠ è½½æ•°æ®ã€‚ ä½†æ˜¯ç”±äºæ•°æ®æ˜¯å­˜å‚¨åœ¨ä¸€å°æœåŠ¡å™¨ä¸Šçš„ï¼Œå¦‚æœè¿™å°æœåŠ¡å™¨å‡ºç°ç¡¬ç›˜æ•…éšœç­‰é—®é¢˜ï¼Œä¹Ÿä¼šå¯¼è‡´æ•°æ®ä¸¢å¤±ã€‚ä¸ºäº†é¿å…å•ç‚¹æ•…éšœï¼Œé€šå¸¸çš„åšæ³•æ˜¯å°†æ•°æ®åº“å¤åˆ¶å¤šä¸ªå‰¯æœ¬ä»¥éƒ¨ç½²åœ¨ä¸åŒçš„æœåŠ¡å™¨ä¸Šï¼Œè¿™æ ·å³ä½¿æœ‰ä¸€å°æœåŠ¡å™¨å‡ºç°æ•…éšœï¼Œå…¶ä»–æœåŠ¡å™¨ä¾ç„¶å¯ä»¥ç»§ç»­æä¾›æœåŠ¡ã€‚</p><p>ä¸ºæ­¤ï¼š <code>Redis æä¾›äº†å¤åˆ¶ï¼ˆreplicationï¼‰åŠŸèƒ½ï¼Œå¯ä»¥å®ç°å½“ä¸€å°æ•°æ®åº“ä¸­çš„æ•°æ®æ›´æ–°åï¼Œè‡ªåŠ¨å°†æ›´æ–°çš„æ•°æ®åŒæ­¥åˆ°å…¶ä»–æ•°æ®åº“ä¸Š</code>ã€‚</p><p>åœ¨å¤åˆ¶çš„æ¦‚å¿µä¸­ï¼Œæ•°æ®åº“åˆ†ä¸ºä¸¤ç±»ï¼Œä¸€ç±»æ˜¯ä¸»æ•°æ®åº“ï¼ˆmasterï¼‰ï¼Œå¦ä¸€ç±»æ˜¯ä»æ•°æ®åº“(slaveï¼‰ã€‚ä¸»æ•°æ®åº“å¯ä»¥è¿›è¡Œè¯»å†™æ“ä½œï¼Œå½“å†™æ“ä½œå¯¼è‡´æ•°æ®å˜åŒ–æ—¶ä¼šè‡ªåŠ¨å°†æ•°æ®åŒæ­¥ç»™ä»æ•°æ®åº“ã€‚è€Œä»æ•°æ®åº“ä¸€èˆ¬æ˜¯åªè¯»çš„ï¼Œåªæ¥å—ä¸»æ•°æ®åº“åŒæ­¥è¿‡æ¥çš„æ•°æ®ã€‚<code>ä¸€ä¸ªä¸»æ•°æ®åº“å¯ä»¥æ‹¥æœ‰å¤šä¸ªä»æ•°æ®åº“ï¼Œè€Œä¸€ä¸ªä»æ•°æ®åº“åªèƒ½æ‹¥æœ‰ä¸€ä¸ªä¸»æ•°æ®åº“</code>ã€‚</p><h3 id=å®ç°åŸç†>å®ç°åŸç†<a class=anchor href=#%e5%ae%9e%e7%8e%b0%e5%8e%9f%e7%90%86>#</a></h3><ol><li>ä»åº“å¯åŠ¨æˆåŠŸåè¿æ¥ä¸»åº“ï¼Œå‘é€ <code>SYNC</code> å‘½ä»¤</li><li>ä¸»åº“æ¥æ”¶åˆ° <code>SYNC</code> å‘½ä»¤åï¼Œå¼€å§‹æ‰§è¡Œ <code>BGSAVE</code> å‘½ä»¤ç”Ÿæˆ <code>rdb</code> æ–‡ä»¶å¹¶ä½¿ç”¨ç¼“å†²åŒºè®°å½•æ­¤åæ‰§è¡Œçš„æ‰€æœ‰å†™å‘½ä»¤</li><li>ä¸»åº“ <code>BGSAVE</code> æ‰§è¡Œå®Œæ¯•åï¼Œå‘æ‰€æœ‰ä»åº“å‘é€å¿«ç…§æ–‡ä»¶ï¼Œå¹¶åœ¨å‘é€æœŸé—´ç»§ç»­è®°å½•è¢«æ‰§è¡Œçš„å†™å‘½ä»¤</li><li>ä»åº“æ”¶åˆ°å¿«ç…§æ–‡ä»¶åä¸¢å¼ƒæ‰€æœ‰æ—§æ•°æ®ï¼Œè½½å…¥æ”¶åˆ°çš„å¿«ç…§</li><li>ä¸»åº“å¿«ç…§å‘é€å®Œæ¯•åå¼€å§‹å‘ä»åº“å‘é€ç¼“å†²åŒºä¸­çš„å†™å‘½ä»¤</li><li>ä»åº“å®Œæˆå¯¹å¿«ç…§çš„è½½å…¥ï¼Œå¼€å§‹æ¥æ”¶å‘½ä»¤è¯·æ±‚ï¼Œå¹¶æ‰§è¡Œæ¥è‡ªä¸»åº“ç¼“å†²åŒºçš„å†™å‘½ä»¤ï¼ˆè‡³æ­¤ï¼šä»åº“åˆå§‹åŒ–å®Œæˆï¼‰</li><li>ä¸»åº“æ¯æ‰§è¡Œä¸€ä¸ªå†™å‘½ä»¤å°±ä¼šå‘ä»åº“å‘é€ç›¸åŒçš„å†™å‘½ä»¤ï¼Œä»åº“æ¥æ”¶å¹¶æ‰§è¡Œæ”¶åˆ°çš„å†™å‘½ä»¤ï¼ˆå¤‡æ³¨ï¼šä»åº“åˆå§‹åŒ–å®Œæˆåçš„æ“ä½œï¼‰</li><li>å‡ºç°æ–­å¼€é‡è¿åï¼Œ2.8ä¹‹åçš„ç‰ˆæœ¬ä¼šå°†æ–­çº¿æœŸé—´çš„å‘½ä»¤ä¼ ç»™ä»åº“ã€‚å¢é‡å¤åˆ¶</li><li>ä¸»ä»åˆšè¿æ¥æ—¶ï¼šè¿›è¡Œå…¨é‡åŒæ­¥ã€‚å…¨åŒæ­¥ç»“æŸåï¼šè¿›è¡Œå¢é‡åŒæ­¥ã€‚å½“ç„¶å¦‚æœæœ‰éœ€è¦ slave å¯ä»¥åœ¨ä»»ä½•æ—¶å€™éƒ½å¯ä»¥å‘èµ·å…¨é‡åŒæ­¥ã€‚Redis çš„ç­–ç•¥æ˜¯ï¼šæ— è®ºå¦‚ä½•ï¼Œé¦–å…ˆä¼šå°è¯•è¿›è¡Œå¢é‡åŒæ­¥ï¼Œå¦‚ä¸æˆåŠŸï¼Œè¦æ±‚ä»æœºè¿›è¡Œå…¨é‡åŒæ­¥</li></ol><h3 id=ä¸»ä»å¤åˆ¶ä¼˜ç¼ºç‚¹><strong>ä¸»ä»å¤åˆ¶ä¼˜ç¼ºç‚¹</strong><a class=anchor href=#%e4%b8%bb%e4%bb%8e%e5%a4%8d%e5%88%b6%e4%bc%98%e7%bc%ba%e7%82%b9>#</a></h3><p><strong>ä¼˜ç‚¹</strong></p><ul><li>ä¸»æœºä¼šè‡ªåŠ¨å°†æ•°æ®åŒæ­¥åˆ°ä»æœºï¼Œå¯ä»¥è¿›è¡Œè¯»å†™åˆ†ç¦»</li><li>ä¸ºäº†åˆ†è½½ <code>master</code> çš„è¯»æ“ä½œå‹åŠ›ï¼Œ<code>slave</code> æœåŠ¡å™¨å¯ä»¥ä¸ºå®¢æˆ·ç«¯æä¾›åªè¯»æ“ä½œçš„æœåŠ¡ï¼Œä½†å†™æœåŠ¡ä»å¿…é¡»ç”± <code>master</code> å®Œæˆ</li><li><code>slave</code> åŒæ ·å¯ä»¥æ¥å—å…¶å®ƒ <code>slaves</code> çš„è¿æ¥å’ŒåŒæ­¥è¯·æ±‚ï¼Œè¿™æ ·å¯ä»¥æœ‰æ•ˆçš„åˆ†è½½ <code>master</code> çš„åŒæ­¥å‹åŠ›</li><li><code>master-server</code> æ˜¯ä»¥éé˜»å¡çš„æ–¹å¼ä¸º <code>slaves</code>æä¾›æœåŠ¡ã€‚æ‰€ä»¥åœ¨ <code>master-slave</code> åŒæ­¥æœŸé—´ï¼Œå®¢æˆ·ç«¯ä»ç„¶å¯ä»¥æäº¤æŸ¥è¯¢æˆ–ä¿®æ”¹è¯·æ±‚</li><li><code>slave-server</code> åŒæ ·æ˜¯ä»¥éé˜»å¡çš„æ–¹å¼å®Œæˆæ•°æ®åŒæ­¥ã€‚åœ¨åŒæ­¥æœŸé—´ï¼Œå¦‚æœæœ‰å®¢æˆ·ç«¯æäº¤æŸ¥è¯¢è¯·æ±‚ï¼Œåˆ™è¿”å›åŒæ­¥ä¹‹å‰çš„æ•°æ®</li></ul><p><strong>ç¼ºç‚¹</strong></p><ul><li>ä¸å…·å¤‡è‡ªåŠ¨å®¹é”™å’Œæ¢å¤åŠŸèƒ½ï¼Œä¸»æœºä»æœºçš„å®•æœºéƒ½ä¼šå¯¼è‡´å‰ç«¯éƒ¨åˆ†è¯»å†™è¯·æ±‚å¤±è´¥ï¼Œéœ€è¦ç­‰å¾…æœºå™¨é‡å¯æˆ–è€…æ‰‹åŠ¨åˆ‡æ¢ <code>IP</code> æ‰èƒ½æ¢å¤ï¼ˆäººå·¥ä»‹å…¥æ–¹å¼ï¼‰</li><li>ä¸»æœºå®•æœºï¼Œå®•æœºå‰å¦‚æœ‰éƒ¨åˆ†æ•°æ®æœªèƒ½åŠæ—¶åŒæ­¥åˆ°ä»æœºï¼Œåˆ‡æ¢IPåè¿˜ä¼šå¼•å…¥æ•°æ®ä¸ä¸€è‡´çš„é—®é¢˜ï¼Œé™ä½äº†ç³»ç»Ÿçš„å¯ç”¨æ€§</li><li>å¦‚æœå¤šä¸ª <code>slave</code> æ‰çº¿éœ€è¦é‡å¯æ—¶ï¼Œå°½é‡ä¸è¦åœ¨åŒä¸€æ—¶é—´æ®µè¿›è¡Œé‡å¯ã€‚å› ä¸ºåªè¦ <code>slave</code> å¯åŠ¨ï¼Œå°±ä¼šå‘é€<code>sync</code> è¯·æ±‚å’Œä¸»æœºå…¨é‡åŒæ­¥ï¼Œå½“å¤šä¸ª <code>slave</code> é‡å¯æ—¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´ <code>master</code> <code>IO</code> å‰§å¢ä»è€Œå®•æœº</li><li>è¾ƒéš¾æ”¯æŒåœ¨çº¿æ‰©å®¹ï¼Œåœ¨é›†ç¾¤å®¹é‡è¾¾åˆ°ä¸Šé™æ—¶åœ¨çº¿æ‰©å®¹ä¼šå˜å¾—å¾ˆå¤æ‚</li></ul><h3 id=ä¸»ä»å¤åˆ¶æ­å»º>ä¸»ä»å¤åˆ¶æ­å»º<a class=anchor href=#%e4%b8%bb%e4%bb%8e%e5%a4%8d%e5%88%b6%e6%90%ad%e5%bb%ba>#</a></h3><ul><li>é›†ç¾¤è‡³å°‘éœ€è¦3ä¸ªèŠ‚ç‚¹ï¼Œå› ä¸ºæŠ•ç¥¨å®¹é”™æœºåˆ¶è¦æ±‚è¶…è¿‡åŠæ•°èŠ‚ç‚¹è®¤ä¸ºæŸä¸ªèŠ‚ç‚¹æŒ‚äº†è¯¥èŠ‚ç‚¹æ‰æ˜¯æŒ‚äº†ï¼Œæ‰€ä»¥ä½äº3ä¸ªèŠ‚ç‚¹æ— æ³•æ„æˆé›†ç¾¤</li><li>è¦ä¿è¯é›†ç¾¤çš„é«˜å¯ç”¨ï¼Œéœ€è¦æ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰ä»èŠ‚ç‚¹ï¼Œä¹Ÿå°±æ˜¯å¤‡ä»½èŠ‚ç‚¹ã€‚æ‰€ä»¥Redisé›†ç¾¤è‡³å°‘éœ€è¦6å°æœåŠ¡å™¨ã€‚è¿™é‡Œæ¨¡æ‹Ÿæ­å»ºçš„æ˜¯ä¼ªåˆ†å¸ƒå¼é›†ç¾¤ï¼ˆ<strong>å•æœºå¤šå®ä¾‹</strong>ï¼‰</li><li>é»˜è®¤æƒ…å†µä¸‹ä¸æŒ‡å®šä¸»æœºçš„è¯ï¼Œæ¯å° Redis éƒ½æ˜¯ä¸»èŠ‚ç‚¹</li></ul><p>1)ï¼šè™šæœºè¿è¡Œ3ä¸ª Redis å®ä¾‹ï¼ˆä¸€ä¸»äºŒä»ï¼‰ï¼Œä¿®æ”¹ç«¯å£å·ä¸ºï¼ˆ79-81ï¼‰ã€‚å¤åˆ¶2ä»½ <code>redis.conf</code> æ¨¡æ‹Ÿ2ä¸ªä»æœºå®ä¾‹</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>root@wangpengliang bin<span style=color:#f92672>]</span><span style=color:#75715e># ls</span>
</span></span><span style=display:flex><span>conf  dump.rdb  redis-benchmark  redis-check-aof  redis-check-rdb  redis-cli  redis-sentinel  redis-server
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@wangpengliang bin<span style=color:#f92672>]</span><span style=color:#75715e># cd conf</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@wangpengliang conf<span style=color:#f92672>]</span><span style=color:#75715e># ls</span>
</span></span><span style=display:flex><span>redis.conf
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@wangpengliang conf<span style=color:#f92672>]</span><span style=color:#75715e># cp redis.conf redis80.conf</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@wangpengliang conf<span style=color:#f92672>]</span><span style=color:#75715e># cp redis.conf redis81.conf</span></span></span></code></pre></div><table><thead><tr><th style=text-align:center>ç±»å‹</th><th style=text-align:center>ç«¯å£</th><th style=text-align:center>é…ç½®æ–‡ä»¶</th></tr></thead><tbody><tr><td style=text-align:center>master</td><td style=text-align:center>6379</td><td style=text-align:center>redis.conf</td></tr><tr><td style=text-align:center>slave1</td><td style=text-align:center>6380</td><td style=text-align:center>redis80.conf</td></tr><tr><td style=text-align:center>slave2</td><td style=text-align:center>6381</td><td style=text-align:center>redis81.conf</td></tr></tbody></table><p>2)ï¼šä¿®æ”¹é…ç½®</p><ol><li><code>logfile</code></li><li><code>dbfilename</code></li><li><code>port</code></li><li><code>pidfile</code></li></ol><p>redis.conf</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>logfile <span style=color:#e6db74>&#34;6379.log&#34;</span>
</span></span><span style=display:flex><span>dbfilename dump6379.rdb</span></span></code></pre></div><p>redis80.conf</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>logfile <span style=color:#e6db74>&#34;6380.log&#34;</span>
</span></span><span style=display:flex><span>dbfilename dump6380.rdb
</span></span><span style=display:flex><span>port <span style=color:#ae81ff>6380</span>
</span></span><span style=display:flex><span>pidfile /var/run/redis_6380.pid</span></span></code></pre></div><p>redis81.conf</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>logfile <span style=color:#e6db74>&#34;6381.log&#34;</span>
</span></span><span style=display:flex><span>dbfilename dump6381.rdb
</span></span><span style=display:flex><span>port <span style=color:#ae81ff>6381</span>
</span></span><span style=display:flex><span>pidfile /var/run/redis_6381.pid</span></span></code></pre></div><p>3)ï¼šæŸ¥çœ‹Redisè¿›ç¨‹ä¿¡æ¯</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>root@wangpengliang conf<span style=color:#f92672>]</span><span style=color:#75715e># ps -ef|grep redis</span>
</span></span><span style=display:flex><span>root       <span style=color:#ae81ff>2679</span>      <span style=color:#ae81ff>1</span>  <span style=color:#ae81ff>0</span> 02:53 ?        00:00:00 ./redis-server 0.0.0.0:6379
</span></span><span style=display:flex><span>root       <span style=color:#ae81ff>2685</span>      <span style=color:#ae81ff>1</span>  <span style=color:#ae81ff>0</span> 02:54 ?        00:00:00 ./redis-server 0.0.0.0:6380
</span></span><span style=display:flex><span>root       <span style=color:#ae81ff>2691</span>      <span style=color:#ae81ff>1</span>  <span style=color:#ae81ff>0</span> 02:54 ?        00:00:00 ./redis-server 0.0.0.0:6381
</span></span><span style=display:flex><span>root       <span style=color:#ae81ff>2697</span>   <span style=color:#ae81ff>2643</span>  <span style=color:#ae81ff>0</span> 02:54 pts/3    00:00:00 grep --color<span style=color:#f92672>=</span>auto redis</span></span></code></pre></div><p>4)ï¼šè®¾ç½®ä¸»ä»ï¼š<code>SLAVEOF {host} {port}</code></p><p>80</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>root@wangpengliang bin<span style=color:#f92672>]</span><span style=color:#75715e># ./redis-cli -p 6380</span>
</span></span><span style=display:flex><span>127.0.0.1:6380&gt; SLAVEOF 0.0.0.0 <span style=color:#ae81ff>6379</span>
</span></span><span style=display:flex><span>OK
</span></span><span style=display:flex><span>127.0.0.1:6380&gt; info replication
</span></span><span style=display:flex><span><span style=color:#75715e># Replication</span>
</span></span><span style=display:flex><span>role:slave
</span></span><span style=display:flex><span>master_host:0.0.0.0
</span></span><span style=display:flex><span>master_port:6379
</span></span><span style=display:flex><span>master_link_status:up
</span></span><span style=display:flex><span>master_last_io_seconds_ago:0
</span></span><span style=display:flex><span>master_sync_in_progress:0
</span></span><span style=display:flex><span>slave_repl_offset:28
</span></span><span style=display:flex><span>slave_priority:100
</span></span><span style=display:flex><span>slave_read_only:1
</span></span><span style=display:flex><span>connected_slaves:0
</span></span><span style=display:flex><span>master_failover_state:no-failover
</span></span><span style=display:flex><span>master_replid:fb828085ccb5c0b804cfa2e8112656aef5f561c8
</span></span><span style=display:flex><span>master_replid2:0000000000000000000000000000000000000000
</span></span><span style=display:flex><span>master_repl_offset:28
</span></span><span style=display:flex><span>second_repl_offset:-1
</span></span><span style=display:flex><span>repl_backlog_active:1
</span></span><span style=display:flex><span>repl_backlog_size:1048576
</span></span><span style=display:flex><span>repl_backlog_first_byte_offset:1
</span></span><span style=display:flex><span>repl_backlog_histlen:28</span></span></code></pre></div><p>81</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>root@wangpengliang bin<span style=color:#f92672>]</span><span style=color:#75715e># ./redis-cli -p 6381</span>
</span></span><span style=display:flex><span>127.0.0.1:6381&gt; clear
</span></span><span style=display:flex><span>127.0.0.1:6381&gt; SLAVEOF 0.0.0.0 <span style=color:#ae81ff>6379</span>
</span></span><span style=display:flex><span>OK
</span></span><span style=display:flex><span>127.0.0.1:6381&gt; info replication
</span></span><span style=display:flex><span><span style=color:#75715e># Replication</span>
</span></span><span style=display:flex><span>role:slave
</span></span><span style=display:flex><span>master_host:0.0.0.0
</span></span><span style=display:flex><span>master_port:6379
</span></span><span style=display:flex><span>master_link_status:up
</span></span><span style=display:flex><span>master_last_io_seconds_ago:1
</span></span><span style=display:flex><span>master_sync_in_progress:0
</span></span><span style=display:flex><span>slave_repl_offset:210
</span></span><span style=display:flex><span>slave_priority:100
</span></span><span style=display:flex><span>slave_read_only:1
</span></span><span style=display:flex><span>connected_slaves:0
</span></span><span style=display:flex><span>master_failover_state:no-failover
</span></span><span style=display:flex><span>master_replid:fb828085ccb5c0b804cfa2e8112656aef5f561c8
</span></span><span style=display:flex><span>master_replid2:0000000000000000000000000000000000000000
</span></span><span style=display:flex><span>master_repl_offset:210
</span></span><span style=display:flex><span>second_repl_offset:-1
</span></span><span style=display:flex><span>repl_backlog_active:1
</span></span><span style=display:flex><span>repl_backlog_size:1048576
</span></span><span style=display:flex><span>repl_backlog_first_byte_offset:183
</span></span><span style=display:flex><span>repl_backlog_histlen:28</span></span></code></pre></div><p>79ï¼ˆmasterï¼‰</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>127.0.0.1:6379&gt; info replication
</span></span><span style=display:flex><span><span style=color:#75715e># Replication</span>
</span></span><span style=display:flex><span>role:master
</span></span><span style=display:flex><span>connected_slaves:2
</span></span><span style=display:flex><span>slave0:ip<span style=color:#f92672>=</span>127.0.0.1,port<span style=color:#f92672>=</span>6380,state<span style=color:#f92672>=</span>online,offset<span style=color:#f92672>=</span>210,lag<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>slave1:ip<span style=color:#f92672>=</span>127.0.0.1,port<span style=color:#f92672>=</span>6381,state<span style=color:#f92672>=</span>online,offset<span style=color:#f92672>=</span>210,lag<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>master_failover_state:no-failover
</span></span><span style=display:flex><span>master_replid:fb828085ccb5c0b804cfa2e8112656aef5f561c8
</span></span><span style=display:flex><span>master_replid2:0000000000000000000000000000000000000000
</span></span><span style=display:flex><span>master_repl_offset:210
</span></span><span style=display:flex><span>second_repl_offset:-1
</span></span><span style=display:flex><span>repl_backlog_active:1
</span></span><span style=display:flex><span>repl_backlog_size:1048576
</span></span><span style=display:flex><span>repl_backlog_first_byte_offset:1
</span></span><span style=display:flex><span>repl_backlog_histlen:210</span></span></code></pre></div><p><strong>æ³¨æ„</strong>ï¼šä½¿ç”¨å‘½ä»¤çš„æ–¹å¼é›†ç¾¤æ˜¯æš‚æ—¶çš„ï¼›å¦‚æœéœ€è¦æ°¸ä¹…ç”Ÿæ•ˆéœ€è¦ä¿®æ”¹é…ç½®æ–‡ä»¶</p><p>5)ï¼šä¿®æ”¹é…ç½®æ–‡ä»¶è®¾ç½®ä¸»ä»</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>replicaof &lt;masterip&gt; &lt;masterport&gt;</span></span></code></pre></div><p>redis80.conf</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>replicaof 0.0.0.0 <span style=color:#ae81ff>6379</span></span></span></code></pre></div><p>redis81.conf</p><pre tabindex=0><code>replicaof 0.0.0.0 6379</code></pre><p>å¦‚æœä¸»æœºæœ‰å¯†ç é€šè¿‡ <code>masterauth &lt;master-password></code> è®¾ç½®ã€‚</p><p><strong>æ³¨æ„</strong></p><ul><li>ä¸»æœºå¯å†™ï¼Œä»æœºåªèƒ½è¯»ä¸èƒ½å†™</li><li>ä¸»æœºä¸­æ•°æ®ä¼šè‡ªåŠ¨å¤‡ä»½åˆ°ä»æœº</li></ul><p>6)ï¼šä¸»æœºå®•æœºæµ‹è¯•</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>127.0.0.1:6379&gt; SHUTDOWN
</span></span><span style=display:flex><span>not connected&gt; exit</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>root@wangpengliang bin<span style=color:#f92672>]</span><span style=color:#75715e># ps -ef|grep redis</span>
</span></span><span style=display:flex><span>root       <span style=color:#ae81ff>2723</span>      <span style=color:#ae81ff>1</span>  <span style=color:#ae81ff>0</span> 03:12 ?        00:00:00 ./redis-server 0.0.0.0:6380
</span></span><span style=display:flex><span>root       <span style=color:#ae81ff>2728</span>   <span style=color:#ae81ff>2605</span>  <span style=color:#ae81ff>0</span> 03:12 pts/1    00:00:00 ./redis-cli -p <span style=color:#ae81ff>6380</span>
</span></span><span style=display:flex><span>root       <span style=color:#ae81ff>2730</span>      <span style=color:#ae81ff>1</span>  <span style=color:#ae81ff>0</span> 03:12 ?        00:00:00 ./redis-server 0.0.0.0:6381
</span></span><span style=display:flex><span>root       <span style=color:#ae81ff>2735</span>   <span style=color:#ae81ff>2624</span>  <span style=color:#ae81ff>0</span> 03:12 pts/2    00:00:00 ./redis-cli -p <span style=color:#ae81ff>6381</span>
</span></span><span style=display:flex><span>root       <span style=color:#ae81ff>2738</span>   <span style=color:#ae81ff>2643</span>  <span style=color:#ae81ff>0</span> 03:16 pts/3    00:00:00 grep --color<span style=color:#f92672>=</span>auto redis</span></span></code></pre></div><p>80</p><p>æ­¤æ—¶å¹¶æ²¡æœ‰é…ç½®å“¨å…µï¼Œæ‰€ä»¥åœ¨ <code>Master</code> 79å®•æœºåï¼Œ80ä¾æ—§æ˜¯ä»æœºã€‚</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>127.0.0.1:6380&gt; info replication
</span></span><span style=display:flex><span><span style=color:#75715e># Replication</span>
</span></span><span style=display:flex><span>role:slave
</span></span><span style=display:flex><span>master_host:0.0.0.0
</span></span><span style=display:flex><span>master_port:6379
</span></span><span style=display:flex><span>master_link_status:down
</span></span><span style=display:flex><span>master_last_io_seconds_ago:-1
</span></span><span style=display:flex><span>master_sync_in_progress:0
</span></span><span style=display:flex><span>slave_repl_offset:1130
</span></span><span style=display:flex><span>master_link_down_since_seconds:17
</span></span><span style=display:flex><span>slave_priority:100
</span></span><span style=display:flex><span>slave_read_only:1
</span></span><span style=display:flex><span>connected_slaves:0
</span></span><span style=display:flex><span>master_failover_state:no-failover
</span></span><span style=display:flex><span>master_replid:fb828085ccb5c0b804cfa2e8112656aef5f561c8
</span></span><span style=display:flex><span>master_replid2:0000000000000000000000000000000000000000
</span></span><span style=display:flex><span>master_repl_offset:1130
</span></span><span style=display:flex><span>second_repl_offset:-1
</span></span><span style=display:flex><span>repl_backlog_active:1
</span></span><span style=display:flex><span>repl_backlog_size:1048576
</span></span><span style=display:flex><span>repl_backlog_first_byte_offset:771
</span></span><span style=display:flex><span>repl_backlog_histlen:360</span></span></code></pre></div><ul><li>ä¸»æœºæ–­çº¿é‡è¿åï¼Œä»æœºä¾æ—§å¯ä»¥è¯»å–åˆ°ä¸»æœºçš„å€¼</li><li>ä»æœºæ–­çº¿é‡è¿åï¼Œä»æœºä¾æ—§å¯ä»¥è¯»å–åˆ°ä¸»æœºçš„å€¼</li></ul><p>7)ï¼šæ‰‹åŠ¨åˆ‡æ¢ä¸»èŠ‚ç‚¹</p><p>æ­¤æ—¶ä½¿ç”¨ <code>Slaveof no one</code> å‘½ä»¤å¯ä»¥ä½¿80å˜æˆä¸»æœºã€‚</p><h2 id=sentinelå“¨å…µæ¨¡å¼>Sentinelï¼ˆå“¨å…µï¼‰æ¨¡å¼<a class=anchor href=#sentinel%e5%93%a8%e5%85%b5%e6%a8%a1%e5%bc%8f>#</a></h2><p>ä¸»ä»åˆ‡æ¢çš„æ–¹æ³•æ˜¯ï¼šå½“ä¸»æœåŠ¡å™¨å®•æœºåï¼Œéœ€è¦æ‰‹åŠ¨æŠŠä»æœåŠ¡å™¨åˆ‡æ¢ä¸ºä¸»æœåŠ¡å™¨ï¼Œè¿™å°±éœ€è¦äººå·¥å¹²é¢„ï¼Œè´¹äº‹è´¹åŠ›ï¼Œè¿˜ä¼šé€ æˆä¸€æ®µæ—¶é—´å†…æœåŠ¡ä¸å¯ç”¨ã€‚è¿™ä¸æ˜¯ä¸€ç§æ¨èçš„æ–¹å¼ã€‚å“¨å…µæ¨¡å¼æ˜¯ä¸€ç§ç‰¹æ®Šçš„æ¨¡å¼ï¼Œé¦–å…ˆ Redis æä¾›äº†å“¨å…µçš„å‘½ä»¤ï¼Œå“¨å…µæ˜¯ä¸€ä¸ªç‹¬ç«‹çš„è¿›ç¨‹ï¼Œä½œä¸ºè¿›ç¨‹ï¼Œå®ƒä¼šç‹¬ç«‹è¿è¡Œã€‚å…¶åŸç†æ˜¯ï¼šå“¨å…µé€šè¿‡å‘é€å‘½ä»¤ç­‰å¾…RedisæœåŠ¡å™¨å“åº”ï¼Œä»è€Œç›‘æ§è¿è¡Œçš„å¤šä¸ªRediså®ä¾‹ã€‚</p><h3 id=å“¨å…µä½œç”¨>å“¨å…µä½œç”¨<a class=anchor href=#%e5%93%a8%e5%85%b5%e4%bd%9c%e7%94%a8>#</a></h3><ul><li>é€šè¿‡å‘é€å‘½ä»¤ï¼Œè®© Redis æœåŠ¡å™¨è¿”å›ç›‘æ§å…¶è¿è¡ŒçŠ¶æ€ï¼ŒåŒ…æ‹¬ä¸»æœåŠ¡å™¨å’Œä»æœåŠ¡å™¨</li><li>å½“å“¨å…µç›‘æµ‹åˆ° master å®•æœºï¼Œä¼šè‡ªåŠ¨å°† slaveåˆ‡æ¢æˆ master ï¼Œç„¶åé€šè¿‡ å‘å¸ƒè®¢é˜…æ¨¡å¼é€šçŸ¥å…¶ä»–çš„ä»æœºä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œè®©å®ƒä»¬åˆ‡æ¢ä¸»æœº</li><li>master åˆ‡æ¢åï¼Œ<code>master_redis.conf</code> ã€<code>slave_redis.conf</code> å’Œ <code>sentinel.conf</code> çš„å†…å®¹éƒ½ä¼šå‘ç”Ÿæ”¹å˜ï¼Œ<code>master_redis.conf</code> ä¸­ä¼šå¤šä¸€è¡Œ <code>slaveof </code>çš„é…ç½®ï¼Œ<code>sentinel.conf</code> çš„ç›‘æ§ç›®æ ‡ä¼šéšä¹‹è°ƒæ¢</li><li>ä¸€ä¸ªå“¨å…µè¿›ç¨‹å¯¹ <code>Redis</code> æœåŠ¡å™¨è¿›è¡Œç›‘æ§ï¼Œå¯èƒ½ä¼šå‡ºç°é—®é¢˜ï¼Œä¸ºæ­¤å¯ä»¥ä½¿ç”¨å¤šä¸ªå“¨å…µè¿›è¡Œç›‘æ§ã€‚å„ä¸ªå“¨å…µä¹‹é—´è¿˜ä¼šè¿›è¡Œç›‘æ§ï¼Œè¿™å°±å½¢æˆäº†å¤šå“¨å…µæ¨¡å¼</li></ul><h3 id=æ•…éšœåˆ‡æ¢failoverè¿‡ç¨‹>æ•…éšœåˆ‡æ¢ï¼ˆfailoverï¼‰è¿‡ç¨‹<a class=anchor href=#%e6%95%85%e9%9a%9c%e5%88%87%e6%8d%a2failover%e8%bf%87%e7%a8%8b>#</a></h3><ul><li>å‡è®¾ä¸»æœåŠ¡å™¨å®•æœºï¼Œå“¨å…µ1å…ˆæ£€æµ‹åˆ°è¿™ä¸ªç»“æœï¼Œç³»ç»Ÿå¹¶ä¸ä¼šé©¬ä¸Šè¿›è¡Œ <code>failover</code>ï¼Œä»…ä»…æ˜¯å“¨å…µ1ä¸»è§‚çš„è®¤ä¸ºä¸»æœåŠ¡å™¨ä¸å¯ç”¨ï¼Œè¿™ä¸ªç°è±¡ç§°ä¸º <strong>ä¸»è§‚ä¸‹çº¿</strong></li><li>å½“åé¢çš„å“¨å…µä¹Ÿæ£€æµ‹åˆ°ä¸»æœåŠ¡å™¨ä¸å¯ç”¨ï¼Œå¹¶ä¸”æ•°é‡è¾¾åˆ°ä¸€å®šå€¼æ—¶ï¼Œé‚£ä¹ˆå“¨å…µä¹‹é—´å°±ä¼šè¿›è¡Œä¸€æ¬¡æŠ•ç¥¨ï¼ŒæŠ•ç¥¨çš„ç»“æœç”±ä¸€ä¸ªå“¨å…µå‘èµ·ï¼Œè¿›è¡Œ <code>failover</code> ã€‚åˆ‡æ¢æˆåŠŸåï¼Œå°±ä¼šé€šè¿‡å‘å¸ƒè®¢é˜…æ¨¡å¼ï¼Œè®©å„ä¸ªå“¨å…µæŠŠè‡ªå·±ç›‘æ§çš„ä»æœåŠ¡å™¨å®ç°åˆ‡æ¢ä¸»æœºï¼Œè¿™ä¸ªè¿‡ç¨‹ç§°ä¸º <strong>å®¢è§‚ä¸‹çº¿</strong></li></ul><h3 id=å“¨å…µå·¥ä½œæ–¹å¼>å“¨å…µå·¥ä½œæ–¹å¼<a class=anchor href=#%e5%93%a8%e5%85%b5%e5%b7%a5%e4%bd%9c%e6%96%b9%e5%bc%8f>#</a></h3><ul><li>æ¯ä¸ª<code>sentinel</code>ä»¥æ¯ç§’é’Ÿä¸€æ¬¡çš„é¢‘ç‡å‘å®ƒæ‰€çŸ¥çš„<code>master</code>ã€<code>slave</code>ã€ <code>sentinel</code> å®ä¾‹å‘é€ä¸€ä¸ª <code>PING</code> å‘½ä»¤</li><li>å¦‚æœä¸€ä¸ªå®ä¾‹ï¼ˆ<code>instance</code>ï¼‰è·ç¦»æœ€åä¸€æ¬¡æœ‰æ•ˆå›å¤ <code>PING</code> å‘½ä»¤çš„æ—¶é—´è¶…è¿‡ <code>down-after-milliseconds</code>é€‰é¡¹æ‰€æŒ‡å®šçš„å€¼ï¼Œ åˆ™è¿™ä¸ªå®ä¾‹ä¼šè¢« <code>sentinel</code> æ ‡è®°ä¸ºä¸»è§‚ä¸‹çº¿</li><li>å¦‚æœä¸€ä¸ª<code>master</code>è¢«æ ‡è®°ä¸ºä¸»è§‚ä¸‹çº¿ï¼Œåˆ™æ­£åœ¨ç›‘è§†è¿™ä¸ª<code>master</code>çš„æ‰€æœ‰ <code>sentinels</code> è¦ä»¥æ¯ç§’ä¸€æ¬¡çš„é¢‘ç‡ç¡®è®¤<code>master</code> çš„ç¡®è¿›å…¥äº†ä¸»è§‚ä¸‹çº¿çŠ¶æ€</li><li>å½“æœ‰è¶³å¤Ÿæ•°é‡çš„ <code>sentinel</code>ï¼ˆå¤§äºç­‰äºé…ç½®æ–‡ä»¶æŒ‡å®šçš„å€¼ï¼‰åœ¨æŒ‡å®šçš„æ—¶é—´èŒƒå›´å†…ç¡®è®¤ <code>master</code> çš„ç¡®è¿›å…¥äº†ä¸»è§‚ä¸‹çº¿çŠ¶æ€ï¼Œåˆ™ <code>master</code> ä¼šè¢«æ ‡è®°ä¸ºå®¢è§‚ä¸‹çº¿</li><li>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œ æ¯ä¸ª <code>sentinel</code> ä¼šä»¥æ¯ 10 ç§’ä¸€æ¬¡çš„é¢‘ç‡å‘å®ƒå·²çŸ¥çš„æ‰€æœ‰ <code>master</code>ã€<code>slave</code>å‘é€ <code>INFO </code>å‘½ä»¤</li><li>å½“<code>master</code>è¢« <code>sentinel</code> æ ‡è®°ä¸ºå®¢è§‚ä¸‹çº¿æ—¶ï¼Œ<code>sentinel</code> å‘ <code>master</code> çš„æ‰€æœ‰ <code>slave</code> å‘é€ <code>INFO</code> å‘½ä»¤çš„é¢‘ç‡ä¼šä» 10 ç§’ä¸€æ¬¡æ”¹ä¸ºæ¯ç§’ä¸€æ¬¡</li><li>è‹¥æ²¡æœ‰è¶³å¤Ÿæ•°é‡çš„ <code>sentinel</code> åŒæ„ <code>master</code> å·²ç»ä¸‹çº¿ï¼Œ <code>master</code> çš„å®¢è§‚ä¸‹çº¿çŠ¶æ€å°±ä¼šè¢«ç§»é™¤ã€‚è‹¥<code>master</code> é‡æ–°å‘ <code>sentinel</code> çš„ <code>PING</code> å‘½ä»¤è¿”å›æœ‰æ•ˆå›å¤ï¼Œ<code>master</code> çš„ä¸»è§‚ä¸‹çº¿çŠ¶æ€å°±ä¼šè¢«ç§»é™¤</li></ul><h3 id=å“¨å…µæ¨¡å¼ä¼˜ç¼ºç‚¹>å“¨å…µæ¨¡å¼ä¼˜ç¼ºç‚¹<a class=anchor href=#%e5%93%a8%e5%85%b5%e6%a8%a1%e5%bc%8f%e4%bc%98%e7%bc%ba%e7%82%b9>#</a></h3><p><strong>ä¼˜ç‚¹</strong></p><ul><li>å“¨å…µæ¨¡å¼æ˜¯åŸºäºä¸»ä»æ¨¡å¼çš„ï¼Œæ‰€æœ‰ä¸»ä»çš„ä¼˜ç‚¹å“¨å…µæ¨¡å¼éƒ½å…·æœ‰</li><li>ä¸»ä»å¯ä»¥è‡ªåŠ¨åˆ‡æ¢ã€‚ç³»ç»Ÿæ›´å¥å£®ã€å¯ç”¨æ€§æ›´é«˜ï¼ˆå¯ä»¥çœ‹ä½œè‡ªåŠ¨ç‰ˆçš„ä¸»ä»å¤åˆ¶ï¼‰</li></ul><p><strong>ç¼ºç‚¹</strong></p><ul><li>Redis è¾ƒéš¾æ”¯æŒåœ¨çº¿æ‰©å®¹ï¼Œåœ¨é›†ç¾¤å®¹é‡è¾¾åˆ°ä¸Šé™æ—¶åœ¨çº¿æ‰©å®¹ä¼šå˜å¾—å¾ˆå¤æ‚</li></ul><h3 id=å“¨å…µæ¨¡å¼æ­å»º>å“¨å…µæ¨¡å¼æ­å»º<a class=anchor href=#%e5%93%a8%e5%85%b5%e6%a8%a1%e5%bc%8f%e6%90%ad%e5%bb%ba>#</a></h3><p>1)ï¼šRediså®‰è£…ç›®å½•ä¸‹æœ‰ä¸€ä¸ª <code>sentinel.conf</code> æ–‡ä»¶ï¼Œ<code>copy </code>ä¸€ä»½è¿›è¡Œä¿®æ”¹</p><p>2)ï¼šé…ç½®å“¨å…µ</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># é…ç½®ç›‘å¬çš„ä¸»æœåŠ¡å™¨ï¼Œè¿™é‡Œsentinel monitorä»£è¡¨ç›‘æ§ï¼Œmymasterä»£è¡¨æœåŠ¡å™¨çš„åç§°ï¼Œå¯ä»¥è‡ªå®šä¹‰</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 192.168.11.128ä»£è¡¨ç›‘æ§çš„ä¸»æœåŠ¡å™¨ï¼Œ6379ä»£è¡¨ç«¯å£ï¼Œ2ä»£è¡¨åªæœ‰ä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„å“¨å…µè®¤ä¸ºä¸»æœåŠ¡å™¨ä¸å¯ç”¨çš„æ—¶å€™ï¼Œæ‰ä¼šè¿›è¡Œfailoveræ“ä½œã€‚æƒå€¼ä¸º2ï¼Œè¿™é‡Œçš„æƒå€¼ï¼Œæ˜¯ç”¨æ¥è®¡ç®—æˆ‘ä»¬éœ€è¦å°†å“ªä¸€å°æœåŠ¡å™¨å‡çº§å‡ä¸»æœåŠ¡å™¨</span>
</span></span><span style=display:flex><span>sentinel monitor mymaster 0.0.0.0 <span style=color:#ae81ff>6379</span> <span style=color:#ae81ff>2</span></span></span></code></pre></div><p>3)ï¼šå¯åŠ¨å“¨å…µ</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>root@wangpengliang bin<span style=color:#f92672>]</span><span style=color:#75715e># ./redis-sentinel conf/sentinel.conf</span>
</span></span><span style=display:flex><span>2821:X <span style=color:#ae81ff>19</span> Apr <span style=color:#ae81ff>2021</span> 04:13:16.075 <span style=color:#75715e># oO0OoO0OoO0Oo Redis is starting oO0OoO0OoO0Oo</span>
</span></span><span style=display:flex><span>2821:X <span style=color:#ae81ff>19</span> Apr <span style=color:#ae81ff>2021</span> 04:13:16.075 <span style=color:#75715e># Redis version=6.2.1, bits=64, commit=00000000, modified=0, pid=2821, just sta</span>
</span></span><span style=display:flex><span>rted2821:X <span style=color:#ae81ff>19</span> Apr <span style=color:#ae81ff>2021</span> 04:13:16.075 <span style=color:#75715e># Configuration loaded</span>
</span></span><span style=display:flex><span>2821:X <span style=color:#ae81ff>19</span> Apr <span style=color:#ae81ff>2021</span> 04:13:16.076 * Increased maximum number of open files to <span style=color:#ae81ff>10032</span> <span style=color:#f92672>(</span>it was originally set to <span style=color:#ae81ff>102</span>
</span></span><span style=display:flex><span>4<span style=color:#f92672>)</span>.2821:X <span style=color:#ae81ff>19</span> Apr <span style=color:#ae81ff>2021</span> 04:13:16.076 * monotonic clock: POSIX clock_gettime
</span></span><span style=display:flex><span>                _._                                                  
</span></span><span style=display:flex><span>           _.-<span style=color:#e6db74>``</span>__ <span style=color:#e6db74>&#39;&#39;</span>-._                                             
</span></span><span style=display:flex><span>      _.-<span style=color:#e6db74>``</span>    <span style=color:#e6db74>`</span>.  <span style=color:#e6db74>`</span>_.  <span style=color:#e6db74>&#39;&#39;</span>-._           Redis 6.2.1 <span style=color:#f92672>(</span>00000000/0<span style=color:#f92672>)</span> <span style=color:#ae81ff>64</span> bit
</span></span><span style=display:flex><span>  .-<span style=color:#e6db74>``</span> .-<span style=color:#e6db74>```</span>.  <span style=color:#e6db74>```</span><span style=color:#ae81ff>\/</span>    _.,_ <span style=color:#e6db74>&#39;&#39;</span>-._                                   
</span></span><span style=display:flex><span> <span style=color:#f92672>(</span>    <span style=color:#e6db74>&#39;      ,       .-`  | `,    )     Running in sentinel mode
</span></span></span><span style=display:flex><span><span style=color:#e6db74> |`-._`-...-` __...-.``-._|&#39;</span><span style=color:#e6db74>`</span> _.-<span style=color:#e6db74>&#39;|     Port: 26379
</span></span></span><span style=display:flex><span><span style=color:#e6db74> |    `-._   `._    /     _.-&#39;</span>    |     PID: <span style=color:#ae81ff>2821</span>
</span></span><span style=display:flex><span>  <span style=color:#e6db74>`</span>-._    <span style=color:#e6db74>`</span>-._  <span style=color:#e6db74>`</span>-./  _.-<span style=color:#e6db74>&#39;    _.-&#39;</span>                                   
</span></span><span style=display:flex><span> |<span style=color:#e6db74>`</span>-._<span style=color:#e6db74>`</span>-._    <span style=color:#e6db74>`</span>-.__.-<span style=color:#e6db74>&#39;    _.-&#39;</span>_.-<span style=color:#e6db74>&#39;|                                  
</span></span></span><span style=display:flex><span><span style=color:#e6db74> |    `-._`-._        _.-&#39;</span>_.-<span style=color:#e6db74>&#39;    |           http://redis.io        
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  `-._    `-._`-.__.-&#39;</span>_.-<span style=color:#e6db74>&#39;    _.-&#39;</span>                                   
</span></span><span style=display:flex><span> |<span style=color:#e6db74>`</span>-._<span style=color:#e6db74>`</span>-._    <span style=color:#e6db74>`</span>-.__.-<span style=color:#e6db74>&#39;    _.-&#39;</span>_.-<span style=color:#e6db74>&#39;|                                  
</span></span></span><span style=display:flex><span><span style=color:#e6db74> |    `-._`-._        _.-&#39;</span>_.-<span style=color:#e6db74>&#39;    |                                  
</span></span></span><span style=display:flex><span><span style=color:#e6db74>  `-._    `-._`-.__.-&#39;</span>_.-<span style=color:#e6db74>&#39;    _.-&#39;</span>                                   
</span></span><span style=display:flex><span>      <span style=color:#e6db74>`</span>-._    <span style=color:#e6db74>`</span>-.__.-<span style=color:#e6db74>&#39;    _.-&#39;</span>                                       
</span></span><span style=display:flex><span>          <span style=color:#e6db74>`</span>-._        _.-<span style=color:#e6db74>&#39;                                           
</span></span></span><span style=display:flex><span><span style=color:#e6db74>              `-.__.-&#39;</span>                                               
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>2821:X <span style=color:#ae81ff>19</span> Apr <span style=color:#ae81ff>2021</span> 04:13:16.076 <span style=color:#75715e># WARNING: The TCP backlog setting of 511 cannot be enforced because /proc/sys/</span>
</span></span><span style=display:flex><span>net/core/somaxconn is set to the lower value of 128.2821:X <span style=color:#ae81ff>19</span> Apr <span style=color:#ae81ff>2021</span> 04:13:16.077 <span style=color:#75715e># Sentinel ID is fdcb482b76a22f67429b1473ddc33d0d3769f7f3</span>
</span></span><span style=display:flex><span>2821:X <span style=color:#ae81ff>19</span> Apr <span style=color:#ae81ff>2021</span> 04:13:16.077 <span style=color:#75715e># +monitor master mymaster 0.0.0.0 6379 quorum 1</span>
</span></span><span style=display:flex><span>2821:X <span style=color:#ae81ff>19</span> Apr <span style=color:#ae81ff>2021</span> 04:13:16.078 * +slave slave 127.0.0.1:6380 127.0.0.1 <span style=color:#ae81ff>6380</span> @ mymaster 0.0.0.0 <span style=color:#ae81ff>6379</span>
</span></span><span style=display:flex><span>2821:X <span style=color:#ae81ff>19</span> Apr <span style=color:#ae81ff>2021</span> 04:13:16.080 * +slave slave 127.0.0.1:6381 127.0.0.1 <span style=color:#ae81ff>6381</span> @ mymaster 0.0.0.0 <span style=color:#ae81ff>6379</span></span></span></code></pre></div><p>Sentinel å¯åŠ¨ä¹‹åï¼Œå°±ä¼šç›‘è§†åˆ°ç°åœ¨æœ‰ä¸€ä¸ªä¸»æœåŠ¡å™¨ï¼Œä¸¤ä¸ªä»æœåŠ¡å™¨ï¼›å½“æŠŠå…¶ä¸­ä¸€ä¸ªä»æœåŠ¡å™¨å™¨å…³é—­ä¹‹åï¼Œå¯ä»¥çœ‹åˆ°æ—¥å¿—</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>2821:X <span style=color:#ae81ff>19</span> Apr <span style=color:#ae81ff>2021</span> 04:14:03.125 <span style=color:#75715e># +sdown master mymaster 0.0.0.0 6379</span>
</span></span><span style=display:flex><span>2821:X <span style=color:#ae81ff>19</span> Apr <span style=color:#ae81ff>2021</span> 04:14:03.125 <span style=color:#75715e># +odown master mymaster 0.0.0.0 6379 #quorum 1/1</span>
</span></span><span style=display:flex><span>2821:X <span style=color:#ae81ff>19</span> Apr <span style=color:#ae81ff>2021</span> 04:14:03.125 <span style=color:#75715e># +new-epoch 1</span>
</span></span><span style=display:flex><span>2821:X <span style=color:#ae81ff>19</span> Apr <span style=color:#ae81ff>2021</span> 04:14:03.125 <span style=color:#75715e># +try-failover master mymaster 0.0.0.0 6379</span>
</span></span><span style=display:flex><span>2821:X <span style=color:#ae81ff>19</span> Apr <span style=color:#ae81ff>2021</span> 04:14:03.132 <span style=color:#75715e># +vote-for-leader fdcb482b76a22f67429b1473ddc33d0d3769f7f3 1</span>
</span></span><span style=display:flex><span>2821:X <span style=color:#ae81ff>19</span> Apr <span style=color:#ae81ff>2021</span> 04:14:03.132 <span style=color:#75715e># +elected-leader master mymaster 0.0.0.0 6379</span>
</span></span><span style=display:flex><span>2821:X <span style=color:#ae81ff>19</span> Apr <span style=color:#ae81ff>2021</span> 04:14:03.132 <span style=color:#75715e># +failover-state-select-slave master mymaster 0.0.0.0 6379</span>
</span></span><span style=display:flex><span>2821:X <span style=color:#ae81ff>19</span> Apr <span style=color:#ae81ff>2021</span> 04:14:03.199 <span style=color:#75715e># +selected-slave slave 127.0.0.1:6380 127.0.0.1 6380 @ mymaster 0.0.0.0 6379</span>
</span></span><span style=display:flex><span>2821:X <span style=color:#ae81ff>19</span> Apr <span style=color:#ae81ff>2021</span> 04:14:03.199 * +failover-state-send-slaveof-noone slave 127.0.0.1:6380 127.0.0.1 <span style=color:#ae81ff>6380</span> @ myma
</span></span><span style=display:flex><span>ster 0.0.0.0 63792821:X <span style=color:#ae81ff>19</span> Apr <span style=color:#ae81ff>2021</span> 04:14:03.282 * +failover-state-wait-promotion slave 127.0.0.1:6380 127.0.0.1 <span style=color:#ae81ff>6380</span> @ mymaster
</span></span><span style=display:flex><span> 0.0.0.0 63792821:X <span style=color:#ae81ff>19</span> Apr <span style=color:#ae81ff>2021</span> 04:14:03.288 <span style=color:#75715e># +promoted-slave slave 127.0.0.1:6380 127.0.0.1 6380 @ mymaster 0.0.0.0 6379</span>
</span></span><span style=display:flex><span>2821:X <span style=color:#ae81ff>19</span> Apr <span style=color:#ae81ff>2021</span> 04:14:03.288 <span style=color:#75715e># +failover-state-reconf-slaves master mymaster 0.0.0.0 6379</span>
</span></span><span style=display:flex><span>2821:X <span style=color:#ae81ff>19</span> Apr <span style=color:#ae81ff>2021</span> 04:14:03.340 * +slave-reconf-sent slave 127.0.0.1:6381 127.0.0.1 <span style=color:#ae81ff>6381</span> @ mymaster 0.0.0.0 <span style=color:#ae81ff>637</span>
</span></span><span style=display:flex><span>92821:X <span style=color:#ae81ff>19</span> Apr <span style=color:#ae81ff>2021</span> 04:14:04.312 * +slave-reconf-inprog slave 127.0.0.1:6381 127.0.0.1 <span style=color:#ae81ff>6381</span> @ mymaster 0.0.0.0 <span style=color:#ae81ff>6</span>
</span></span><span style=display:flex><span>3792821:X <span style=color:#ae81ff>19</span> Apr <span style=color:#ae81ff>2021</span> 04:14:04.312 * +slave-reconf-done slave 127.0.0.1:6381 127.0.0.1 <span style=color:#ae81ff>6381</span> @ mymaster 0.0.0.0 <span style=color:#ae81ff>637</span>
</span></span><span style=display:flex><span>92821:X <span style=color:#ae81ff>19</span> Apr <span style=color:#ae81ff>2021</span> 04:14:04.378 <span style=color:#75715e># +failover-end master mymaster 0.0.0.0 6379</span>
</span></span><span style=display:flex><span>2821:X <span style=color:#ae81ff>19</span> Apr <span style=color:#ae81ff>2021</span> 04:14:04.378 <span style=color:#75715e># +switch-master mymaster 0.0.0.0 6379 127.0.0.1 6380</span>
</span></span><span style=display:flex><span>2821:X <span style=color:#ae81ff>19</span> Apr <span style=color:#ae81ff>2021</span> 04:14:04.379 * +slave slave 127.0.0.1:6381 127.0.0.1 <span style=color:#ae81ff>6381</span> @ mymaster 127.0.0.1 <span style=color:#ae81ff>6380</span>
</span></span><span style=display:flex><span>2821:X <span style=color:#ae81ff>19</span> Apr <span style=color:#ae81ff>2021</span> 04:14:04.379 * +slave slave 0.0.0.0:6379 0.0.0.0 <span style=color:#ae81ff>6379</span> @ mymaster 127.0.0.1 <span style=color:#ae81ff>6380</span>
</span></span><span style=display:flex><span>2821:X <span style=color:#ae81ff>19</span> Apr <span style=color:#ae81ff>2021</span> 04:14:34.411 <span style=color:#75715e># +sdown slave 0.0.0.0:6379 0.0.0.0 6379 @ mymaster 127.0.0.1 6380</span></span></span></code></pre></div><p>æ­¤æ—¶Masterä»79è½¬ç§»åˆ°äº†80</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>127.0.0.1:6380&gt; info replication
</span></span><span style=display:flex><span><span style=color:#75715e># Replication</span>
</span></span><span style=display:flex><span>role:master
</span></span><span style=display:flex><span>connected_slaves:1
</span></span><span style=display:flex><span>slave0:ip<span style=color:#f92672>=</span>127.0.0.1,port<span style=color:#f92672>=</span>6381,state<span style=color:#f92672>=</span>online,offset<span style=color:#f92672>=</span>4615,lag<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>master_failover_state:no-failover
</span></span><span style=display:flex><span>master_replid:872d3e4c9538abb9f117dcc47de99ac57791433a
</span></span><span style=display:flex><span>master_replid2:612af05d7a22d2b35e595f43be74ddd771765798
</span></span><span style=display:flex><span>master_repl_offset:4615
</span></span><span style=display:flex><span>second_repl_offset:1212
</span></span><span style=display:flex><span>repl_backlog_active:1
</span></span><span style=display:flex><span>repl_backlog_size:1048576
</span></span><span style=display:flex><span>repl_backlog_first_byte_offset:1
</span></span><span style=display:flex><span>repl_backlog_histlen:4615</span></span></code></pre></div><p>79é‡æ–°è¿æ¥</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>root@wangpengliang bin<span style=color:#f92672>]</span><span style=color:#75715e># ./redis-server conf/redis.conf</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@wangpengliang bin<span style=color:#f92672>]</span><span style=color:#75715e># ./redis-cli -p 6379</span>
</span></span><span style=display:flex><span>127.0.0.1:6379&gt; ping
</span></span><span style=display:flex><span>PONG
</span></span><span style=display:flex><span>127.0.0.1:6379&gt; info replication
</span></span><span style=display:flex><span><span style=color:#75715e># Replication</span>
</span></span><span style=display:flex><span>role:slave
</span></span><span style=display:flex><span>master_host:127.0.0.1
</span></span><span style=display:flex><span>master_port:6380
</span></span><span style=display:flex><span>master_link_status:up
</span></span><span style=display:flex><span>master_last_io_seconds_ago:1
</span></span><span style=display:flex><span>master_sync_in_progress:0
</span></span><span style=display:flex><span>slave_repl_offset:35074
</span></span><span style=display:flex><span>slave_priority:100
</span></span><span style=display:flex><span>slave_read_only:1
</span></span><span style=display:flex><span>connected_slaves:0
</span></span><span style=display:flex><span>master_failover_state:no-failover
</span></span><span style=display:flex><span>master_replid:872d3e4c9538abb9f117dcc47de99ac57791433a
</span></span><span style=display:flex><span>master_replid2:0000000000000000000000000000000000000000
</span></span><span style=display:flex><span>master_repl_offset:35074
</span></span><span style=display:flex><span>second_repl_offset:-1
</span></span><span style=display:flex><span>repl_backlog_active:1
</span></span><span style=display:flex><span>repl_backlog_size:1048576
</span></span><span style=display:flex><span>repl_backlog_first_byte_offset:32735
</span></span><span style=display:flex><span>repl_backlog_histlen:2340</span></span></code></pre></div><p>79é‡æ–°è¿æ¥ååªèƒ½æ˜¯ä»æœºäº†ï¼Œmasterå·²ç»è¢«80æŠ¢å ã€‚</p><h2 id=cluster-é›†ç¾¤æ¨¡å¼>Cluster é›†ç¾¤æ¨¡å¼<a class=anchor href=#cluster-%e9%9b%86%e7%be%a4%e6%a8%a1%e5%bc%8f>#</a></h2><p>Redis Clusteræ˜¯ä¸€ç§æœåŠ¡å™¨ Sharding æŠ€æœ¯ï¼Œ3.0ç‰ˆæœ¬å¼€å§‹æ­£å¼æä¾›ã€‚Redis çš„å“¨å…µæ¨¡å¼åŸºæœ¬å·²ç»å¯ä»¥å®ç°é«˜å¯ç”¨ï¼Œè¯»å†™åˆ†ç¦» ï¼Œä½†æ˜¯åœ¨è¿™ç§æ¨¡å¼ä¸‹æ¯å° Redis æœåŠ¡å™¨éƒ½å­˜å‚¨ç›¸åŒçš„æ•°æ®ï¼Œå¾ˆæµªè´¹å†…å­˜ï¼Œæ‰€ä»¥åœ¨ Redis3.0ä¸ŠåŠ å…¥äº† Cluster é›†ç¾¤æ¨¡å¼ï¼Œå®ç°äº† Redis çš„åˆ†å¸ƒå¼å­˜å‚¨ã€‚ä¹Ÿå°±æ˜¯è¯´æ¯å° Redis èŠ‚ç‚¹ä¸Šå­˜å‚¨ä¸åŒçš„å†…å®¹ã€‚</p><h3 id=clusterç‰¹ç‚¹>Clusterç‰¹ç‚¹<a class=anchor href=#cluster%e7%89%b9%e7%82%b9>#</a></h3><ul><li>å¤šä¸»å¤šä»å»ä¸­å¿ƒåŒ–ï¼šä»èŠ‚ç‚¹ä½œä¸ºå¤‡ç”¨ï¼Œå¤åˆ¶ä¸»èŠ‚ç‚¹ï¼Œä¸åšè¯»å†™æ“ä½œä¸æä¾›æœåŠ¡ï¼ˆå¯é€šè¿‡ <code>readOnly</code> å®ç°åªè¯»ï¼‰</li><li>ä¸æ”¯æŒå¤„ç†å¤šä¸ªkeyï¼šå› ä¸ºæ•°æ®åˆ†æ•£åœ¨å¤šä¸ªèŠ‚ç‚¹ï¼Œåœ¨æ•°æ®é‡å¤§é«˜å¹¶å‘çš„æƒ…å†µä¸‹ä¼šå½±å“æ€§èƒ½</li><li>æ”¯æŒåŠ¨æ€æ‰©å®¹èŠ‚ç‚¹ï¼šRerdis Cluster æœ€å¤§çš„ä¼˜ç‚¹ä¹‹ä¸€</li><li>èŠ‚ç‚¹ä¹‹é—´ç›¸äº’é€šä¿¡ï¼Œç›¸äº’é€‰ä¸¾ï¼Œä¸å†ä¾èµ–Sentinelï¼šå‡†ç¡®æ¥è¯´æ˜¯ä¸»èŠ‚ç‚¹ä¹‹é—´ç›¸äº’â€œç›‘ç£â€ï¼Œä¿è¯åŠæ—¶æ•…éšœè½¬ç§»</li></ul><h3 id=clusteré›†ç¾¤æ¨¡å¼å¯¹æ¯”>Clusteré›†ç¾¤æ¨¡å¼å¯¹æ¯”<a class=anchor href=#cluster%e9%9b%86%e7%be%a4%e6%a8%a1%e5%bc%8f%e5%af%b9%e6%af%94>#</a></h3><ul><li>ç›¸æ¯”å“¨å…µæ¨¡å¼ï¼šå¤šä¸ªmasterèŠ‚ç‚¹ä¿è¯ä¸»è¦ä¸šåŠ¡ï¼ˆæ¯”å¦‚masterèŠ‚ç‚¹ä¸»è¦è´Ÿè´£å†™ï¼‰ç¨³å®šæ€§ï¼Œä¸éœ€è¦æ­å»ºå¤šä¸ªsentinelå®ä¾‹ç›‘æ§ä¸€ä¸ªmasterèŠ‚ç‚¹</li><li>ç›¸æ¯”ä¸€ä¸»å¤šä»æ¨¡å¼ï¼šä¸éœ€è¦æ‰‹åŠ¨åˆ‡æ¢ï¼Œå…·æœ‰è‡ªæˆ‘æ•…éšœæ£€æµ‹ï¼Œæ•…éšœè½¬ç§»çš„ç‰¹ç‚¹</li><li>ç›¸æ¯”å…¶å“¨å…µå’Œä¸»ä»ï¼šå¯¹æ•°æ®è¿›è¡Œåˆ†ç‰‡ï¼ˆshardingï¼‰ï¼Œä¸åŒèŠ‚ç‚¹å­˜å‚¨æ•°æ®ä¸ä¸€æ ·æ”¯æŒåŠ¨æ€æ‰©å®¹ã€‚ä»æŸç§ç¨‹åº¦ä¸Šæ¥è¯´ï¼ŒSentinelæ¨¡å¼ä¸»è¦é’ˆå¯¹é«˜å¯ç”¨ï¼ˆHAï¼‰ï¼Œè€ŒClusteræ¨¡å¼æ˜¯ä¸ä»…é’ˆå¯¹å¤§æ•°æ®é‡ï¼Œé«˜å¹¶å‘ï¼ŒåŒæ—¶ä¹Ÿæ”¯æŒHA</li></ul><h3 id=æ•°æ®å­˜å‚¨è®¾è®¡><strong>æ•°æ®å­˜å‚¨è®¾è®¡</strong><a class=anchor href=#%e6%95%b0%e6%8d%ae%e5%ad%98%e5%82%a8%e8%ae%be%e8%ae%a1>#</a></h3><ul><li>é€šè¿‡ç®—æ³•è®¾è®¡ï¼Œè®¡ç®—å‡ºkeyåº”è¯¥ä¿å­˜çš„ä½ç½®</li><li>å°†æ‰€æœ‰çš„å­˜å‚¨ç©ºé—´è®¡åˆ’åˆ‡å‰²æˆ<code>16384</code>ä»½ï¼Œæ¯å°ä¸»æœºä¿å­˜ä¸€éƒ¨åˆ†æ¯ä»½ä»£è¡¨çš„æ˜¯ä¸€ä¸ªå­˜å‚¨ç©ºé—´ï¼Œä¸æ˜¯ä¸€ä¸ª<code>key</code>çš„ä¿å­˜ç©ºé—´</li><li>å°†<code>key</code>æŒ‰ç…§è®¡ç®—å‡ºçš„ç»“æœæ”¾åˆ°å¯¹åº”çš„å­˜å‚¨ç©ºé—´</li></ul><p>1)ï¼š<code>key</code>é€šè¿‡<code>hash</code>ç®—æ³•è®¡ç®—å‡ºä¸€ä¸ªå€¼ï¼Œç„¶åæ‹¿è¿™ä¸ªå€¼<code>%16384</code></p><p>2)ï¼šå¾—åˆ°ä¸€ä¸ªæ•°ï¼ˆå‡å¦‚æ˜¯37ï¼‰ä¸ºkeyçš„ä¿å­˜ä½ç½®ï¼Œç„¶åå†å­˜å…¥ç›¸åº”çš„å­˜å‚¨ç©ºé—´ä½ç½®</p><p><img src=/images/2021-09-03-17-12-12.png alt></p><p>3)ï¼šå‡å¦‚åˆå¢åŠ äº†ä¸€ä¸ªèŠ‚ç‚¹ï¼Œä¹‹å‰æ¯ä¸ªèŠ‚ç‚¹éƒ½ä¼šæ‹¿å‡ºéƒ¨åˆ†æ§½ç»™æ–°çš„èŠ‚ç‚¹</p><p>4)ï¼šå¦‚æœæ˜¯å»é™¤èŠ‚ç‚¹ï¼Œåˆ™æŠŠè¢«å»é™¤èŠ‚ç‚¹çš„æ§½åŠ å…¥åˆ°å­˜åœ¨çš„èŠ‚ç‚¹å½“ä¸­</p><h3 id=å“ˆå¸Œæ§½slot>å“ˆå¸Œæ§½Slot<a class=anchor href=#%e5%93%88%e5%b8%8c%e6%a7%bdslot>#</a></h3><p>Redisé›†ç¾¤ä½¿ç”¨ä¸€ç§ç§°ä½œä¸€è‡´æ€§å“ˆå¸Œçš„å¤åˆåˆ†åŒºå½¢å¼ï¼ˆç»„åˆäº†å“ˆå¸Œåˆ†åŒºå’Œåˆ—è¡¨åˆ†è¢‚çš„ç‰¹å¾æ¥è®¡ç®—é”®çš„å½’å±å®ä¾‹ï¼‰ï¼Œé”®çš„<code>CRC16</code>å“ˆå¸Œå€¼è¢«ç§°ä¸ºå“ˆå¸Œæ§½ã€‚æ¯”å¦‚å¯¹äºä¸‰ä¸ªRedisèŠ‚ç‚¹ï¼Œå“ˆå¸Œæ§½çš„åˆ†é…æ–¹å¼å¦‚ä¸‹ï¼š</p><ul><li>ç¬¬ä¸€èŠ‚ç‚¹æ‹¥æœ‰<code>0-5500</code>å“ˆå¸Œæ§½</li><li>ç¬¬äºŒèŠ‚ç‚¹æ‹¥æœ‰<code>5501-11000</code>å“ˆå¸Œæ§½</li><li>ç¬¬ä¸‰èŠ‚ç‚¹æ‹¥æœ‰å‰©ä½™çš„<code>11001-16384</code>å“ˆå¸Œæ§½</li></ul><p>é€šè¿‡è®¡ç®—é”®çš„ <code>CRC16</code> å“ˆå¸Œå€¼ï¼Œç„¶åå¯¹16384è¿›è¡Œå–æ¨¡å¾—åˆ°ï¼š<code>HASH_SLOT=CRC16(key) modulo 16383</code>ï¼ŒRedisæä¾›äº†<strong>CLUSTER KEYSLOT</strong>å‘½ä»¤æ¥æ‰§è¡Œå“ˆå¸Œæ§½çš„è®¡ç®—ã€‚</p><p><strong>æ³¨æ„</strong>ï¼šé›†ç¾¤èŠ‚ç‚¹ä¿å­˜é”®å€¼å¯¹ä»¥åŠé”®å€¼å¯¹è¿‡æœŸæ—¶é—´çš„å¤„ç†æ–¹å¼ä¸Rediså•æœºæ¨¡å¼æ˜¯ä¸€æ ·çš„ï¼Œå”¯ä¸€ä¸åŒå°±æ˜¯èŠ‚ç‚¹åªèƒ½ä½¿ç”¨0å·æ•°æ®åº“ï¼Œè€Œå•æœºRedisæœåŠ¡å™¨åˆ™æ²¡æœ‰é™åˆ¶ã€‚</p><h3 id=é›†ç¾¤å†…éƒ¨é€šè®¯æœºåˆ¶>é›†ç¾¤å†…éƒ¨é€šè®¯æœºåˆ¶<a class=anchor href=#%e9%9b%86%e7%be%a4%e5%86%85%e9%83%a8%e9%80%9a%e8%ae%af%e6%9c%ba%e5%88%b6>#</a></h3><p>å„ä¸ªæ•°æ®åº“äº’ç›¸é€šä¿¡ï¼Œä¿å­˜å„ä¸ªåº“ä¸­æ§½çš„ç¼–å·æ•°æ®ã€‚</p><p>1)ï¼šå®¢æˆ·ç«¯å‘å‡ºä¸€ä¸ªkeyè®¿é—®Aï¼Œé€šè¿‡ç®—æ³•è®¡ç®—å‡ºkeyçš„å­˜å‚¨ä½ç½®</p><p>2)ï¼šå¦‚æœä¸€æ¬¡å‘½ä¸­ï¼Œç›´æ¥è¿”å›</p><p>3)ï¼šä¸€æ¬¡æœªå‘½ä¸­ï¼Œå‘ŠçŸ¥å…·ä½“ä½ç½®</p><p>4)ï¼šä¸€æ¬¡å‘½ä¸­æˆ–è€…ä¸¤æ¬¡å‘½ä¸­æé«˜æ•°æ®è®¿é—®æ•ˆç‡</p><p><img src=/images/2021-09-03-17-12-36.png alt></p><h3 id=clusteré›†ç¾¤æ­å»º>Clusteré›†ç¾¤æ­å»º<a class=anchor href=#cluster%e9%9b%86%e7%be%a4%e6%90%ad%e5%bb%ba>#</a></h3><p>1)ï¼šå•è™šæœºè¿è¡Œ6ä¸ªrediså®ä¾‹ï¼ˆä¸‰ä¸»ä¸‰ä»ï¼‰ï¼Œç«¯å£å·ä¸ºï¼ˆ79-84ï¼‰</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>root@wangpengliang local<span style=color:#f92672>]</span><span style=color:#75715e># cd /usr/local/redis/bin</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@wangpengliang bin<span style=color:#f92672>]</span><span style=color:#75715e># ls</span>
</span></span><span style=display:flex><span>conf  redis-benchmark  redis-check-aof  redis-check-rdb  redis-cli  redis-sentinel  redis-server
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@wangpengliang bin<span style=color:#f92672>]</span><span style=color:#75715e># cd conf</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@wangpengliang conf<span style=color:#f92672>]</span><span style=color:#75715e># ls</span>
</span></span><span style=display:flex><span>redis80.conf  redis81.conf  redis.conf  sentinel.conf
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@wangpengliang conf<span style=color:#f92672>]</span><span style=color:#75715e># cp redis.conf redis82.conf</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@wangpengliang conf<span style=color:#f92672>]</span><span style=color:#75715e># cp redis.conf redis83.conf</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@wangpengliang conf<span style=color:#f92672>]</span><span style=color:#75715e># cp redis.conf redis84.conf</span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@wangpengliang conf<span style=color:#f92672>]</span><span style=color:#75715e>#</span></span></span></code></pre></div><table><thead><tr><th style=text-align:center>ç«¯å£</th><th style=text-align:center>é…ç½®æ–‡ä»¶</th></tr></thead><tbody><tr><td style=text-align:center>6379</td><td style=text-align:center>redis.conf</td></tr><tr><td style=text-align:center>6380</td><td style=text-align:center>redis80.conf</td></tr><tr><td style=text-align:center>6381</td><td style=text-align:center>redis81.conf</td></tr><tr><td style=text-align:center>6382</td><td style=text-align:center>redis82.conf</td></tr><tr><td style=text-align:center>6383</td><td style=text-align:center>redis83.conf</td></tr><tr><td style=text-align:center>6384</td><td style=text-align:center>redis84.conf</td></tr></tbody></table><p>2)ï¼šä¿®æ”¹é…ç½®</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span> daemonize yes <span style=color:#75715e># åå°å¯åŠ¨</span>
</span></span><span style=display:flex><span> protected-mode no ; <span style=color:#75715e># å…è®¸å¤–éƒ¨è®¿é—®</span>
</span></span><span style=display:flex><span> port <span style=color:#ae81ff>6379</span> <span style=color:#75715e># ä¿®æ”¹ç«¯å£å·ï¼Œä»79~84</span>
</span></span><span style=display:flex><span> cluster-enabled yes <span style=color:#75715e># å¼€å¯clusterï¼Œå»æ‰æ³¨é‡Š</span>
</span></span><span style=display:flex><span> cluster-config-file nodes-6379.conf <span style=color:#75715e># è‡ªåŠ¨ç”Ÿæˆ</span>
</span></span><span style=display:flex><span> cluster-node-timeout <span style=color:#ae81ff>15000</span> <span style=color:#75715e># èŠ‚ç‚¹é€šä¿¡æ—¶é—´</span>
</span></span><span style=display:flex><span> logfile   /usr/local/redis/bin/6379.log
</span></span><span style=display:flex><span> dbfilename 6379dump.rdb  <span style=color:#75715e># åšä¼ªé›†ç¾¤çš„æ—¶å€™ï¼Œä¸€å®šè¦ä¿®æ”¹rdbæ–‡ä»¶çš„åå­—ï¼Œå¦‚æœaofä¹Ÿå¼€çš„è¯ä¹Ÿéœ€è¦ä¿®æ”¹ï¼Œå¦åˆ™æ‰©å®¹çš„æ—¶å€™ä¼šå‡ºç°æç¤ºè¯´æ–°å¢æ‰©å®¹èŠ‚ç‚¹å­˜åœ¨æ•°æ®ï¼Œéœ€è¦å…ˆåˆ é™¤æ•°æ®çš„æç¤ºã€‚</span></span></span></code></pre></div><p>3)ï¼šå¯åŠ¨Redis</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>root@wangpengliang bin<span style=color:#f92672>]</span><span style=color:#75715e># ./redis-server conf/redis.conf </span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@wangpengliang bin<span style=color:#f92672>]</span><span style=color:#75715e># ./redis-server conf/redis80.conf </span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@wangpengliang bin<span style=color:#f92672>]</span><span style=color:#75715e># ./redis-server conf/redis81.conf </span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@wangpengliang bin<span style=color:#f92672>]</span><span style=color:#75715e># ./redis-server conf/redis82.conf </span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@wangpengliang bin<span style=color:#f92672>]</span><span style=color:#75715e># ./redis-server conf/redis83.conf </span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>root@wangpengliang bin<span style=color:#f92672>]</span><span style=color:#75715e># ./redis-server conf/redis84.conf</span></span></span></code></pre></div><p>æŸ¥çœ‹Redisè¿›ç¨‹ä¿¡æ¯</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>root@wangpengliang bin<span style=color:#f92672>]</span><span style=color:#75715e># ps -ef|grep redis</span>
</span></span><span style=display:flex><span>root       <span style=color:#ae81ff>3538</span>      <span style=color:#ae81ff>1</span>  <span style=color:#ae81ff>0</span> 13:37 ?        00:00:01 ./redis-server 0.0.0.0:6382 <span style=color:#f92672>[</span>cluster<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>root       <span style=color:#ae81ff>3545</span>      <span style=color:#ae81ff>1</span>  <span style=color:#ae81ff>0</span> 13:38 ?        00:00:01 ./redis-server 0.0.0.0:6383 <span style=color:#f92672>[</span>cluster<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>root       <span style=color:#ae81ff>3551</span>      <span style=color:#ae81ff>1</span>  <span style=color:#ae81ff>0</span> 13:38 ?        00:00:01 ./redis-server 0.0.0.0:6384 <span style=color:#f92672>[</span>cluster<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>root       <span style=color:#ae81ff>3797</span>      <span style=color:#ae81ff>1</span>  <span style=color:#ae81ff>0</span> 13:48 ?        00:00:00 ./redis-server 0.0.0.0:6380 <span style=color:#f92672>[</span>cluster<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>root       <span style=color:#ae81ff>3803</span>      <span style=color:#ae81ff>1</span>  <span style=color:#ae81ff>0</span> 13:48 ?        00:00:00 ./redis-server 0.0.0.0:6381 <span style=color:#f92672>[</span>cluster<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>root       <span style=color:#ae81ff>3816</span>      <span style=color:#ae81ff>1</span>  <span style=color:#ae81ff>0</span> 13:49 ?        00:00:00 ./redis-server 0.0.0.0:6379 <span style=color:#f92672>[</span>cluster<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>root       <span style=color:#ae81ff>3826</span>   <span style=color:#ae81ff>3494</span>  <span style=color:#ae81ff>0</span> 13:49 pts/0    00:00:00 grep --color<span style=color:#f92672>=</span>auto redis</span></span></code></pre></div><p><strong>4)</strong>ï¼šåˆ›å»ºé›†ç¾¤</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>--cluster create  192.168.80.251:6379 192.168.80.251:6380 192.168.80.251:6381 192.168.80.251:6382 192.168.80.251:6383 192.168.80.251:6384  --cluster-replicas <span style=color:#ae81ff>1</span></span></span></code></pre></div><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>root@wangpengliang bin<span style=color:#f92672>]</span><span style=color:#75715e># ./redis-cli --cluster create  192.168.15.251:6379 192.168.15.251:6380 192.168.15.251:6381 192.168.15.251:6382 192.168.15.251:6383 192.168.15.251:6384  --cluster-replicas 1</span>
</span></span><span style=display:flex><span>&gt;&gt;&gt; Performing hash slots allocation on <span style=color:#ae81ff>6</span> nodes...
</span></span><span style=display:flex><span>Master<span style=color:#f92672>[</span>0<span style=color:#f92672>]</span> -&gt; Slots <span style=color:#ae81ff>0</span> - <span style=color:#ae81ff>5460</span>
</span></span><span style=display:flex><span>Master<span style=color:#f92672>[</span>1<span style=color:#f92672>]</span> -&gt; Slots <span style=color:#ae81ff>5461</span> - <span style=color:#ae81ff>10922</span>
</span></span><span style=display:flex><span>Master<span style=color:#f92672>[</span>2<span style=color:#f92672>]</span> -&gt; Slots <span style=color:#ae81ff>10923</span> - <span style=color:#ae81ff>16383</span>
</span></span><span style=display:flex><span>Adding replica 192.168.15.251:6383 to 192.168.15.251:6379
</span></span><span style=display:flex><span>Adding replica 192.168.15.251:6384 to 192.168.15.251:6380
</span></span><span style=display:flex><span>Adding replica 192.168.15.251:6382 to 192.168.15.251:6381
</span></span><span style=display:flex><span>&gt;&gt;&gt; Trying to optimize slaves allocation <span style=color:#66d9ef>for</span> anti-affinity
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>WARNING<span style=color:#f92672>]</span> Some slaves are in the same host as their master
</span></span><span style=display:flex><span>M: 48f3cbacb014f1d0f89fe99bb494e1cabb1f80f4 192.168.15.251:6379
</span></span><span style=display:flex><span>   slots:<span style=color:#f92672>[</span>0-5460<span style=color:#f92672>]</span> <span style=color:#f92672>(</span><span style=color:#ae81ff>5461</span> slots<span style=color:#f92672>)</span> master
</span></span><span style=display:flex><span>M: ee511eed5a7d08d39ceef29823b98e299435523e 192.168.15.251:6380
</span></span><span style=display:flex><span>   slots:<span style=color:#f92672>[</span>5461-10922<span style=color:#f92672>]</span> <span style=color:#f92672>(</span><span style=color:#ae81ff>5462</span> slots<span style=color:#f92672>)</span> master
</span></span><span style=display:flex><span>M: e4c70b085d10d51a3201c6bf4bfa47adfa000f2e 192.168.15.251:6381
</span></span><span style=display:flex><span>   slots:<span style=color:#f92672>[</span>10923-16383<span style=color:#f92672>]</span> <span style=color:#f92672>(</span><span style=color:#ae81ff>5461</span> slots<span style=color:#f92672>)</span> master
</span></span><span style=display:flex><span>S: 5261a1ccb42ac160a93572beae7344e6b0c7c520 192.168.15.251:6382
</span></span><span style=display:flex><span>   replicates 48f3cbacb014f1d0f89fe99bb494e1cabb1f80f4
</span></span><span style=display:flex><span>S: d420ca1e3ef8edd538286e1c7698783447312148 192.168.15.251:6383
</span></span><span style=display:flex><span>   replicates ee511eed5a7d08d39ceef29823b98e299435523e
</span></span><span style=display:flex><span>S: 235fb6093a7f1c92e7144109aee10d1e341d2fb9 192.168.15.251:6384
</span></span><span style=display:flex><span>   replicates e4c70b085d10d51a3201c6bf4bfa47adfa000f2e
</span></span><span style=display:flex><span>Can I set the above configuration? <span style=color:#f92672>(</span>type <span style=color:#e6db74>&#39;yes&#39;</span> to accept<span style=color:#f92672>)</span>: yes
</span></span><span style=display:flex><span>&gt;&gt;&gt; Nodes configuration updated
</span></span><span style=display:flex><span>&gt;&gt;&gt; Assign a different config epoch to each node
</span></span><span style=display:flex><span>&gt;&gt;&gt; Sending CLUSTER MEET messages to join the cluster
</span></span><span style=display:flex><span>Waiting <span style=color:#66d9ef>for</span> the cluster to join
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>&gt;&gt;&gt; Performing Cluster Check <span style=color:#f92672>(</span>using node 192.168.15.251:6379<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>M: 48f3cbacb014f1d0f89fe99bb494e1cabb1f80f4 192.168.15.251:6379
</span></span><span style=display:flex><span>   slots:<span style=color:#f92672>[</span>0-5460<span style=color:#f92672>]</span> <span style=color:#f92672>(</span><span style=color:#ae81ff>5461</span> slots<span style=color:#f92672>)</span> master
</span></span><span style=display:flex><span>   <span style=color:#ae81ff>1</span> additional replica<span style=color:#f92672>(</span>s<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>M: e4c70b085d10d51a3201c6bf4bfa47adfa000f2e 192.168.15.251:6381
</span></span><span style=display:flex><span>   slots:<span style=color:#f92672>[</span>10923-16383<span style=color:#f92672>]</span> <span style=color:#f92672>(</span><span style=color:#ae81ff>5461</span> slots<span style=color:#f92672>)</span> master
</span></span><span style=display:flex><span>   <span style=color:#ae81ff>1</span> additional replica<span style=color:#f92672>(</span>s<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>M: ee511eed5a7d08d39ceef29823b98e299435523e 192.168.15.251:6380
</span></span><span style=display:flex><span>   slots:<span style=color:#f92672>[</span>5461-10922<span style=color:#f92672>]</span> <span style=color:#f92672>(</span><span style=color:#ae81ff>5462</span> slots<span style=color:#f92672>)</span> master
</span></span><span style=display:flex><span>   <span style=color:#ae81ff>1</span> additional replica<span style=color:#f92672>(</span>s<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>S: 5261a1ccb42ac160a93572beae7344e6b0c7c520 192.168.15.251:6382
</span></span><span style=display:flex><span>   slots: <span style=color:#f92672>(</span><span style=color:#ae81ff>0</span> slots<span style=color:#f92672>)</span> slave
</span></span><span style=display:flex><span>   replicates 48f3cbacb014f1d0f89fe99bb494e1cabb1f80f4
</span></span><span style=display:flex><span>S: 235fb6093a7f1c92e7144109aee10d1e341d2fb9 192.168.15.251:6384
</span></span><span style=display:flex><span>   slots: <span style=color:#f92672>(</span><span style=color:#ae81ff>0</span> slots<span style=color:#f92672>)</span> slave
</span></span><span style=display:flex><span>   replicates e4c70b085d10d51a3201c6bf4bfa47adfa000f2e
</span></span><span style=display:flex><span>S: d420ca1e3ef8edd538286e1c7698783447312148 192.168.15.251:6383
</span></span><span style=display:flex><span>   slots: <span style=color:#f92672>(</span><span style=color:#ae81ff>0</span> slots<span style=color:#f92672>)</span> slave
</span></span><span style=display:flex><span>   replicates ee511eed5a7d08d39ceef29823b98e299435523e
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>OK<span style=color:#f92672>]</span> All nodes agree about slots configuration.
</span></span><span style=display:flex><span>&gt;&gt;&gt; Check <span style=color:#66d9ef>for</span> open slots...
</span></span><span style=display:flex><span>&gt;&gt;&gt; Check slots coverage...
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>OK<span style=color:#f92672>]</span> All <span style=color:#ae81ff>16384</span> slots covered.</span></span></code></pre></div><h1 id=redis-clusteré›†ç¾¤å‘½ä»¤>Redis-Clusteré›†ç¾¤å‘½ä»¤<a class=anchor href=#redis-cluster%e9%9b%86%e7%be%a4%e5%91%bd%e4%bb%a4>#</a></h1><ul><li><code>cluster info</code> ï¼šæ‰“å°é›†ç¾¤çš„ä¿¡æ¯</li><li><code>cluster nodes</code>ï¼šåˆ—å‡ºé›†ç¾¤å½“å‰å·²çŸ¥çš„æ‰€æœ‰èŠ‚ç‚¹ï¼ˆ nodeï¼‰ï¼Œä»¥åŠè¿™äº›èŠ‚ç‚¹çš„ç›¸å…³ä¿¡æ¯</li><li><code>cluster meet</code> Â  ï¼šå°† ip å’Œ port æ‰€æŒ‡å®šçš„èŠ‚ç‚¹æ·»åŠ åˆ°é›†ç¾¤å½“ä¸­</li><li><code>cluster forget &lt;node_id></code> ï¼šä»é›†ç¾¤ä¸­ç§»é™¤ node_id æŒ‡å®šçš„èŠ‚ç‚¹</li><li><code>cluster replicate &lt;master_node_id></code> ï¼šå°†å½“å‰ä»èŠ‚ç‚¹è®¾ç½®ä¸º node_id æŒ‡å®šçš„masterèŠ‚ç‚¹çš„slaveèŠ‚ç‚¹ã€‚åªèƒ½é’ˆå¯¹slaveèŠ‚ç‚¹æ“ä½œ</li><li><code>cluster saveconfig</code>ï¼šå°†èŠ‚ç‚¹çš„é…ç½®æ–‡ä»¶ä¿å­˜åˆ°ç¡¬ç›˜é‡Œé¢</li><li><code>cluster addslots Â [slot ...]</code> ï¼šå°†ä¸€ä¸ªæˆ–å¤šä¸ªæ§½ï¼ˆ slotï¼‰æŒ‡æ´¾ï¼ˆ assignï¼‰ç»™å½“å‰èŠ‚ç‚¹</li><li><code>cluster delslots Â [slot ...] </code>ï¼šç§»é™¤ä¸€ä¸ªæˆ–å¤šä¸ªæ§½å¯¹å½“å‰èŠ‚ç‚¹çš„æŒ‡æ´¾</li><li><code>cluster flushslots</code> ï¼šç§»é™¤æŒ‡æ´¾ç»™å½“å‰èŠ‚ç‚¹çš„æ‰€æœ‰æ§½ï¼Œè®©å½“å‰èŠ‚ç‚¹å˜æˆä¸€ä¸ªæ²¡æœ‰æŒ‡æ´¾ä»»ä½•æ§½çš„èŠ‚ç‚¹</li><li><code>cluster setslot Â node &lt;node_id></code> ï¼šå°†æ§½ slot æŒ‡æ´¾ç»™ node_id æŒ‡å®šçš„èŠ‚ç‚¹</li><li><code>cluster setslot Â migrating &lt;node_id></code> ï¼šå°†æœ¬èŠ‚ç‚¹çš„æ§½ slot è¿ç§»åˆ° node_id æŒ‡å®šçš„èŠ‚ç‚¹ä¸­</li><li><code>cluster setslot Â importing &lt;node_id></code> ï¼šä» node_id æŒ‡å®šçš„èŠ‚ç‚¹ä¸­å¯¼å…¥æ§½ slot åˆ°æœ¬èŠ‚ç‚¹</li><li><code>cluster setslot Â stable</code> ï¼šå–æ¶ˆå¯¹æ§½ slot çš„å¯¼å…¥ï¼ˆ importï¼‰æˆ–è€…è¿ç§»ï¼ˆ migrateï¼‰</li><li><code>cluster keyslot</code> Â ï¼šè®¡ç®—é”® key åº”è¯¥è¢«æ”¾ç½®åœ¨å“ªä¸ªæ§½ä¸Š</li><li><code>cluster countkeysinslot</code>Â ï¼šè¿”å›æ§½ slot ç›®å‰åŒ…å«çš„é”®å€¼å¯¹æ•°é‡</li><li><code>cluster getkeysinslot</code> Â  ï¼šè¿”å› count ä¸ª slot æ§½ä¸­çš„é”®</li></ul><h1 id=æŸ¥çœ‹redisæ•°æ®åº“ä¿¡æ¯>æŸ¥çœ‹Redisæ•°æ®åº“ä¿¡æ¯<a class=anchor href=#%e6%9f%a5%e7%9c%8bredis%e6%95%b0%e6%8d%ae%e5%ba%93%e4%bf%a1%e6%81%af>#</a></h1><p><code>info replication</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>127.0.0.1:6379&gt; info replication
</span></span><span style=display:flex><span><span style=color:#75715e># Replication</span>
</span></span><span style=display:flex><span><span style=color:#75715e># è§’è‰²</span>
</span></span><span style=display:flex><span>role:master
</span></span><span style=display:flex><span><span style=color:#75715e># è¿æ¥çš„ä»æœºæ•°é‡</span>
</span></span><span style=display:flex><span>connected_slaves:0
</span></span><span style=display:flex><span>master_failover_state:no-failover
</span></span><span style=display:flex><span>master_replid:28d568fba5f2ed0f9034a4f63acc4960287099af
</span></span><span style=display:flex><span>master_replid2:0000000000000000000000000000000000000000
</span></span><span style=display:flex><span>master_repl_offset:0
</span></span><span style=display:flex><span>second_repl_offset:-1
</span></span><span style=display:flex><span>repl_backlog_active:0
</span></span><span style=display:flex><span>repl_backlog_size:1048576
</span></span><span style=display:flex><span>repl_backlog_first_byte_offset:0
</span></span><span style=display:flex><span>repl_backlog_histlen:0</span></span></code></pre></div></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div></div><div></div></div><div class="flex flex-wrap justify-between"><span><a href=/docs/redis/1.8redis%E5%8F%91%E5%B8%83%E8%AE%A2%E9%98%85/ class="flex align-center"><img src=/icons/backward.svg class=book-icon alt=Backward>
<span>1.8 Rediså‘å¸ƒè®¢é˜…</span>
</a></span><span><a href=/docs/redis/%E4%BD%BF%E7%94%A8docker%E6%90%AD%E5%BB%BAredis%E9%9B%86%E7%BE%A4/ class="flex align-center"><span>ä½¿ç”¨ Dockeræ­å»º Redisé›†ç¾¤</span>
<img src=/icons/forward.svg class=book-icon alt=Forward></a></span></div><script>(function(){document.querySelectorAll("pre:has(code)").forEach(e=>{e.addEventListener("click",e.focus),e.addEventListener("copy",function(t){if(t.preventDefault(),navigator.clipboard){const t=window.getSelection().toString()||e.textContent;navigator.clipboard.writeText(t)}})})})()</script></footer><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#ä¸»ä»å¤åˆ¶>ä¸»ä»å¤åˆ¶</a><ul><li><a href=#å®ç°åŸç†>å®ç°åŸç†</a></li><li><a href=#ä¸»ä»å¤åˆ¶ä¼˜ç¼ºç‚¹><strong>ä¸»ä»å¤åˆ¶ä¼˜ç¼ºç‚¹</strong></a></li><li><a href=#ä¸»ä»å¤åˆ¶æ­å»º>ä¸»ä»å¤åˆ¶æ­å»º</a></li></ul></li><li><a href=#sentinelå“¨å…µæ¨¡å¼>Sentinelï¼ˆå“¨å…µï¼‰æ¨¡å¼</a><ul><li><a href=#å“¨å…µä½œç”¨>å“¨å…µä½œç”¨</a></li><li><a href=#æ•…éšœåˆ‡æ¢failoverè¿‡ç¨‹>æ•…éšœåˆ‡æ¢ï¼ˆfailoverï¼‰è¿‡ç¨‹</a></li><li><a href=#å“¨å…µå·¥ä½œæ–¹å¼>å“¨å…µå·¥ä½œæ–¹å¼</a></li><li><a href=#å“¨å…µæ¨¡å¼ä¼˜ç¼ºç‚¹>å“¨å…µæ¨¡å¼ä¼˜ç¼ºç‚¹</a></li><li><a href=#å“¨å…µæ¨¡å¼æ­å»º>å“¨å…µæ¨¡å¼æ­å»º</a></li></ul></li><li><a href=#cluster-é›†ç¾¤æ¨¡å¼>Cluster é›†ç¾¤æ¨¡å¼</a><ul><li><a href=#clusterç‰¹ç‚¹>Clusterç‰¹ç‚¹</a></li><li><a href=#clusteré›†ç¾¤æ¨¡å¼å¯¹æ¯”>Clusteré›†ç¾¤æ¨¡å¼å¯¹æ¯”</a></li><li><a href=#æ•°æ®å­˜å‚¨è®¾è®¡><strong>æ•°æ®å­˜å‚¨è®¾è®¡</strong></a></li><li><a href=#å“ˆå¸Œæ§½slot>å“ˆå¸Œæ§½Slot</a></li><li><a href=#é›†ç¾¤å†…éƒ¨é€šè®¯æœºåˆ¶>é›†ç¾¤å†…éƒ¨é€šè®¯æœºåˆ¶</a></li><li><a href=#clusteré›†ç¾¤æ­å»º>Clusteré›†ç¾¤æ­å»º</a></li></ul></li></ul></nav></div></aside></main></body></html>
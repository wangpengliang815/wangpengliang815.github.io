<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="容器是依赖于镜像生成，独立运行的一个或一组应用以及它们的运行环境。
启动容器# 启动容器有两种方式
基于镜像新建容器并启动 将在终止状态（stopped）的容器重新启动 新建并启动容器# 比如下面的命令输出“hello world!”，之后终止容器：
[root@wangpengliang ~]# docker run ubuntu /bin/echo &#39;hello world!&#39; hello world!下面的命令则启动一个 bash 终端，允许用户进行交互：
[root@wangpengliang ~]# docker run -it ubuntu /bin/bash root@ef8fa7a1ffd6:/# -t 选项让Docker分配一个伪终端（pseudo-tty）并绑定到容器的标准输入上 -i 让容器的标准输入保持打开 -it 是简写，在交互模式下可以通过所创建的终端来输入命令，比如：
[root@wangpengliang ~]# docker run -it ubuntu /bin/bash root@ef8fa7a1ffd6:/# pwd / root@ef8fa7a1ffd6:/# ls bin boot dev etc home lib lib32 lib64 libx32 media mnt opt proc root run sbin srv sys tmp usr var root@ef8fa7a1ffd6:/# 使用 docker run 创建容器时，Docker 在后台运行的标准操作包括：
">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="#ffffff">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="#343a40">
<meta name="color-scheme" content="light dark"><meta property="og:url" content="http://localhost:1313/posts/docker/1.3docker%E5%AE%B9%E5%99%A8/">
  <meta property="og:site_name" content="CODE&#39;NOTE">
  <meta property="og:title" content="CODE&#39;NOTE">
  <meta property="og:description" content="容器是依赖于镜像生成，独立运行的一个或一组应用以及它们的运行环境。
启动容器# 启动容器有两种方式
基于镜像新建容器并启动 将在终止状态（stopped）的容器重新启动 新建并启动容器# 比如下面的命令输出“hello world!”，之后终止容器：
[root@wangpengliang ~]# docker run ubuntu /bin/echo &#39;hello world!&#39; hello world!下面的命令则启动一个 bash 终端，允许用户进行交互：
[root@wangpengliang ~]# docker run -it ubuntu /bin/bash root@ef8fa7a1ffd6:/# -t 选项让Docker分配一个伪终端（pseudo-tty）并绑定到容器的标准输入上 -i 让容器的标准输入保持打开 -it 是简写，在交互模式下可以通过所创建的终端来输入命令，比如：
[root@wangpengliang ~]# docker run -it ubuntu /bin/bash root@ef8fa7a1ffd6:/# pwd / root@ef8fa7a1ffd6:/# ls bin boot dev etc home lib lib32 lib64 libx32 media mnt opt proc root run sbin srv sys tmp usr var root@ef8fa7a1ffd6:/# 使用 docker run 创建容器时，Docker 在后台运行的标准操作包括：">
  <meta property="og:locale" content="zh_cn">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">


  <meta itemprop="name" content="CODE&#39;NOTE">
  <meta itemprop="description" content="容器是依赖于镜像生成，独立运行的一个或一组应用以及它们的运行环境。
启动容器# 启动容器有两种方式
基于镜像新建容器并启动 将在终止状态（stopped）的容器重新启动 新建并启动容器# 比如下面的命令输出“hello world!”，之后终止容器：
[root@wangpengliang ~]# docker run ubuntu /bin/echo &#39;hello world!&#39; hello world!下面的命令则启动一个 bash 终端，允许用户进行交互：
[root@wangpengliang ~]# docker run -it ubuntu /bin/bash root@ef8fa7a1ffd6:/# -t 选项让Docker分配一个伪终端（pseudo-tty）并绑定到容器的标准输入上 -i 让容器的标准输入保持打开 -it 是简写，在交互模式下可以通过所创建的终端来输入命令，比如：
[root@wangpengliang ~]# docker run -it ubuntu /bin/bash root@ef8fa7a1ffd6:/# pwd / root@ef8fa7a1ffd6:/# ls bin boot dev etc home lib lib32 lib64 libx32 media mnt opt proc root run sbin srv sys tmp usr var root@ef8fa7a1ffd6:/# 使用 docker run 创建容器时，Docker 在后台运行的标准操作包括：">
  <meta itemprop="wordCount" content="1030">

<title>1.3 Docker容器 | CODE&#39;NOTE</title>
<link rel="icon" href="/favicon.png" >
<link rel="manifest" href="/manifest.json">
<link rel="canonical" href="http://localhost:1313/posts/docker/1.3docker%E5%AE%B9%E5%99%A8/">
<link rel="stylesheet" href="/book.min.6970156cec683193d93c9c4edaf0d56574e4361df2e0c1be4f697ae81c3ba55f.css" integrity="sha256-aXAVbOxoMZPZPJxO2vDVZXTkNh3y4MG&#43;T2l66Bw7pV8=" crossorigin="anonymous">


  <script defer src="/fuse.min.js"></script>
  <script defer src="/en.search.min.3ed9c79c605914c45e19db90edfda0ca8d87c63064c1d6252862250c4e917346.js" integrity="sha256-PtnHnGBZFMReGduQ7f2gyo2HxjBkwdYlKGIlDE6Rc0Y=" crossorigin="anonymous"></script>



  
</head>
<body dir="ltr" class="book-kind-page book-type-posts">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    
<aside class="book-menu">
  <div class="book-menu-content">
    
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/"><span>CODE&#39;NOTE</span>
  </a>
</h2>


<div class="book-search hidden">
  <input id="book-search-input" type="text" 
    placeholder="Search"
    aria-label="Search"
    maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>
<script>document.querySelector(".book-search").classList.remove("hidden")</script>
























</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>



  </div>
</aside>
 

    <div class="book-page">
      <header class="book-header hidden">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/icons/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <h3>1.3 Docker容器</h3>

  <label for="toc-control">
    
    <img src="/icons/toc.svg" class="book-icon" alt="Table of Contents" />
    
  </label>
</div>


  
  <aside class="hidden">
    
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#新建并启动容器">新建并启动容器</a></li>
    <li><a href="#启动已终止容器">启动已终止容器</a></li>
  </ul>

  <ul>
    <li><a href="#attach">attach</a></li>
    <li><a href="#exec">exec</a></li>
  </ul>
</nav>



  </aside>
  
 
      </header>

      
      
<article class="markdown book-post">
  <h1>
    1.3 Docker容器
  </h1>
  


  

  


  <div class="book-post-content markdown-inner"><p>容器是依赖于镜像生成，独立运行的一个或一组应用以及它们的运行环境。</p>
<h1 id="启动容器">启动容器<a class="anchor" href="#%e5%90%af%e5%8a%a8%e5%ae%b9%e5%99%a8">#</a></h1>
<p>启动容器有两种方式</p>
<ul>
<li>基于镜像新建容器并启动</li>
<li>将在终止状态（<code>stopped</code>）的容器重新启动</li>
</ul>
<h2 id="新建并启动容器">新建并启动容器<a class="anchor" href="#%e6%96%b0%e5%bb%ba%e5%b9%b6%e5%90%af%e5%8a%a8%e5%ae%b9%e5%99%a8">#</a></h2>
<p>比如下面的命令输出“hello world!”，之后终止容器：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#f92672">[</span>root@wangpengliang ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker run ubuntu /bin/echo &#39;hello world!&#39;</span>
</span></span><span style="display:flex;"><span>hello world!</span></span></code></pre></div><p>下面的命令则启动一个 bash 终端，允许用户进行交互：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#f92672">[</span>root@wangpengliang ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker run -it ubuntu /bin/bash</span>
</span></span><span style="display:flex;"><span>root@ef8fa7a1ffd6:/# </span></span></code></pre></div><ul>
<li><code>-t</code> 选项让Docker分配一个伪终端（pseudo-tty）并绑定到容器的标准输入上</li>
<li><code>-i</code> 让容器的标准输入保持打开</li>
</ul>
<p><code>-it</code> 是简写，在交互模式下可以通过所创建的终端来输入命令，比如：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#f92672">[</span>root@wangpengliang ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker run -it ubuntu /bin/bash</span>
</span></span><span style="display:flex;"><span>root@ef8fa7a1ffd6:/# pwd
</span></span><span style="display:flex;"><span>/
</span></span><span style="display:flex;"><span>root@ef8fa7a1ffd6:/# ls
</span></span><span style="display:flex;"><span>bin  boot  dev  etc  home  lib  lib32  lib64  libx32  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr  var
</span></span><span style="display:flex;"><span>root@ef8fa7a1ffd6:/# </span></span></code></pre></div><p>使用 <code>docker run</code> 创建容器时，Docker 在后台运行的标准操作包括：</p>
<ol>
<li>检查本地是否存在指定的镜像，不存在就从公有仓库下载</li>
<li>利用镜像创建并启动一个容器</li>
<li>分配一个文件系统，并在只读的镜像层外面挂载一层可读写层</li>
<li>从宿主主机配置的网桥接口中桥接一个虚拟接口到容器中去</li>
<li>从地址池配置一个 ip 地址给容器</li>
<li>执行用户指定的应用程序</li>
<li>执行完毕后容器被终止</li>
</ol>
<h2 id="启动已终止容器">启动已终止容器<a class="anchor" href="#%e5%90%af%e5%8a%a8%e5%b7%b2%e7%bb%88%e6%ad%a2%e5%ae%b9%e5%99%a8">#</a></h2>
<p>可以利用 <code>docker container start</code> 命令，直接将一个已经终止的容器启动运行。可以在伪终端中利用 <code>ps</code> 或 <code>top</code> 来查看进程信息：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>root@ef8fa7a1ffd6:/# ps
</span></span><span style="display:flex;"><span>   PID TTY          TIME CMD
</span></span><span style="display:flex;"><span>     <span style="color:#ae81ff">1</span> pts/0    00:00:00 bash
</span></span><span style="display:flex;"><span>    <span style="color:#ae81ff">12</span> pts/0    00:00:00 ps</span></span></code></pre></div><h1 id="后台运行">后台运行<a class="anchor" href="#%e5%90%8e%e5%8f%b0%e8%bf%90%e8%a1%8c">#</a></h1>
<p>更多的时候，需要让 Docker 在后台运行而不是直接把执行命令的结果输出在当前宿主机下。可以通过添加 <code>-d</code> 参数来实现。</p>
<p>不使用 <code>-d</code> 参数：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#f92672">[</span>root@wangpengliang ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker run ubuntu /bin/sh -c &#39;while true;do echo hello docker; sleep 1;done&#39;</span>
</span></span><span style="display:flex;"><span>hello docker
</span></span><span style="display:flex;"><span>hello docker
</span></span><span style="display:flex;"><span>hello docker
</span></span><span style="display:flex;"><span>hello docker</span></span></code></pre></div><p>容器会把输出的结果 (STDOUT) 打印到宿主机上1s打印一次&quot;hello docker&quot;。</p>
<hr>
<p>使用 <code>-d</code> 参数：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#f92672">[</span>root@wangpengliang ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker run -d ubuntu /bin/sh -c &#39;while true;do echo hello docker; sleep 1;done&#39;</span>
</span></span><span style="display:flex;"><span>3c443074634c5edd6272c62fd08d8439ac2b5f3b9677233aae06deb2724c917c</span></span></code></pre></div><p>此时容器会在后台运行并不会把输出结果 (STDOUT) 打印到宿主机上。</p>
<hr>
<p>可以使用 <code>docker logs</code> 查看输出结果</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#f92672">[</span>root@wangpengliang ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker logs 3c443074634c</span>
</span></span><span style="display:flex;"><span>hello docker
</span></span><span style="display:flex;"><span>hello docker
</span></span><span style="display:flex;"><span>hello docker</span></span></code></pre></div><p>使用 <code>-d</code>  参数启动后会返回一个唯一的 id，也可以通过 <code>docker container ls</code>  命令来查看容器信息：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#f92672">[</span>root@wangpengliang ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker container ls</span>
</span></span><span style="display:flex;"><span>CONTAINER ID   IMAGE       COMMAND                  CREATED         STATUS         PORTS                               NAMES
</span></span><span style="display:flex;"><span>3c443074634c   ubuntu      <span style="color:#e6db74">&#34;/bin/sh -c &#39;while t…&#34;</span>   <span style="color:#ae81ff">2</span> minutes ago   Up <span style="color:#ae81ff">2</span> minutes                                       affectionate_agnesi
</span></span><span style="display:flex;"><span>a1ea64a6c039   nginx:3.0   <span style="color:#e6db74">&#34;/docker-entrypoint.…&#34;</span>   <span style="color:#ae81ff">17</span> hours ago    Up <span style="color:#ae81ff">17</span> hours    0.0.0.0:82-&gt;80/tcp, :::82-&gt;80/tcp   webserver3</span></span></code></pre></div><p>要获取容器的输出信息，可以按上面说的使用 <code>docker container logs</code>  命令，格式 <code>docker container logs [container ID or NAMES]</code> </p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#f92672">[</span>root@wangpengliang ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker container logs  3c443074634c</span>
</span></span><span style="display:flex;"><span>hello docker
</span></span><span style="display:flex;"><span>hello docker
</span></span><span style="display:flex;"><span>hello docker</span></span></code></pre></div><h1 id="终止容器">终止容器<a class="anchor" href="#%e7%bb%88%e6%ad%a2%e5%ae%b9%e5%99%a8">#</a></h1>
<p>使用 <code>docker container stop</code>  来终止一个运行中的容器，此外当 Docker 容器中指定的应用终结时，容器也自动终止。比如对于上面只启动了一个终端的容器，通过 <code>exit</code>  命令或 <code>ctrl+d</code>   退出终端时，创建的容器立刻终止。</p>
<p>终止状态的容器可以用 <code>docker container ls -a</code>  命令看到：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#f92672">[</span>root@wangpengliang ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker container ls -a</span>
</span></span><span style="display:flex;"><span>CONTAINER ID   IMAGE       COMMAND                  CREATED        STATUS                      PORTS                               NAMES
</span></span><span style="display:flex;"><span>a1ea64a6c039   nginx:3.0   <span style="color:#e6db74">&#34;/docker-entrypoint.…&#34;</span>   <span style="color:#ae81ff">18</span> hours ago   Up <span style="color:#ae81ff">18</span> hours                 0.0.0.0:82-&gt;80/tcp, :::82-&gt;80/tcp   webserver3
</span></span><span style="display:flex;"><span>bab7ffb6e2e9   nginx:2.0   <span style="color:#e6db74">&#34;/docker-entrypoint.…&#34;</span>   <span style="color:#ae81ff">3</span> days ago     Exited <span style="color:#f92672">(</span>255<span style="color:#f92672">)</span> <span style="color:#ae81ff">18</span> hours ago   0.0.0.0:81-&gt;80/tcp, :::81-&gt;80/tcp   webserver2
</span></span><span style="display:flex;"><span>470e01aed950   nginx   </span></span></code></pre></div><p>处于终止状态的容器，可以通过 <code>docker container start</code>  命令来重新启动：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#f92672">[</span>root@wangpengliang ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker container start webserver</span>
</span></span><span style="display:flex;"><span>webserver
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@wangpengliang ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker ps -a</span>
</span></span><span style="display:flex;"><span>CONTAINER ID   IMAGE       COMMAND                  CREATED        STATUS                      PORTS                               NAMES
</span></span><span style="display:flex;"><span>a1ea64a6c039   nginx:3.0   <span style="color:#e6db74">&#34;/docker-entrypoint.…&#34;</span>   <span style="color:#ae81ff">18</span> hours ago   Up <span style="color:#ae81ff">18</span> hours                 0.0.0.0:82-&gt;80/tcp, :::82-&gt;80/tcp   webserver3
</span></span><span style="display:flex;"><span>bab7ffb6e2e9   nginx:2.0   <span style="color:#e6db74">&#34;/docker-entrypoint.…&#34;</span>   <span style="color:#ae81ff">3</span> days ago     Exited <span style="color:#f92672">(</span>255<span style="color:#f92672">)</span> <span style="color:#ae81ff">18</span> hours ago   0.0.0.0:81-&gt;80/tcp, :::81-&gt;80/tcp   webserver2
</span></span><span style="display:flex;"><span>470e01aed950   nginx       <span style="color:#e6db74">&#34;/docker-entrypoint.…&#34;</span>   <span style="color:#ae81ff">3</span> days ago     Up <span style="color:#ae81ff">5</span> seconds                0.0.0.0:80-&gt;80/tcp, :::80-&gt;80/tcp   webserver</span></span></code></pre></div><p><code>docker container restart </code> 命令会将一个运行状态的容器终止，然后再重新启动：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#f92672">[</span>root@wangpengliang ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker container restart webserver</span>
</span></span><span style="display:flex;"><span>webserver</span></span></code></pre></div><h1 id="进入容器">进入容器<a class="anchor" href="#%e8%bf%9b%e5%85%a5%e5%ae%b9%e5%99%a8">#</a></h1>
<p>使用 <code>-d</code>  参数时，容器启动后会进入后台，某些时候需要进入容器进行操作，包括使用 <code>docker attach</code> 或 <code>docker exec</code>  命令，推荐使用 <code>docker exec</code> 。</p>
<h2 id="attach">attach<a class="anchor" href="#attach">#</a></h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#f92672">[</span>root@wangpengliang ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker run -dit ubuntu</span>
</span></span><span style="display:flex;"><span>21498e13f12425718093684e74f342e30e7b9665e57b9b919f0a718d888f7b50
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@wangpengliang ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker container ls</span>
</span></span><span style="display:flex;"><span>CONTAINER ID   IMAGE       COMMAND                  CREATED         STATUS         PORTS                               NAMES
</span></span><span style="display:flex;"><span>21498e13f124   ubuntu      <span style="color:#e6db74">&#34;/bin/bash&#34;</span>              <span style="color:#ae81ff">9</span> seconds ago   Up <span style="color:#ae81ff">8</span> seconds                                       elated_chatelet
</span></span><span style="display:flex;"><span>a1ea64a6c039   nginx:3.0   <span style="color:#e6db74">&#34;/docker-entrypoint.…&#34;</span>   <span style="color:#ae81ff">18</span> hours ago    Up <span style="color:#ae81ff">18</span> hours    0.0.0.0:82-&gt;80/tcp, :::82-&gt;80/tcp   webserver3
</span></span><span style="display:flex;"><span>470e01aed950   nginx       <span style="color:#e6db74">&#34;/docker-entrypoint.…&#34;</span>   <span style="color:#ae81ff">3</span> days ago      Up <span style="color:#ae81ff">2</span> minutes   0.0.0.0:80-&gt;80/tcp, :::80-&gt;80/tcp   webserver
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@wangpengliang ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker attach 21498e13f124</span>
</span></span><span style="display:flex;"><span>root@21498e13f124:/# ls
</span></span><span style="display:flex;"><span>bin  boot  dev  etc  home  lib  lib32  lib64  libx32  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr  var
</span></span><span style="display:flex;"><span>root@21498e13f124:/# exit 
</span></span><span style="display:flex;"><span>exit
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@wangpengliang ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker container ls</span>
</span></span><span style="display:flex;"><span>CONTAINER ID   IMAGE       COMMAND                  CREATED        STATUS         PORTS                               NAMES
</span></span><span style="display:flex;"><span>a1ea64a6c039   nginx:3.0   <span style="color:#e6db74">&#34;/docker-entrypoint.…&#34;</span>   <span style="color:#ae81ff">18</span> hours ago   Up <span style="color:#ae81ff">18</span> hours    0.0.0.0:82-&gt;80/tcp, :::82-&gt;80/tcp   webserver3
</span></span><span style="display:flex;"><span>470e01aed950   nginx       <span style="color:#e6db74">&#34;/docker-entrypoint.…&#34;</span>   <span style="color:#ae81ff">3</span> days ago     Up <span style="color:#ae81ff">2</span> minutes   0.0.0.0:80-&gt;80/tcp, :::80-&gt;80/tcp   webserver</span></span></code></pre></div><blockquote class='book-hint '>
<p>注意：如果从这个 stdin 中 exit，会导致容器的停止</p>
</blockquote><h2 id="exec">exec<a class="anchor" href="#exec">#</a></h2>
<p><code>docker exec</code>  后边可以跟多个参数，这里主要说明 <code>-i -t</code>  参数</p>
<ul>
<li>只用 <code>-i</code>  参数时由于没有分配伪终端，界面没有熟悉的 Linux 命令提示符，但命令执行结果仍然可以返回</li>
<li>当 <code>-i -t</code>  参数一起使用时，则可以看到熟悉的 Linux 命令提示符</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#f92672">[</span>root@wangpengliang ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker exec -it 2687f43c0e42 bash</span>
</span></span><span style="display:flex;"><span>root@2687f43c0e42:/# ls
</span></span><span style="display:flex;"><span>bin  boot  dev  etc  home  lib  lib32  lib64  libx32  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr  var</span></span></code></pre></div><p>如果从这个 stdin 中 exit，不会导致容器的停止。这就是为什么推荐使用 <code>docker exec</code> 的原因，更多参数说明使用 <code>docker exec --help</code>  查看。</p>
<h1 id="导出容器">导出容器<a class="anchor" href="#%e5%af%bc%e5%87%ba%e5%ae%b9%e5%99%a8">#</a></h1>
<p>如果要导出本地某个容器，可以使用 <code>docker export</code>  命令，这将导出容器快照到本地文件：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#f92672">[</span>root@wangpengliang ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker ps -a</span>
</span></span><span style="display:flex;"><span>CONTAINER ID   IMAGE       COMMAND                  CREATED        STATUS                      PORTS                               NAMES
</span></span><span style="display:flex;"><span>2687f43c0e42   ubuntu      <span style="color:#e6db74">&#34;/bin/bash&#34;</span>              <span style="color:#ae81ff">2</span> hours ago    Up <span style="color:#ae81ff">2</span> minutes                                                    romantic_greider
</span></span><span style="display:flex;"><span>a1ea64a6c039   nginx:3.0   <span style="color:#e6db74">&#34;/docker-entrypoint.…&#34;</span>   <span style="color:#ae81ff">20</span> hours ago   Up <span style="color:#ae81ff">20</span> hours                 0.0.0.0:82-&gt;80/tcp, :::82-&gt;80/tcp   webserver3
</span></span><span style="display:flex;"><span>bab7ffb6e2e9   nginx:2.0   <span style="color:#e6db74">&#34;/docker-entrypoint.…&#34;</span>   <span style="color:#ae81ff">3</span> days ago     Exited <span style="color:#f92672">(</span>255<span style="color:#f92672">)</span> <span style="color:#ae81ff">20</span> hours ago   0.0.0.0:81-&gt;80/tcp, :::81-&gt;80/tcp   webserver2
</span></span><span style="display:flex;"><span>470e01aed950   nginx       <span style="color:#e6db74">&#34;/docker-entrypoint.…&#34;</span>   <span style="color:#ae81ff">3</span> days ago     Up <span style="color:#ae81ff">2</span> hours                  0.0.0.0:80-&gt;80/tcp, :::80-&gt;80/tcp   webserver
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@wangpengliang ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker export 2687f43c0e42 &gt; ubuntu.tar</span></span></span></code></pre></div><h1 id="导入容器">导入容器<a class="anchor" href="#%e5%af%bc%e5%85%a5%e5%ae%b9%e5%99%a8">#</a></h1>
<p>可以使用 <code>docker import</code>  从容器快照文件中再导入为镜像。比如：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#f92672">[</span>root@wangpengliang ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker ps -a</span>
</span></span><span style="display:flex;"><span>CONTAINER ID   IMAGE       COMMAND                  CREATED        STATUS                      PORTS                               NAMES
</span></span><span style="display:flex;"><span>2687f43c0e42   ubuntu      <span style="color:#e6db74">&#34;/bin/bash&#34;</span>              <span style="color:#ae81ff">2</span> hours ago    Up <span style="color:#ae81ff">2</span> minutes                                                    romantic_greider
</span></span><span style="display:flex;"><span>a1ea64a6c039   nginx:3.0   <span style="color:#e6db74">&#34;/docker-entrypoint.…&#34;</span>   <span style="color:#ae81ff">20</span> hours ago   Up <span style="color:#ae81ff">20</span> hours                 0.0.0.0:82-&gt;80/tcp, :::82-&gt;80/tcp   webserver3
</span></span><span style="display:flex;"><span>bab7ffb6e2e9   nginx:2.0   <span style="color:#e6db74">&#34;/docker-entrypoint.…&#34;</span>   <span style="color:#ae81ff">3</span> days ago     Exited <span style="color:#f92672">(</span>255<span style="color:#f92672">)</span> <span style="color:#ae81ff">20</span> hours ago   0.0.0.0:81-&gt;80/tcp, :::81-&gt;80/tcp   webserver2
</span></span><span style="display:flex;"><span>470e01aed950   nginx       <span style="color:#e6db74">&#34;/docker-entrypoint.…&#34;</span>   <span style="color:#ae81ff">3</span> days ago     Up <span style="color:#ae81ff">2</span> hours                  0.0.0.0:80-&gt;80/tcp, :::80-&gt;80/tcp   webserver
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@wangpengliang ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker export 2687f43c0e42 &gt;ubuntu.tar</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@wangpengliang ~<span style="color:#f92672">]</span><span style="color:#75715e"># cat ubuntu.tar|docker import - test/ubuntu:v1.0</span>
</span></span><span style="display:flex;"><span>sha256:557b6b4bfca63802c6b89bb4c8f1800a2af7954fdff345bd94adba2c770ad4d4
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@wangpengliang ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker image ls</span>
</span></span><span style="display:flex;"><span>REPOSITORY    TAG       IMAGE ID       CREATED         SIZE
</span></span><span style="display:flex;"><span>test/ubuntu   v1.0      557b6b4bfca6   <span style="color:#ae81ff">9</span> seconds ago   72.7MB
</span></span><span style="display:flex;"><span>nginx         3.0       f89693105193   <span style="color:#ae81ff">20</span> hours ago    133MB
</span></span><span style="display:flex;"><span>nginx         2.0       546ad28bcf61   <span style="color:#ae81ff">3</span> days ago      133MB
</span></span><span style="display:flex;"><span>redis         6.2.4     fad0ee7e917a   <span style="color:#ae81ff">5</span> days ago      105MB
</span></span><span style="display:flex;"><span>redis         latest    fad0ee7e917a   <span style="color:#ae81ff">5</span> days ago      105MB
</span></span><span style="display:flex;"><span>nginx         latest    d1a364dc548d   <span style="color:#ae81ff">13</span> days ago     133MB
</span></span><span style="display:flex;"><span>ubuntu        latest    7e0aa2d69a15   <span style="color:#ae81ff">6</span> weeks ago     72.7MB
</span></span><span style="display:flex;"><span>hello-world   latest    d1165f221234   <span style="color:#ae81ff">3</span> months ago    13.3kB</span></span></code></pre></div><p>此外，也可以通过指定 URL 或者某个目录来导入，比如：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>docker import http://example.com/exampleimage.tgz example/imagerepo</span></span></code></pre></div><blockquote class='book-hint '>
<p>注意：用户既可以使用 <code>docker load</code>  来导入镜像存储文件到本地镜像库，也可以使用 <code>docker import</code> 来导入一个容器快照到本地镜像库。这两者的区别在于容器快照文件将丢弃所有的历史记录和元数据信息（即仅保存容器当时的快照状态），而镜像存储文件将保存完整记录，体积也要大。此外，从容器快照文件导入时可以重新指定标签等元数据信息</p>
</blockquote><h1 id="删除容器">删除容器<a class="anchor" href="#%e5%88%a0%e9%99%a4%e5%ae%b9%e5%99%a8">#</a></h1>
<p>可以使用 <code>docker container rm</code>  来删除一个处于终止状态的容器</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#f92672">[</span>root@wangpengliang ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker ps -a</span>
</span></span><span style="display:flex;"><span>CONTAINER ID   IMAGE       COMMAND                  CREATED        STATUS                      PORTS                               NAMES
</span></span><span style="display:flex;"><span>2687f43c0e42   ubuntu      <span style="color:#e6db74">&#34;/bin/bash&#34;</span>              <span style="color:#ae81ff">2</span> hours ago    Up <span style="color:#ae81ff">6</span> minutes                                                    romantic_greider
</span></span><span style="display:flex;"><span>a1ea64a6c039   nginx:3.0   <span style="color:#e6db74">&#34;/docker-entrypoint.…&#34;</span>   <span style="color:#ae81ff">20</span> hours ago   Up <span style="color:#ae81ff">20</span> hours                 0.0.0.0:82-&gt;80/tcp, :::82-&gt;80/tcp   webserver3
</span></span><span style="display:flex;"><span>bab7ffb6e2e9   nginx:2.0   <span style="color:#e6db74">&#34;/docker-entrypoint.…&#34;</span>   <span style="color:#ae81ff">3</span> days ago     Exited <span style="color:#f92672">(</span>255<span style="color:#f92672">)</span> <span style="color:#ae81ff">20</span> hours ago   0.0.0.0:81-&gt;80/tcp, :::81-&gt;80/tcp   webserver2
</span></span><span style="display:flex;"><span>470e01aed950   nginx       <span style="color:#e6db74">&#34;/docker-entrypoint.…&#34;</span>   <span style="color:#ae81ff">3</span> days ago     Up <span style="color:#ae81ff">2</span> hours                  0.0.0.0:80-&gt;80/tcp, :::80-&gt;80/tcp   webserver
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@wangpengliang ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker container rm bab7ffb6e2e9</span>
</span></span><span style="display:flex;"><span>bab7ffb6e2e9
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@wangpengliang ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker ps -a</span>
</span></span><span style="display:flex;"><span>CONTAINER ID   IMAGE       COMMAND                  CREATED        STATUS         PORTS                               NAMES
</span></span><span style="display:flex;"><span>2687f43c0e42   ubuntu      <span style="color:#e6db74">&#34;/bin/bash&#34;</span>              <span style="color:#ae81ff">2</span> hours ago    Up <span style="color:#ae81ff">7</span> minutes                                       romantic_greider
</span></span><span style="display:flex;"><span>a1ea64a6c039   nginx:3.0   <span style="color:#e6db74">&#34;/docker-entrypoint.…&#34;</span>   <span style="color:#ae81ff">20</span> hours ago   Up <span style="color:#ae81ff">20</span> hours    0.0.0.0:82-&gt;80/tcp, :::82-&gt;80/tcp   webserver3
</span></span><span style="display:flex;"><span>470e01aed950   nginx       <span style="color:#e6db74">&#34;/docker-entrypoint.…&#34;</span>   <span style="color:#ae81ff">3</span> days ago     Up <span style="color:#ae81ff">2</span> hours     0.0.0.0:80-&gt;80/tcp, :::80-&gt;80/tcp   webserver</span></span></code></pre></div><p>如果要删除一个运行中的容器，可以添加 <code>-f</code>  参数。Docker 会发送 <code>SIGKILL</code>  信号给容器</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#f92672">[</span>root@wangpengliang ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker ps -a</span>
</span></span><span style="display:flex;"><span>CONTAINER ID   IMAGE       COMMAND                  CREATED        STATUS         PORTS                               NAMES
</span></span><span style="display:flex;"><span>2687f43c0e42   ubuntu      <span style="color:#e6db74">&#34;/bin/bash&#34;</span>              <span style="color:#ae81ff">2</span> hours ago    Up <span style="color:#ae81ff">8</span> minutes                                       romantic_greider
</span></span><span style="display:flex;"><span>a1ea64a6c039   nginx:3.0   <span style="color:#e6db74">&#34;/docker-entrypoint.…&#34;</span>   <span style="color:#ae81ff">20</span> hours ago   Up <span style="color:#ae81ff">20</span> hours    0.0.0.0:82-&gt;80/tcp, :::82-&gt;80/tcp   webserver3
</span></span><span style="display:flex;"><span>470e01aed950   nginx       <span style="color:#e6db74">&#34;/docker-entrypoint.…&#34;</span>   <span style="color:#ae81ff">3</span> days ago     Up <span style="color:#ae81ff">2</span> hours     0.0.0.0:80-&gt;80/tcp, :::80-&gt;80/tcp   webserver
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@wangpengliang ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker container rm -f 2687f43c0e42</span>
</span></span><span style="display:flex;"><span>2687f43c0e42
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>root@wangpengliang ~<span style="color:#f92672">]</span><span style="color:#75715e"># docker ps -a</span>
</span></span><span style="display:flex;"><span>CONTAINER ID   IMAGE       COMMAND                  CREATED        STATUS        PORTS                               NAMES
</span></span><span style="display:flex;"><span>a1ea64a6c039   nginx:3.0   <span style="color:#e6db74">&#34;/docker-entrypoint.…&#34;</span>   <span style="color:#ae81ff">20</span> hours ago   Up <span style="color:#ae81ff">20</span> hours   0.0.0.0:82-&gt;80/tcp, :::82-&gt;80/tcp   webserver3
</span></span><span style="display:flex;"><span>470e01aed950   nginx       <span style="color:#e6db74">&#34;/docker-entrypoint.…&#34;</span>   <span style="color:#ae81ff">3</span> days ago     Up <span style="color:#ae81ff">2</span> hours    0.0.0.0:80-&gt;80/tcp, :::80-&gt;80/tcp   webserver</span></span></code></pre></div><p>用 <code>docker container ls -a</code>  命令可以查看所有已经创建的包括终止状态的容器，如果数量太多一个个删除可能会很麻烦，用下面的命令可以清理掉所有处于终止状态的容器：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>docker container prune</span></span></code></pre></div></div>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">
  <div>
  
    <a href="/posts/docker/1.2docker%E9%95%9C%E5%83%8F/" class="flex align-center">
      <img src="/icons/backward.svg" class="book-icon" alt="Backward" />
      <span>1.2 Docker镜像</span>
    </a>
  
  </div>
  <div>
  
    <a href="/posts/docker/1.4docker%E4%BB%93%E5%BA%93/" class="flex align-center">
      <span>1.4 Docker仓库</span>
      <img src="/icons/forward.svg" class="book-icon" alt="Forward" />
    </a>
  
  </div>
</div>
 
        
  
 
        
        
  
 
        
  
  
    <script>(function(){document.querySelectorAll("pre:has(code)").forEach(e=>{e.addEventListener("click",e.focus),e.addEventListener("copy",function(t){if(t.preventDefault(),navigator.clipboard){const t=window.getSelection().toString()||e.textContent;navigator.clipboard.writeText(t)}})})})()</script>
  

      </footer>

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
  
  <aside class="book-toc">
    <div class="book-toc-content">
      
  
<nav id="TableOfContents">
  <ul>
    <li><a href="#新建并启动容器">新建并启动容器</a></li>
    <li><a href="#启动已终止容器">启动已终止容器</a></li>
  </ul>

  <ul>
    <li><a href="#attach">attach</a></li>
    <li><a href="#exec">exec</a></li>
  </ul>
</nav>



    </div>
  </aside>
  
 
  </main>

  
</body>
</html>





















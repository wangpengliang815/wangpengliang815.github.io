<!DOCTYPE html>
<html lang="zh-cn" dir="ltr">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script>
  <!--
Made with Book Theme
https://github.com/alex-shpak/hugo-book
-->

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="Selenium可以用来做自动化UI测试，支持多语言，这里使用C#编写测试脚本。
.NetFramework# Selenium.Support，Selenium.WebDriver,Selenium.RC
Dotnet core# 核心库：Selenium.Support，Selenium.WebDriver,Selenium.Chrome.WebDriver
注意：Selenium.RC包在dotnetcore会存在不兼容的问题，无法正常找到chromedriver.exe 文件。
Exception
The chromedriver.exe file does not exist in the current directory or in a directory on the PATH environment variable. The driver can be downloaded at http://chromedriver.storage.googleapis.com/index.html.”
解决方法
nuget Selenium.Chrome.WebDriver。将ChromeDriver.exe放入构建目录中
注意：.netcore2.1中引入了Selenium.Chrome.WebDriver包依旧会出现上面的异常
浏览器驱动下载# 需下载本机对应版本，不区分32/64
https://npm.taobao.org/mirrors/chromedriver/
PageObject# 解决的问题：版本迭代太快，UI层元素的属性经常变换，导致维护人员需要花大把的时间去维护代码，为了节省维护成本及时间，就可以利用PageObject 这种设计模式，它就大大的减少了维护时间。
创建对应浏览器配置，创建WebDriver对象：
public abstract class TestBase { protected IWebDriver driver; public void WebDriverInit(string url) { ChromeOptions options = new ChromeOptions(); // 窗口最大化 options.AddArgument(&#34;start-maximized&#34;); driver = new ChromeDriver(options); driver.Navigate().GoToUrl(url); Thread.Sleep(1000); } }ClockInPage，页面模型，封装页面标签属性以及对应操作：
">
<meta name="theme-color" media="(prefers-color-scheme: light)" content="#ffffff">
<meta name="theme-color" media="(prefers-color-scheme: dark)" content="#343a40">
<meta name="color-scheme" content="light dark"><meta property="og:url" content="http://localhost:1313/posts/test/%E8%87%AA%E5%8A%A8%E5%8C%96ui%E6%B5%8B%E8%AF%95/">
  <meta property="og:site_name" content="CODE&#39;NOTE">
  <meta property="og:title" content="CODE&#39;NOTE">
  <meta property="og:description" content="Selenium可以用来做自动化UI测试，支持多语言，这里使用C#编写测试脚本。
.NetFramework# Selenium.Support，Selenium.WebDriver,Selenium.RC
Dotnet core# 核心库：Selenium.Support，Selenium.WebDriver,Selenium.Chrome.WebDriver
注意：Selenium.RC包在dotnetcore会存在不兼容的问题，无法正常找到chromedriver.exe 文件。
Exception
The chromedriver.exe file does not exist in the current directory or in a directory on the PATH environment variable. The driver can be downloaded at http://chromedriver.storage.googleapis.com/index.html.”
解决方法
nuget Selenium.Chrome.WebDriver。将ChromeDriver.exe放入构建目录中
注意：.netcore2.1中引入了Selenium.Chrome.WebDriver包依旧会出现上面的异常
浏览器驱动下载# 需下载本机对应版本，不区分32/64
https://npm.taobao.org/mirrors/chromedriver/
PageObject# 解决的问题：版本迭代太快，UI层元素的属性经常变换，导致维护人员需要花大把的时间去维护代码，为了节省维护成本及时间，就可以利用PageObject 这种设计模式，它就大大的减少了维护时间。
创建对应浏览器配置，创建WebDriver对象：
public abstract class TestBase { protected IWebDriver driver; public void WebDriverInit(string url) { ChromeOptions options = new ChromeOptions(); // 窗口最大化 options.AddArgument(&#34;start-maximized&#34;); driver = new ChromeDriver(options); driver.Navigate().GoToUrl(url); Thread.Sleep(1000); } }ClockInPage，页面模型，封装页面标签属性以及对应操作：">
  <meta property="og:locale" content="zh_cn">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">


  <meta itemprop="name" content="CODE&#39;NOTE">
  <meta itemprop="description" content="Selenium可以用来做自动化UI测试，支持多语言，这里使用C#编写测试脚本。
.NetFramework# Selenium.Support，Selenium.WebDriver,Selenium.RC
Dotnet core# 核心库：Selenium.Support，Selenium.WebDriver,Selenium.Chrome.WebDriver
注意：Selenium.RC包在dotnetcore会存在不兼容的问题，无法正常找到chromedriver.exe 文件。
Exception
The chromedriver.exe file does not exist in the current directory or in a directory on the PATH environment variable. The driver can be downloaded at http://chromedriver.storage.googleapis.com/index.html.”
解决方法
nuget Selenium.Chrome.WebDriver。将ChromeDriver.exe放入构建目录中
注意：.netcore2.1中引入了Selenium.Chrome.WebDriver包依旧会出现上面的异常
浏览器驱动下载# 需下载本机对应版本，不区分32/64
https://npm.taobao.org/mirrors/chromedriver/
PageObject# 解决的问题：版本迭代太快，UI层元素的属性经常变换，导致维护人员需要花大把的时间去维护代码，为了节省维护成本及时间，就可以利用PageObject 这种设计模式，它就大大的减少了维护时间。
创建对应浏览器配置，创建WebDriver对象：
public abstract class TestBase { protected IWebDriver driver; public void WebDriverInit(string url) { ChromeOptions options = new ChromeOptions(); // 窗口最大化 options.AddArgument(&#34;start-maximized&#34;); driver = new ChromeDriver(options); driver.Navigate().GoToUrl(url); Thread.Sleep(1000); } }ClockInPage，页面模型，封装页面标签属性以及对应操作：">
  <meta itemprop="wordCount" content="174">

<title>自动化 Ui测试 | CODE&#39;NOTE</title>
<link rel="icon" href="/favicon.png" >
<link rel="manifest" href="/manifest.json">
<link rel="canonical" href="http://localhost:1313/posts/test/%E8%87%AA%E5%8A%A8%E5%8C%96ui%E6%B5%8B%E8%AF%95/">
<link rel="stylesheet" href="/book.min.6970156cec683193d93c9c4edaf0d56574e4361df2e0c1be4f697ae81c3ba55f.css" integrity="sha256-aXAVbOxoMZPZPJxO2vDVZXTkNh3y4MG&#43;T2l66Bw7pV8=" crossorigin="anonymous">


  <script defer src="/fuse.min.js"></script>
  <script defer src="/en.search.min.3ed9c79c605914c45e19db90edfda0ca8d87c63064c1d6252862250c4e917346.js" integrity="sha256-PtnHnGBZFMReGduQ7f2gyo2HxjBkwdYlKGIlDE6Rc0Y=" crossorigin="anonymous"></script>



  
</head>
<body dir="ltr" class="book-kind-page book-type-posts">
  <input type="checkbox" class="hidden toggle" id="menu-control" />
  <input type="checkbox" class="hidden toggle" id="toc-control" />
  <main class="container flex">
    
<aside class="book-menu">
  <div class="book-menu-content">
    
  <nav>
<h2 class="book-brand">
  <a class="flex align-center" href="/"><span>CODE&#39;NOTE</span>
  </a>
</h2>


<div class="book-search hidden">
  <input id="book-search-input" type="text" 
    placeholder="Search"
    aria-label="Search"
    maxlength="64" data-hotkeys="s/" />
  <div class="book-search-spinner hidden"></div>
  <ul id="book-search-results"></ul>
</div>
<script>document.querySelector(".book-search").classList.remove("hidden")</script>
























</nav>




  <script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script>



  </div>
</aside>
 

    <div class="book-page">
      <header class="book-header hidden">
        
  <div class="flex align-center justify-between">
  <label for="menu-control">
    <img src="/icons/menu.svg" class="book-icon" alt="Menu" />
  </label>

  <h3>自动化 Ui测试</h3>

  <label for="toc-control">
    
  </label>
</div>


  
 
      </header>

      
      
<article class="markdown book-post">
  <h1>
    自动化 Ui测试
  </h1>
  


  

  


  <div class="book-post-content markdown-inner"><p><code>Selenium</code>可以用来做<code>自动化UI测试</code>，支持多语言，这里使用<code>C#</code>编写测试脚本。</p>
<!-- more -->
<h1 id="netframework">.NetFramework<a class="anchor" href="#netframework">#</a></h1>
<p><code>Selenium.Support</code>，<code>Selenium.WebDriver</code>,<code>Selenium.RC</code></p>
<h1 id="dotnet-core">Dotnet core<a class="anchor" href="#dotnet-core">#</a></h1>
<p>核心库：<code>Selenium.Support</code>，<code>Selenium.WebDriver</code>,<code>Selenium.Chrome.WebDriver</code></p>
<p>注意：Selenium.RC包在dotnetcore会存在不兼容的问题，无法正常找到<code>chromedriver.exe</code> 文件。</p>
<p><strong>Exception</strong></p>
<blockquote class='book-hint '>
<p>The chromedriver.exe file does not exist in the current directory or in a directory on the PATH environment variable. The driver can be downloaded at <a href="http://chromedriver.storage.googleapis.com/index.html">http://chromedriver.storage.googleapis.com/index.html</a>.”</p>
</blockquote><p><strong>解决方法</strong></p>
<blockquote class='book-hint '>
<p>nuget Selenium.Chrome.WebDriver。将ChromeDriver.exe放入构建目录中</p>
</blockquote><p><strong>注意</strong>：.netcore2.1中引入了<code>Selenium.Chrome.WebDriver</code>包依旧会出现上面的异常</p>
<h1 id="浏览器驱动下载">浏览器驱动下载<a class="anchor" href="#%e6%b5%8f%e8%a7%88%e5%99%a8%e9%a9%b1%e5%8a%a8%e4%b8%8b%e8%bd%bd">#</a></h1>
<p>需下载本机对应版本，不区分32/64</p>
<p><a href="https://npm.taobao.org/mirrors/chromedriver/">https://npm.taobao.org/mirrors/chromedriver/</a></p>
<h1 id="pageobject">PageObject<a class="anchor" href="#pageobject">#</a></h1>
<p>解决的问题：版本迭代太快，UI层元素的属性经常变换，导致维护人员需要花大把的时间去维护代码，为了节省维护成本及时间，就可以利用PageObject 这种设计模式，它就大大的减少了维护时间。</p>
<p>创建对应浏览器配置，创建WebDriver对象：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">abstract</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">TestBase</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">protected</span> IWebDriver driver;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> WebDriverInit(<span style="color:#66d9ef">string</span> url)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        ChromeOptions options = <span style="color:#66d9ef">new</span> ChromeOptions();
</span></span><span style="display:flex;"><span>        <span style="color:#75715e">// 窗口最大化</span>
</span></span><span style="display:flex;"><span>        options.AddArgument(<span style="color:#e6db74">&#34;start-maximized&#34;</span>);
</span></span><span style="display:flex;"><span>        driver = <span style="color:#66d9ef">new</span> ChromeDriver(options);
</span></span><span style="display:flex;"><span>        driver.Navigate().GoToUrl(url);
</span></span><span style="display:flex;"><span>        Thread.Sleep(<span style="color:#ae81ff">1000</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><p>ClockInPage，页面模型，封装页面标签属性以及对应操作：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ClockInPage</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">PagePath</span>
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">readonly</span> <span style="color:#66d9ef">string</span> input_loginName_id = <span style="color:#e6db74">&#34;tb_LoginID_Account_589f1fc067ff4031&#34;</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">readonly</span> <span style="color:#66d9ef">string</span> input_passWord_id = <span style="color:#e6db74">&#34;tb_Password&#34;</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">static</span> <span style="color:#66d9ef">readonly</span> <span style="color:#66d9ef">string</span> submit_login_Name = <span style="color:#e6db74">&#34;ctl10&#34;</span>;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> LoginClick(IWebDriver driver, <span style="color:#66d9ef">string</span> logiName, <span style="color:#66d9ef">string</span> passWord)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        driver.FindElement(By
</span></span><span style="display:flex;"><span>            .Id(PagePath.input_loginName_id)).SendKeys(logiName);
</span></span><span style="display:flex;"><span>        driver.FindElement(By
</span></span><span style="display:flex;"><span>            .Id(PagePath.input_passWord_id)).SendKeys(passWord);
</span></span><span style="display:flex;"><span>        driver.FindElement(By
</span></span><span style="display:flex;"><span>            .Name(PagePath.submit_login_Name)).Click();
</span></span><span style="display:flex;"><span>        Thread.Sleep(<span style="color:#ae81ff">1000</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div><p>ClockInTests，测试方法,采用DDT数据驱动方式提供测试数据：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#a6e22e">[TestCategory(&#34;ui\\CodedUITest&#34;)]</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">[TestClass()]</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ClockInTests</span> : TestBase
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">    [TestCleanup]</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> Clean()
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        driver.Dispose();
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">
</span></span></span><span style="display:flex;"><span><span style="color:#a6e22e">    [DataTestMethod]</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">    [DataRow(&#34;http://11.11.141.10/OMSP//Login/JSS.aspx&#34;, &#34;wangpengliang&#34;, &#34;Wpl-19950815&#34;, true)]</span>
</span></span><span style="display:flex;"><span><span style="color:#a6e22e">    [DataRow(&#34;http://11.11.141.10/OMSP//Login/JSS.aspx&#34;, &#34;111111&#34;, &#34;222222&#34;, false)]</span>
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">void</span> ClockIn_Login_01_Normal(<span style="color:#66d9ef">string</span> url, <span style="color:#66d9ef">string</span> loginName, <span style="color:#66d9ef">string</span> passWord, <span style="color:#66d9ef">bool</span> expect)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        WebDriverInit(url);
</span></span><span style="display:flex;"><span>        ClockInPage page = <span style="color:#66d9ef">new</span> ClockInPage();
</span></span><span style="display:flex;"><span>        page.LoginClick(driver, loginName, passWord);
</span></span><span style="display:flex;"><span>        Assert.AreEqual(expect, driver.Url != url);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}</span></span></code></pre></div></div>
</article>
 
      

      <footer class="book-footer">
        
  <div class="flex flex-wrap justify-between">
  <div>
  
    <a href="/posts/test/%E5%8E%8B%E5%8A%9B%E6%B5%8B%E8%AF%95k6/" class="flex align-center">
      <img src="/icons/backward.svg" class="book-icon" alt="Backward" />
      <span>压力测试k6</span>
    </a>
  
  </div>
  <div>
  
    <a href="/posts/test/%E9%9B%86%E6%88%90%E6%B5%8B%E8%AF%95/" class="flex align-center">
      <span>集成测试</span>
      <img src="/icons/forward.svg" class="book-icon" alt="Forward" />
    </a>
  
  </div>
</div>
 
        
  
 
        
        
  
 
        
  
  
    <script>(function(){document.querySelectorAll("pre:has(code)").forEach(e=>{e.addEventListener("click",e.focus),e.addEventListener("copy",function(t){if(t.preventDefault(),navigator.clipboard){const t=window.getSelection().toString()||e.textContent;navigator.clipboard.writeText(t)}})})})()</script>
  

      </footer>

      <label for="menu-control" class="hidden book-menu-overlay"></label>
    </div>

    
  
 
  </main>

  
</body>
</html>




















